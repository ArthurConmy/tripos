\documentclass[a4paper]{article}

\def\npart{III}

\def\ntitle{Combinatorics}
\def\nlecturer{I.\ B.\ Leader}

\def\nterm{Michaelmas}
\def\nyear{2018}

\input{header}

\newcommand{\shadow}{\partial}
\renewcommand{\P}{\mathbb P}

\begin{document}

\input{titlepage}

\tableofcontents

\section{Set systems}

\begin{definition}[set system]\index{set system}
  Let \(X\) be a set. A \emph{set system} on \(X\) (or \emph{family of subsets}) of \(X\) is a family \(\mathcal A \subseteq \powerset (X)\).
\end{definition}

\begin{eg}
  We write \(X^{(r)} = \{A \subseteq X: |A| = r\}\)
\end{eg}

In this course we almost deal exclusively with finite setss so unless otherwise stated, in this course we assume all sets are finite and \(X = [n] = \{1, 2, \dots, n\}\).

For example, \(|X^{(r)}| = \binom{n}{r}\). More concretely, for example,
\[
  [4]^{[2]} = \{12, 13, 14, 23, 24, 34\}
\]
where \(12\) denotes \(\{1, 2\}\) to avoid heavy notation. Therefore \(|[4]^{[2]}| = 6\).

What is the mental picture for power set? Often we make \(\powerset (X)\) into a graph, called \(Q_n\), by joining \(A\) to \(B\) if \(|A \Delta B| = 1\) where \(\Delta\) is the symmetric difference, i.e.\ if \(A = B \cup \{i\}\) for some \(i \notin B\) (or vice verse).

\begin{eg}
  \(Q_3\)
\end{eg}

\begin{eg}
  General picture for \(Q_n\) where \(n\) is even:

  and when \(n\) is odd:
\end{eg}

If we identify a set \(A \subseteq X\) with a \(\{0, 1\}\) sequence of length \(n\) (e.g.\ \(134 \leftrightarrow 1011000 \cdots 0\)), via \(A \leftrightarrow \mathbf{1}_A \text{ or } \chi_A\). In this way, we can represent \(Q_n\) as a \(n\)-dimensional cube:

For this reason, \(Q_n\) is often called the \emph{hypercube} or \emph{discrete cube} or \emph{\(n\)-cube}. In this way, the study of a set system become the study of a graph.

\subsection{Chains \& Antichains}

\begin{definition}[chain]\index{chain}
  A family \(\mathcal A \subseteq \powerset (X)\) is a \emph{chain} if for all \(A, B \in \mathcal A, A \subseteq B \text{ or } B \subseteq A\).
\end{definition}

\begin{eg}
  \(\{12, 125, 123589\}\).
\end{eg}

On the other hand, we have

\begin{definition}[antichain]\index{antichain}
  A family \(\mathcal A \subseteq \powerset (X)\) is an \emph{antichain} if for all \(A, B \in \mathcal A\) with \(A \neq B\), \(A \nsubseteq B\).
\end{definition}

\begin{eg}
  \(\{1, 467, 2456\}\).
\end{eg}

A natural question is: how large can a chain be? Obviously we can achieve \(|\mathcal A| = n + 1\). We also cannot exceed \(n + 1\) since a chain must meet each ``level'' \(X^{(r)}\) for \(0 \leq r \leq n\) in at most one place.

A less trivial question is how large an antichain can be. We could achieve \(|\mathcal A| = n\) by enumerating all the singletons. It is maximal since adjoining any nonempty set to the family will result in an inclusion. However, it is not the largest antichain. Indeed, we could take \(\mathcal A = X^{(r)}\) for any \(r\). Thus we can achieve \(|\mathcal A| = \binom{n}{\floor{n/2}}\). Can we beat it?

Why can meet each level at only one place? One way to see this is that each level is an antichain: as we can decompose \(Q_n\) into \(n + 1\) antichains, we cannot have a chain longer than that. Inspired by this, we try to decompose \(Q_n\) into chains.

\begin{theorem}[Sperner's lemma]\index{Sperner's lemma}
  Let \(\mathcal A \subseteq \powerset(X)\) where \(|X| = n\) be an antichain. Then
  \[
    |\mathcal A| \leq \binom{n}{\floor{n/2}}.
  \]
\end{theorem}

\begin{proof}
  Sufficient to partition \(\powerset(X)\) into \(\binom{n}{\floor{n/2}}\) chains. For this sufficient to show:
  \begin{enumerate}
  \item for all \(r < \frac{n}{2}\), there exist matchings from \(X^{(r)}\) to \(X^{(r + 1)}\) where a matching is just a set of non-adjacent edges,
  \item for all \(r > \frac{n}{2}\), there exist matchings from \(X^{(r)}\) to \(X^{(r - 1)}\).
  \end{enumerate}
  Then put these matchings together to form chains. Each passes through \(X^{(n/2)}\) so there are \(\binom{n}{\floor{n/2}}\) of them.

  By taking complements, sufficient to prove 1. Consider the subgraph of \(Q_n\) spanned by \(X^{(r)} \cup X^{(r + 1)}\) which is bipartite. For any \(\mathcal B \subseteq X^{(r)}\), let \(\Gamma(\mathcal B)\) be the set of points in \(X^{(r + 1)}\) connected to \(B\). Then we have

  \[
    \# (\mathcal B - \Gamma(\mathcal B) \text{ edges}) = |\mathcal B| (n - r)
  \]
  as each point in \(X^{(r)}\) has degree \(n - r\). Meanwhile
  \[
    \# (\mathcal B - \Gamma(\mathcal B) \text{ edges}) \leq |\Gamma(\mathcal B)| (r + 1)
  \]
  as each point in \(X^{(r + 1)}\) has degree \(r + 1\). Thus
  \[
    |\Gamma(\mathcal B)| \geq |\mathcal B| \frac{n - r}{r + 1} \geq |\mathcal B|
  \]
  as \(r < \frac{n}{2}\). Hence by Hall's theorem there exist matchings.
\end{proof}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item \(\binom{n}{\floor{n/2}}\) is achieveable, e.g.\ \(\mathcal A = X^{(\floor{n/2})}\).
  \item Note that the theorem says nothing about extremal cases --- which antinchain have this size?
  \end{enumerate}
\end{remark}

The aim is to show that for \(\mathcal A\) an antichain,
\[
  \sum_{r = 0}^n \frac{\mathcal A \cap X^{(r)}}{\binom{n}{r}} \leq 1.
\]
Note that this trivially implies Sperner's lemma. We will use the same setup but bound the numbers more carefully. To justify the following definition, we will write \(X^{(r)}\) above \(X^{(r - 1)}\).

\begin{definition}
  Let \(\mathcal A \subseteq X^{(r)}\) for some \(1 \leq r \leq n\). The \emph{shadow} or \emph{lower shadow} of \(\mathcal A\) is
  \[
    \shadow A = \shadow^- A = \{A - \{i\}: A \in \mathcal A, i \in A\}.
  \]
  so \(\shadow A \subseteq X^{(r - 1)}\).
\end{definition}

\begin{eg}
  Let \(\mathcal A = \{123, 124, 134, 135\} \subseteq X^{(3)}\). Then
  \[
    \shadow A = \{12, 13, 23, 14, 24, 34, 15, 35\} \subseteq X^{(2)}.
  \]
\end{eg}

\begin{lemma}[Local LYM]\index{local LYM}
  Let \(\mathcal A \subseteq X^{(r)}\) where \(1 \leq r \leq n\). Then
  \[
    \frac{|\shadow A|}{\binom{n}{r - 1}} \geq \frac{|\mathcal A|}{\binom{n}{r}}.
  \]
\end{lemma}

Informally, the fraction of the later occupied increases when we take the shadow.

\begin{proof}
  \[
    \#(\mathcal A - \shadow \mathcal A \text{ edges in } Q_n) = r|\mathcal A|
  \]
  by counting from above and
  \[
    \#(\mathcal A - \shadow \mathcal A \text{ edges in } Q_n) \leq (n - r + 1) |\shadow \mathcal A|
  \]
  counting from below so
  \[
    \frac{|\shadow \mathcal A|}{|\mathcal A|} \geq \frac{r}{n - r + 1}
  \]
  but
  \[
    \frac{\binom{r}{r - 1}}{\binom{n}{r}} = \frac{r}{n - r + 1}.
  \]
\end{proof}

When does equality hold in local LYM? We'll need
\[
  (A - \{i\}) \cup \{j\} \in \mathcal A
\]
for all \(a \in \mathcal A, i \in A, j \notin A\). Hence \(\mathcal A = X^{(r)}\) or \(\emptyset\).

\begin{theorem}[LYM inequality]\index{LYM inequality}
  Let \(\mathcal A \subseteq \powerset(X)\) be an antichain. Then
  \[
    \sum_{r = 0}^n \frac{\mathcal A \cap X^{(r)}}{\binom{n}{r}} \leq 1.
  \]
\end{theorem}

\begin{proof}
  The whole idea of the proof can be summarised by ``bubble down with local LYM''. Let \(\mathcal A_r = \mathcal A \cap X^{(r)}\). Obviously
  \[
    \frac{|\mathcal A_n|}{\binom{n}{n}} \leq 1.
  \]
  Also \(\shadow \mathcal A_n\) and \(\mathcal A_{n - 1}\) are distinct as \(\mathcal A\) is an antichain. Thus
  \[
    \frac{|\shadow \mathcal A_n|}{\binom{n}{n - 1}} + \frac{|\mathcal A_{n - 1}|}{\binom{n}{n - 1}}
    = \frac{|\shadow \mathcal A_n \cup \mathcal A_{n - 1}|}{\binom{n}{n - 1}} \leq 1
  \]
  so
  \[
    \frac{|\mathcal A_n|}{\binom{n}{n}} + \frac{|\mathcal A_{n - 1}|}{\binom{n}{n - 1}} \leq 1
  \]
  by local LYM.

  Also \(\shadow (\shadow \mathcal A_n \cup \mathcal A_{n - 1})\) is distint from \(\mathcal A_{n - 2}\), again since \(\mathcal A\) is an antichain. Thus
  \[
    \frac{|\shadow (\shadow \mathcal A_n \cup \mathcal A_{n -1})|}{\binom{n}{n - 2}} +\frac{|\mathcal A_{n - 2}|}{\binom{n}{n - 2}} \leq 1,
  \]
  so
  \[
    \frac{|\shadow \mathcal A_n \cup \mathcal A_{n - 1}|}{\binom{n}{n - 1}} + \frac{|\mathcal A_{n - 1}|}{\binom{n}{n - 2}} \leq 1,
  \]
  so
  \[
    \frac{|\mathcal A_n|}{\binom{n}{n}} + \frac{|\mathcal A_{n - 1}|}{\binom{n}{n - 1}} + \frac{|\mathcal A_{n - 2}|}{\binom{n}{n - 2}} \leq 1
  \]
  Keep going we have the result desired.
\end{proof}

Again we can ask when we have equality in LYM inequality. This happens if and only if we have equality in each use of local LYM, so the ``first'' (greatest) \(r\) with \(\mathcal A_r \neq \emptyset\) must have \(\mathcal A_r = X^{(r)}\) so \(\mathcal A = X^{(r)}\). Thus we know equality in Sperner's lemma (\(\mathcal A = X^{(n/2)}\) for \(n\) even, similar for \(n\) odd)

\begin{proof}[Proof 2]
  Choose uniformly at random, a maximal chain \(\mathcal C\) (i.e.\ \(C_0 \subseteq C_1 \subseteq \dots \subseteq C_n\) with \(|C_i| = i\)). For a given \(r\)-set, \(\P(A \in \mathcal C) = \binom{n}{r}^{-1}\) as all \(r\)-sets are equally likely. Therefore
  \[
    \P(\mathcal A_r \text{ meets } \mathcal C) = \frac{|\mathcal A_r|}{\binom{n}{r}}
  \]
  since events are disjoint. As they are independent,
  \[
    \P(\mathcal A \text{ meets } \mathcal C) = \sum_{r = 0}^n \frac{|\mathcal A_r|}{\binom{n}{r}}
  \]
  and of course it is less than \(1\).
\end{proof}

%how do we think of the first line (from which the rest follows)? inspired by the first proof of LYM %maybe no?

\begin{remark}
  Equivalently, the number of maximal chains is \(n!\) and the number of them containing a given \(r\)-set is \(r! (n - r)!\), so
  \[
    \sum_{r = 0}^n |\mathcal A_r| r! (n - r)! \leq n!
  \]
  so this is probability in disguise
\end{remark}

\section{Shadows}

For \(\mathcal A \subseteq X^{(r)}\), we know \(|\shadow A| \geq |A| \frac{r}{n - r + 1}\) --- but equality is rare (only for \(\mathcal A = \emptyset\) or \(\mathcal A = X^{(r)}\)). The natural question is: given \(|\mathcal A|\), how should we choose \(\mathcal A \subseteq X^{(r)}\) to minimise \(|\shadow A|\)? Informally, this asks how ``tightly'' can we pack some \(r\)-sets.

If \(|A| = \binom{k}{r}\), it is believable that we would take \(A = [k]^{(r)}\), which gives \([k]^{(r - 1)}\). What if \(\binom{k}{r} < |\mathcal A| <\binom{k + 1}{r}\), it is believable that we'd take \([k]^{(r)}\) and some other \(r\)-sets from \([k + 1]^{(r)}\). For example if \(\mathcal A \subseteq X^{(3)}\) with \(|\mathcal A| = \binom{7}{3} + \binom{4}{2}\), we would take
\[
  \mathcal A = [7]^{(3)} \cup \{A \cup \{8\}: A \in [4]^{(2)}\},
\]
i.e.\ take those in \([7]\) of size \(3\) so that they are as tightly packed as possible and then choose some other stuff.

If we increment the size of \(\mathcal A\) by \(1\), it is believable that we should take the above \(\mathcal A\) and adjoin another element from \([4]\). Thus it seems that there is a total order on subsets of \(X\) of a given size, and we just take the first \(|\mathcal A|\).

\subsection{Two total orderings on \(X^{(r)}\)}

\begin{definition}[lexicographic order]\index{lexicographic order}
  Given \(A, B \in X^{(r)}\), say \(A = a_1, \dots, a_r, B = b_1, \dots, b_r\), where we use the notation to mean \(a_1 < \dots < a_r\), say \(A < B\) in the \emph{lexicographic} or \emph{lex} order if for some \(i\) have \(a_i < b_i\) and \(a_j = b_j\) for all \(j < i\).
\end{definition}

Equivalently, \(a_i < b_i\), where \(i = \min\{j: a_j \neq b_i\}\). The slogan is ``use small number''.

\begin{eg}
  Lex on \([4]^{(2)}\):
  \[
    12, 13, 14, 23, 24, 34.
  \]

  Lex on \([6]^{(3)}\):
  \begin{align*}
    &123, 124, 125, 126, 134, 135, 136, 145, 146, 156, \\
    &234, 235, 236, 245, 246, 256, 345, 346, 356, 456.
  \end{align*}
\end{eg}

However, in the shadow minimisation problem we want to avoid large numbers as much as possible, i.e.\ keep the largest number as small as possible.

\begin{definition}[colexicographic order]\index{colexicographic order}
  Say \(A < B\) isn the \emph{colexicographic} or \emph{colex} order if for some \(i\) have \(a_i < b_i\) and \(a_j = b_j\) for all \(j > i\).
\end{definition}

Equivalently, \(a_i < b_i\) where \(i = \max\{j: a_j \neq b_j\}\). The slogan is ``avoid large number''. Equivalently, \(A < B\) if \(\sum_{i \in A} 2^i < \sum_{i \in B} 2^i\).

\begin{eg}
  Colex on \([4]^{(2)}\):
  \[
    12, 13, 23, 14, 24, 34.
  \]

  Colex on \([6]^{(2)}\):
  \begin{align*}
    &123, 124, 134, 234, 125, 135, 235, 145, 245, 345,\\
    &126, 136, 236, 146, 246, 346, 156, 256, 356, 456.
  \end{align*}
\end{eg}

\begin{note}
  In colex, \([k]^{(r)}\) is an initial segment of \([k + 1]^{(r)}\), meaning that it is the first \(t\) elements for some \(t\). Therefore we could view colex as an enumeration of \(\N^{(r)}\). Try this with lex and see what happens!
\end{note}

Following our heuristics just now, the aim is to show initial segments of cloex minimise \(\shadow\), i.e.\ if \(\mathcal A \subseteq X^{(r)}\) and \(\mathcal C \subseteq X^{(r)}\) is the first \(|\mathcal A|\) \(r\)-sets in colex then \(|\shadow \mathcal A| \geq |\shadow \mathcal C|\), This is Kruskal-Katona theorem, the first theorem in combinatorics.
In particular, \(|\mathcal A| = \binom{k}{r}\) implies \(|\shadow \mathcal A| \geq \binom{k}{r - 1}\). However, unless \(\mathcal A\) is written in very nice form, it is very difficult to estimate \(\shadow \mathcal A\).

\subsection{Compressions}

The idea is to ``replace'' \(\mathcal A \subseteq X^{(r)}\) with some \(\mathcal A' \subseteq X^{(r)}\) such that
\begin{enumerate}
\item \(|\mathcal A'| = |\mathcal A|\),
\item \(|\shadow \mathcal A'| \leq |\shadow \mathcal A|\),
\item \(\mathcal A'\) ``looks more like \(\mathcal C\)'' than \(\mathcal A\) did.
\end{enumerate}

Ideally, we would compress
\[
  \mathcal A \to \mathcal A' \to \mathcal A'' \to \dots \to \mathcal B
\]
where either \(\mathcal B = \mathcal C\), or \(\mathcal B\) is so similar to \(\mathcal C\) that we can see directly that \(|\shadow \mathcal B| \geq |\shadow \mathcal C|\).







\printindex
\end{document}

% Three parts:
% Chapter 1: set systems
% Chapter 2: isoperimetric inequalities
% Chapter 3: projections
% Books: Combinatorics, Bollobas, CUP 1986, excellent for Chapter 1 and Chapter 2 (and gentle!) and for future development of the course;
% Combinatorics of finite sets, Anderson, OUP 1987, simple and clear, good for Chapter 1