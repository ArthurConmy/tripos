\documentclass[a4paper]{article}

\def\npart{III}

\def\ntitle{Algebraic Geometry}
\def\nlecturer{M.\ Gross}

\def\nterm{Michaelmas}
\def\nyear{2019}

\input{header}

\renewcommand*{\P}{\mathbb{P}}
\renewcommand{\c}[1]{\mathbf{#1}} % category
\newcommand{\sh}[1]{\mathcal{#1}} % sheaf

\begin{document}

\input{titlepage}

\tableofcontents

\setcounter{section}{-1}

\section{Introduction}

\subsection{Variety vs Scheme}

In classical algebraic geometry, we study varieties which are points where polynomials vanish.

Why do we need schemes? Why not varieties?
\begin{enumerate}
\item With varieties, we always work with algebraically closed fields. Otherwise, the ideals are not really classical geometric objects. For example, consider \(I = (x^2 + y^2 + 1) \subseteq \R[x, y]\). \(V(I) = \emptyset\), \(I(V(I)) = \R[x, y]\).
\item Suppose one want to work on number theory. One is usually interested in Diophantine equations, for example if \(I \subseteq \Z[x_1, \dots, x_n]\) then \(V(I) \subseteq \Z^n\). 
\item Consider \(X_1 = V(x - y^2) \subseteq \A^2, X_2 = V(x)\). Then
  \[
    X_1 \cap X_2 = V(x, x - y^2).
  \]
  Consider \(I = (x, x - y^2) = (x, y^2) \subseteq k[x, y]\). \(V(I)\) contains exactly one point, namely the origin, but the ideal \(I\) is not radical, reflecting the fact that \(X_2\) is the tangent to \(X_1\). Might it be reasonable to consider \(k[x, y]/(x, y^2)\) as the coordinate ring of \(X_1 \cap X_2\) rather than \(k[x, y]/(x, y)\)? Note \(y \in k[x, y]/(x, y^2)\) is non-zero but \(y^2 = 0\).
\end{enumerate}

\subsection{Categorical philosophy}

What is a point? Let \(\c{Sets}\) be the category of sets. Let \(*\) be the set with one element. Then if \(X\) is a set there is an obvious bijection \(X \to \Hom(*, X)\). Put in another way, you know \(X\) if you know \(\Hom(Y, X)\) for all \(Y\).

In the category of affine varieties over \(k\), a point is a point with coordinate ring \(k\). Given \(I \subseteq k[x_1, \dots, x_n]\), giving a morphism from a point to \(V(I) = X\) is the same as giving a \(k\)-algebra homomorphism \(\varphi: k[x_1, \dots, x_n]/I \to k\) given by \(x_i \mapsto a_i \in k\) such that for all \(f \in I\), \(f(a_1, \dots, a_n) = 0\), i.e.\ \((a_1, \dots, a_n) \in V(I)\). \(\varphi\) is surjective so \(k[X]/\ker \varphi \cong k\), so \(\ker \varphi\) is a maximal ideal of \(k[X]\). Conversely, given a mximal ideal \(\mathfrak m \subseteq k[X]\), \(k[X]/\mathfrak m\) is a finite field extension of \(k\) by Hilbert's Nullstellensatz. So if \(k = \overline k\) then \(k[X]/\mathfrak m \cong k\) and the map \(\varphi: k[X] \to k[X]/\mathfrak m \cong k\) gives a point \((a_1, \dots, a_n) = (\varphi(x_1), \dots, \varphi(x_n)) \in X\).

Why not also consider field extensions \(k \subseteq k'\) and consider \(k\)-algebra homomorphisms \(\varphi: k[X] \to k'\). Same as before we get a set of solutions in \((k')^n\). Note \(k[X]/\ker \varphi \subseteq k'\) and hence \(k[X]/\ker \varphi\) is an integral domain. Thus \(\ker \varphi\) is prime. For example take \(k[X]\) to be \(\R[x, y]/(x^2 + y^2 + 1)\) and \(\R\)-algebra map \(k[X] \to \R\). There does not exist such map. But there is certainly a map \(k[X] \to \C\), for example \(x \mapsto 0, y \mapsto i\). We have \(\ker \varphi = (x, y^2 + 1)\) is a maximal ideal. Note that this ideal corresponds to two points \((0, \pm i)\), a \(\operatorname{Gal}(\C/\R)\)-orbit of points with \(\C\)-coordinates. In fact this also follows from Hilbert's Nullstellensata: if \(A\) is a finitely-generated \(k\)-algebra, \(\mathfrak m \subseteq A\) a maximal ideal then \(A/\mathfrak m\) is a finite field extension of \(k\).

Let \(K\) be the field of fractions of \(A\). Then \(\varphi: A \embed K\) defines a point in \(K\), i.e.\ \((x, y)\) satisfying \(x^2 + y^2 + 1 = 0\) in \(K\). Note \(\ker \varphi = 0\) so this point corresponds not to a maximal ideal but to a prime ideal. This may promopt to us to consider all prime ideals instead of just maximal ideals.

Consider another example \(A = \Z[x_1, \dots, x_n]/I\). We may want to consider solutions to the system of equations \(I\) with coordinates in any ring \(R\). Such is given by a ring homomorphism \(\varphi: A \to R\), i.e.\ \((r_1, \dots, r_n)\) satisfying \(f(r_1, \dots, r_n) = 0\) for \(f \in I\). We may then consider different choices of \(R\). We may take \(R = \Z\) or a number ring, or \(R = \Q\), or \(R = \F_p\).

What we wnat: give a ring \(A\) (all rings in this course are commutative with \(1\)), we want a geometric object \(X = ``\Spec A''\). For a ring \(R\), the set of ``\(R\)-valued points'' of \(X\) should be
\[
  X(R) = \Hom_{\text{Ring}}(A, R).
\]
A morphism \(X = \Spec A \to Y = \Spec B\) should be determined by a ring homomorphism \(\varphi: B \to A\).

\begin{definition}
  The category of affine scheme is the opposite category to the category of rings.
\end{definition}
This is a purely formal definition and there is no geometry. Instead, we want to study more general objects.

\begin{definition}
  A scheme is an object which is locally an affine scheme.
\end{definition}
This time, we do need geometry to talk about local properties!

\section{Sheaves}

\begin{definition}[spectrum]\index{spectrum}
  Let \(A\) be a ring. Then the \emph{spectrum} of \(A\) is
  \[
    \Spec A = \{\mathfrak p \subseteq A: \mathfrak p \text{ a prime ideal}\}.
  \]

  If \(I \subseteq A\) is an ideal, define
  \[
    V(I) = \{\mathfrak p \subseteq \Spec A: \mathfrak p \supseteq I\}.
  \]
\end{definition}

\begin{proposition}[Zariski topology]\index{Zariski topology}
  The set \(V(I)\) form the closed sets of a topology on \(\Spec A\), called the \emph{Zariski topology}.
\end{proposition}

\begin{proof}
  \(V(0) = \Spec A, V(A) = \emptyset\). If \(\{I_j\}_{j \in J}\) is a collection of ideals then
  \[
    V(\sum_{j \in J} I_j) = \bigcap_{j \in J} V(I_j)
  \]
  and finally
  \[
    V(I_1 \cap I_2) = V(I_1) \cup V(I_2).
  \]
  One direction is trivial. For the other, if \(\mathfrak p \supseteq I_1 \cap I_2\) then \(\mathfrak p \supseteq I_1\) or \(\mathfrak p \supseteq I_2\).
\end{proof}

\begin{eg}
  \(A = k[x_1, \dots, x_n]\) where \(k = \overline k\), \(I \subseteq A\), then the maximal ideals in \(V(I)\) is in one-to-one correspondence with points of the variety \(V(I)\) in affine \(n\)-spece.
\end{eg}

So far we only have a topology. To talk about geometry, we need a good notion of functions. This is where we need \emph{sheaves}. From now on fix a topologial space \(X\).

\begin{definition}[presheaf]\index{presheaf}
  A \emph{presheaf} of abeliean groups on \(X\) \(\sh F\) consists of data
  \begin{enumerate}
  \item for every open set \(U \subseteq X\), an abelian group \(\sh F(U)\),
  \item whenever \(V \subseteq U\), a group homomorphism \(\rho_{UV}: \sh F(U) \to \sh F(V)\) such that \(\rho_{UU} = \id, \rho_{VW} \compose \rho_{UV} = \rho_{UW}\) when \(W \subseteq V \subseteq U\).
  \end{enumerate}
\end{definition}

The maps \(\rho_{UV}\) are called the \emph{restriction maps} and for \(V \subseteq U, s \in \sh F(U)\), we often write \(s|_V\) for \(\rho_{UV}(s)\).

\begin{remark}
  This is just a contravariant functor \(\sh F: \text{Open}(X) \to \c{Ab}\) where \(\text{Open}(X)\) is the category of open sets with inclusions.
\end{remark}

\begin{definition}[morphism of presheaves]\index{presheaf!morphism}
  A \emph{morphism} of presheaves \(f: \sh F \to \sh G\) on \(X\) is a collection of homomorphisms \(f_U: \sh F(U) \to \sh G(U)\) with, for \(V \subseteq U\), the commutative diagram
  \[
    \begin{tikzcd}
      \sh F(U) \ar[r, "f_U"] \ar[d, "\rho_{UV}"] & \sh G(U) \ar[d, "\rho_{UV}"] \\
      \sh F(V) \ar[r, "f_V"] & \sh G(V)
    \end{tikzcd}
  \]
\end{definition}

\begin{definition}[sheaf]\index{sheaf}
  A presheaf \(\sh F\) is a \emph{sheaf} is it satisfies
  \begin{enumerate}
  \item if \(U \subseteq X\) has a cover \(\{U_i\}\) and \(s \in \sh F(U)\) such that \(s|_{U_i} = 0\) for all \(i\) then \(s = 0\).
  \item if \(U \subseteq X\) has a cover \(\{U_i\}\) and \(s_i \in \sh F(U_i)\) given with \(s_i|_{U_i \cap U_j} = s_j|_{U_i \cap U_j}\) for all \(i, j\) then exists \(s \in \sh F(U)\) with \(s|_{U_i} = s_i\) for all \(i\).
  \end{enumerate}
\end{definition}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item If \(\sh F\) is a sheaf then \(\emptyset\) has an empty cover and hence \(\sh F(\emptyset) = 0\).
  \item The two axioms S1, S2 together can be described as saying for each open cover \(\{U_i\}\) of \(U\),
    \[
      \begin{tikzcd}
        0 \ar[r] & \sh F(U) \ar[r, "\alpha"] & \displaystyle\prod_i \sh F(U_i) \ar[r, "\beta_1", shift left] \ar[r, "\beta_2"', shift right] & \displaystyle\prod_{i, j} \sh F(U_i \cap U_j)
      \end{tikzcd}
    \]
    is exact, where
    \begin{align*}
      \alpha(s) &= (s|_{U_i}) \\
      \beta_1((s_i)) &= (s_i|_{U_i \cap U_j}) \\
      \beta_2((s_i)) &= (s_j|_{U_i \cap U_j})
    \end{align*}
    Exact means that \(\alpha\) is injective (S1), and \(\beta_1 \compose \alpha = \beta_2 \compose \alpha\), and for any \((s_i) \in \prod_i \sh F(U_i)\) with \(\beta_1((s_i)) = \beta_2((s_i))\) then exists \(s \in \sh F(U)\) with \(\alpha(s) = (s_i)\), i.e.\ \(\alpha\) is the equaliser of \(\beta_1, \beta_2\).

    The sheaf axioms make sense when \(\c{Ab}\) is replaced by any category with equalisers, for example \(\c{Set}\).
  \end{enumerate}
\end{remark}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item If \(X\) is any topological space, set
    \begin{align*}
      \sh F(U) &= \{f: U \to \R: f \text{ continuous}\} \\
      \rho_{UV}(f) &= f|_V
    \end{align*}
    Then \(\sh F\) is a sheaf.
  \item Let \(X = \C\) with the Euclidean topology. Set
    \[
      \sh F(U) = \{f: U \to \C: f \text{ bounded holomorphic function}\}.
    \]
    Then \(\sh F\) satisfies S1 but not S2. For example take \(U_i = \{z \in \C: |z| < i\}, f_i: U_i \to \C\) the identity map. Take \(i \in \N\), then the glued function is \emph{not} bounded.
  \item Take any group \(G\) and set \(\sh F(U) = G\) for all \(U\), \(\rho_{UV} = \id\). \(\sh F\) is the \emph{constant presheaf}. It is a not a sheaf if \(G \neq 0\) as \(\sh F(\emptyset) = G\). To get a sheaf, give \(G\) the discrete topology and define
    \[
      \sh G(U) = \{f: U \to G: f \text{ continuous}\}.
    \]
    Note if \(U\) is connected then \(\sh G(U) = G\). If \(U_i, i \in I\) are disjoint then
    \[
      \sh G(\coprod U_i) = \prod \sh G(U_i).
    \]
  \item Let \(X\) be an algebraic variety, \(U \subseteq X\) a Zariski open set. Define
    \[
      \sh O_X(U) = \{f: U \to k: f \text{ a regular function}\}.
    \]
    Then \(\sh O_X\) is a sheaf, the \emph{structure sheaf}\index{structure sheaf} of \(X\).
  \end{enumerate}
\end{eg}

\begin{definition}[stalk]\index{stalk}
  Let \(\sh F\) be a presheaf on \(X\), \(p \in X\). Then the \emph{stalk} of \(\sh F\) at \(p\) is
  \[
    \sh F_p = \{(U, s): U \text{ open neighbourhood of } p, s \in \sh F(U)\} / \sim
  \]
  where \((U, s) \sim (V, s')\) if there exists \(W \subseteq U \cap V\) with \(p \in W\) such that \(s|_W = s'|_W\). It can be described as the direct limit
  \[
    \sh F_p = \varinjlim_{p \in U} \sh F(U).
  \]
\end{definition}

Note a morphism \(f: \sh F \to \sh G\) induces a homomorphism
\begin{align*}
  f_p: \sh F_p &\to \sh G_p \\
  (U, s) &\mapsto (U, f_U(s))
\end{align*}
We call \((U, s)\) the \emph{germ}\index{germ} of \(s\) at \(p\).

\begin{proposition}
  Let \(f: \sh F \to \sh G\) be a morphism of sheaves. Then \(f\) is an isomorphism if and only if \(f_p\) is an isomorphism for all \(p \in X\).
\end{proposition}

\begin{proof}
  Only if is obvious. For if, assume \(f_p\) is an isomorphism for all \(p \in X\). Need to show each \(f_U: \sh F(U) \to \sh G(U)\) is an isomorphism as can then construct \(f^{-1}\) via \((f^{-1})_U = (f_U)^{-1}\).
  \begin{itemize}
  \item \(f_U\) injective: suppose \(s \in \sh F(U)\) with \(f_U(s) = 0\). Then \(f_p(U, s) \in \sh G_p\) for any \(p \in U\), and \(f_p(U, s) = (U, f_U(s)) = 0\). Thus \((U, s) = 0 \in \sh F_p\), which means that exists \(p \in V_p \subseteq U\) such that \(s|_{V_p} = 0\). Now \(\{V_p: p \in U\}\) form an open cover of \(U\) so by S1, \(s = 0\).
  \item \(f_U\) surjective: let \(t \in \sh G(U)\). Then \(t_p = (U, t) \in \sh G_p\). By surjectivity of \(f_p\), let \(s_p \in \sh F_p\) with \(f_p(s_p) = t_p\). In other words, exists a neighbourhood \(V_p\) of \(p\) and a germ \((V_p, s_p)\) such that \((V_p, f_{V_p}(s_p)) = (U, t) \in \sh G_p\). By shrinking \(V_p\) if necessary, we can assume \(f_{V_p}(s_p) = t|_{V_p}\). \(\{V_p\}\) is an open cover of \(U\). On \(V_p \cap V_q\),
    \[
      f_{V_p \cap V_q} (s_p|_{V_p \cap V_q} - s_q|_{V_p \cap V_q}) = t|_{V_p \cap V_q} - t|_{V_p \cap V_q} = 0.
    \]
    By injectivity already proved, \(f_{V_p \cap V_q}\) is injective so \(s_p|_{V_p \cap V_q} = s_q|_{V_p \cap V_q}\) for all \(p, q \in U\). By S2, there exists \(s \in \sh F(U)\) with \(s|_{V_p} = s_p\) for all \(p\) so
    \[
      f_U(s)|_{V_p} = f_{V_p}(s|_{V_p}) = f_{V_p}(s_p) = t|_{V_p}
    \]
    so by S1, \(f_U(s) = t\).
  \end{itemize}
\end{proof}
Note the asymmetry: injectivity comes directly from injectivity on stalks, while surjectivity follows from both surjectivity on stalks and injectivity on sections. This will appear often in the future.

\subsection{Sheafification}

Given a presheaf \(\sh F\), there is a sheaf \(\sh F^+\) an a morphism \(\theta: \sh F \to \sh F^+\) satisfying the following universal property: for any sheaf \(\sh G\) and morphism \(\varphi: \sh F \to \sh G\), there exists a unique morphism \(\varphi^+: \sh F^+ \to \sh G\) with \(\varphi = \varphi^+ \compose \theta\).

\(\sh F^+\) is called the \emph{sheaf associated} to \(\sh F\) and \(\theta_p: \sh F_p \to \sh F_p^+\) is an isomorphism for all \(p\).

Define
\[
  \sh F^+(U) =
  \left\{
    \begin{tabular}{l}
      \(s: U \to \coprod_{p \in U} \sh F_p\): \(s(p) \in \sh F_p\), \\
      for each \(p\in U\), exists \(p \in V \subseteq U\), \(t \in \sh F(V)\) \\
      such that \(s(q) = (U, t) \in \sh F_q\) for all \(q \in V\)
    \end{tabular}
  \right\}
\]
We define \(\theta_U(s)\) to be \(p \mapsto (U, s) \in \sh F_p\) for all \(p \in U\).

The verification of the universal property and other properties is left as exercises on example sheet 1.

\begin{definition}
  Let \(f: \sh F \to \sh G\) be a morphism of presheaves.
  \begin{itemize}
  \item The \emph{presheaf kernel} of \(f\) is the presheaf
    \[
      (\ker f)(U) = \ker f_U.
    \]
  \item The \emph{presheaf cokernel} of \(f\) is the presheaf
    \[
      (\coker f)(U) = \coker f_U.
    \]
  \item The \emph{presheaf image} of \(f\) is the presheaf
    \[
      (\im f)(U) = \im f_U.
    \]
  \end{itemize}
\end{definition}

\begin{remark}
  If \(f: \sh F \to \sh G\) is a morphism of sheaves then \(\ker f\) is also a sheaf: any sub-presheaf of a sheaf satisfies S1, and given \(s_i \in (\ker f)(U_i)\) with \(s_i|_{U_i \cap U_j} = s_j|_{U_i \cap U_j}\), we can glue to get \(s \in \sh F(U)\). But then
  \[
    f_U(s)|_{U_i} = f_{U_i}(s|_{U_i}) = f_{U_i}(s_i) = 0
  \]
  so by S1 \(f_U(s) = 0\) so \(s \in (\ker f)(U)\).
\end{remark}

\begin{eg}
  Let \(X\) be the variety \(\P^1_k\). Let \(P, Q \in X\) be distinct points. Let \(\sh G\) be the sheaf of regular functions on \(X\). Let \(\sh F\) be the sheaf of regular functions on \(X\) vanishing at \(P\) and \(Q\). Have an obvious inclusion \(i: \sh F \to \sh G\) and \(\sh F(U) = \sh G(U)\) if \(U \cap \{P, Q\} = \emptyset\). Then
  \begin{align*}
    (\coker i) (\P^1) &= \frac{\sh G (\P^1)}{\sh F(\P^1)} = \frac{k}{0} = k \\
    (\coker i) (\P^1 \setminus \{P\}) &= \frac{\sh G (\P^1 \setminus \{P\})}{\sh F (\P^1 \setminus \{P\})} \cong \frac{k[x]}{(x)} = k
  \end{align*}
  Similarly
  \[
    (\coker i) (\P^1 \setminus \{Q\}) = k
  \]
  and
  \[
    (\coker i) (\P^1 \setminus \{P, Q\}) = 0.
  \]
  Note \(U = \P^1 \setminus \{P\}, V = \P^1 \setminus \{Q\}\) cover \(\P^1\) so if \(\coker i\) were a sheaf, any \(s_U \in (\coker i)(U), s_V \in (\coker i)(V)\) would have to get an element of \((\coker i)(\P^1)\). In particular
  \[
    (\coker i) (\P^1) = k \oplus k \neq k.
  \]
  Absurd.

  This is not a bug but a feature of the theory. At the end of the course we will find ourselves secretly calculating the sheaf cohomology in this example.
\end{eg}

\begin{definition}[sheaf kernel/image/cokernel]\index{sheaf!kernel}\index{sheaf!image}\index{sheaf!cokernel}
  Let \(f: \sh F \to \sh G\) be a morphism of sheaves. Then the \emph{sheaf kernel} is the presheaf kernel. The \emph{sheaf image} is the sheaf associated to the presheaf image and the \emph{sheaf cokernel} is the sheaf associated to the presheaf cokernel.
\end{definition}

These are the categorical notions of kernel/image/cokernel.

\begin{ex}
  The sheaf image \(\im f\) is a subsheaf of \(\sh G\).
\end{ex}

\begin{definition}[exact sequence of sheaves]
  We say \(f: \sh F \to \sh G\) is \emph{injective} if \(\ker f = 0\), \emph{surjective} if \(\im f = \sh G\).

  We say a sequence of sheaves
  \[
    \begin{tikzcd}
      \cdots \ar[r] & \sh F^{i - 1} \ar[r, "f^i"] & \sh F^i \ar[r, "f^{i + 1}"] & \sh F^{i + 1} \ar[r] & \cdots
    \end{tikzcd}
  \]
  is \emph{exact} if \(\ker f^i = \im f^{i - 1}\) for all \(i\).
\end{definition}

\(f\) is injective if and only if \(f_U\) is injective for all \(U\) but the analogous statement is false for surjectivity.

If \(\sh F' \subseteq \sh F\) is a subsheaf, we write \(\sh F/\sh F'\) for the sheaf associated to the presheaf \(U \mapsto \sh F(U)/\sh F'(U)\). This is \(\coker (\sh F' \embed \sh F)\).

\begin{lemma}
  Let \(f: \sh F \to \sh G\) be a morphism of sheaves. Then
  \begin{align*}
    (\ker f)_p &= \ker f_p \\
    (\im f)_p &= \im f_p
  \end{align*}
  for all \(p \in X\).
\end{lemma}

\begin{proof}
  We have a natural map \((\ker f)_p \to \ker f_p\): if \((U, s) \in (\ker f)_p\) where \(s \in (\ker f)(U)\) then
  \[
    f_p(U, s) = (U, f_U(s)) = (U, 0) = 0
  \]
  so \((U, s) \in \ker f_p\).

  For injectivity, if \((U, s) = 0 \in \ker f_p\) then \((U, s) = 0 \in \sh f_p\). Shrinking \(U\) if necessary, we can assume \(s = 0\). Then \((U, s) = 0 \in (\ker f)_p\). For surjectivity, if \((U, s) \in \ker f_p\) then \((U, f_U(s)) = 0 \in \sh G_p\). Shrinking \(U\) if necessary, we can assume \(f_U(s) = 0\) and hence \((U, s) \in (\ker f)_p\) since \(s \in (\ker f)(U)\).

  Now we prove the statement about image sheaf. Let \(\im' f\) be the presheaf image so \(\im f\) is the associated sheaf. We have an isomorphism \((\im ' f)_p = (\im f)_p\), so enough to show the natural map \((\im' f)_p \to \im f_p\) is an isomorphism.

  For injectivity, if \((U, s) = 0 \in \sh G_p\) then shrinking \(U\) we can assume \(s = 0\). Then \((U, s) = 0 \in (\im' f)_p\). For surjectivity, if \((U, s) \in \im f_p\) then exists \((V, t) \in \sh F_p\) such that \(f_p(V, t) = (U, s)\) so exists a neighbourhood \(W \subseteq U \cap V\) of \(p\) such that \(f_V(t)|_W = f_W(t) = s|_W\). Thus \((W, s|_W) \in (\im' f)_p\).
\end{proof}

\begin{proposition}
  Let \(f: \sh F \to \sh G\) be a morphism of sheaves. Then \(f\) is injective (surjective respectively) if and only if \(f_p: \sh F_p \to \sh G_p\) is injective (surjective respectively) for all \(p\).
\end{proposition}

\begin{proof}
  \(f_p\) is injective for all \(p\) if and only if \(\ker f_p = 0\) for all \(p\), if and only if \((\ker f)_p = 0\) for all \(p\), if and only if \(\ker f = 0\), since \(0 \to \ker f\) is an isomorphism on stalks, if and only if \(f\) is injective. Analogous for \(\im f\) by noting the inclusion \(\im f \to \sh G\).
\end{proof}

It is strongly recommended at this point to do all problems in \(II.1\) of Hartshorne.

\begin{definition}
  Let \(f: X \to Y\) be a continuous map of topological spaces. Let \(\sh F\) be a sheaf on \(X\), \(\sh G\) a sheaf on \(Y\). We define \(f_* \sh F\) to be the sheaf with
  \[
    (f_* \sh F)(U) = \sh F (f^{-1}(U))
  \]
  and obvious restriction maps. We define \(f^{-1} \sh G\) to be the sheaf associated to the presheaf
  \[
    U \to \varinjlim_{V \supseteq f(U)} \sh G(V) = \{(V, s): V \supseteq f(U) \text{ open}, s \in \sh G(V)\}/ \sim
  \]
  where \((V, s) \sim (V', s')\) if exists \(W \subseteq V \cap V'\) with \(f(U) \subseteq \) and \(s|_W = s'|_W\).
\end{definition}

\begin{eg}
  If \(f: \{p\} \to X\) and \(\sh G\) is a sheaf on \(X\) then \(f^{-1} \sh G = \sh G_p\). More generally if \(i: Z \embed X\) and \(\sh F\) is a sheaf in \(X\) we write \(\sh F|_Z = i^{-1} \sh F\). In particular if \(Z\) is open then \(\sh F|_Z\) is easy to describe: \(\sh F|_Z(U) = \sh F(U)\).
\end{eg}

\begin{notation}
  If \(s \in \sh F(U)\), we say \(s\) is a \emph{section}\index{section} of \(\sh F\) over \(U\). We often write \(\Gamma(U, \sh F)\) for \(\sh F(U)\), thinking of \(\Gamma(U, \cdot)\) as a covariant functor \(\c{PreSh}_X \to \c{Ab}\).
\end{notation}

\section{Schemes}

The first goal is to for a ring \(A\) construct a sheaf \(\sh O = \mathcal O_{\Spec A}\) on \(\Spec A\), the sheaf of ``regular functions'' on \(\Spec A\).

We recall some facts about localisation. Let \(S \subseteq A\) be a multiplicatively closed subset, i.e.\ \(1 \in S\) and if \(s_1, s_2 \in S\) then \(s_1, s_2 \in S\). Define
\[
  S^{-1}A = \{(a, s): a \in A, s \in S\}/\sim
\]
where \((a, s) \sim (a', s')\) if exists \(s'' \in S\) such that \(s''(as' - a's) = 0\). We write \(\frac{a}{s}\) for the equivalence class of \((a, s)\). This is the \emph{localisation}\index{localisation} of \(A\) at \(S\).

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Let \(S = \{1, f, f^2, \dots\}\) for some \(f \in A\). We write \(A_f = S^{-1}A\).
  \item Let \(\mathfrak p \subseteq A\) a prime ideal, \(S = A \setminus \mathfrak p\). We write \(A_{\mathfrak p} = S^{-1}A\), called \(A\) localised at \(\mathfrak p\). There is a canonical homomorphism
    \begin{align*}
      A &\to A_{\mathfrak p} \\
      a &\mapsto \frac{a}{1}
    \end{align*}
    and the image of \(\mathfrak p\) generates the unique maximal ideal of \(A_{\mathfrak p}\), which we write as \(\mathfrak p A_{\mathfrak p}\). A ring \(A\) is \emph{local} if it has a unqiue maximal ideal, so \(A_{\mathfrak p}\) is local.
  \end{enumerate}
\end{eg}

Now we construct \(\sh O = \mathcal O_{\Spec A}\). In particular we want \(\sh O_{\mathfrak p} = A_{\mathfrak p}\). Define
\[
  \sh O(U) =
  \left\{
    \begin{tabular}{l}
      \(s: U \to \coprod_{\mathfrak p \in U} A_{\mathfrak p}\): \(s(\mathfrak p) \in A_{\mathfrak p}\), \\
      for each \(\mathfrak p \in U\), exists \(\mathfrak p \in V \subseteq U\) and \(a, f \in A\) \\
      such that \(f \notin \mathfrak q, s(\mathfrak q) = \frac{a}{f} \in A_{\mathfrak q}\) for all \(\mathfrak q \in V\)
    \end{tabular}
  \right\}
\]
and the restriction maps are restrictions of functions. This is defined locally so \(\sh O\) is a sheaf (of rings).

\begin{proposition}
  For any \(\mathfrak p \in \Spec A\), \(\sh O_{\mathfrak p} = A_{\mathfrak p}\).
\end{proposition}

\begin{proof}
  We have a well-defined map
  \begin{align*}
    \phi: \sh O_{\mathfrak p} &\to A_{\mathfrak p} \\
    (U, s) &\mapsto s(\mathfrak p)
  \end{align*}
  Surjectivity: any element of \(A_{\mathfrak p}\) can be written as \(\frac{a}{f}\) for some \(a \in A, f \in A \setminus \mathfrak p\). Let
  \[
    D(f) = \Spec A \setminus V((f)) = \{\mathfrak q \in \Spec A: f \notin \mathfrak q\}
  \]
  which is an open neighbourhood of \(\mathfrak q\). Now \(\frac{a}{f}\) defines a section of \(\sh O\) over \(D(f)\) via
  \[
    s(\mathfrak q) = \frac{a}{f} \in A_{\mathfrak q}
  \]
  for all \(\mathfrak q \in D(f)\). In particular \(\phi\) is surjective.

  Injectivity: let \(\mathfrak p \in U \subseteq \Spec A\) and \(s \in \sh O(U)\) with \(s(\mathfrak p) = 0 \in A_{\mathfrak p}\) so \((U, s) \in \ker \phi\). By shrinking we can assume \(s(\mathfrak q) = \frac{a}{f}\) for some \(a \in A, f \notin \mathfrak q\) for all \(\mathfrak q \in U\). There exists \(f' \notin \mathfrak p\) such that \(f'a = 0\). Let \(V = D(f') \cap U\) which is an open neighbourhood of \(\mathfrak p\). Then \((V, s|_V) = 0\) since \(f'a = 0\) implies \(\frac{a}{f} = 0 \in A_{\mathfrak q}\) for all \(\mathfrak q \in V\). Thus \((U, s) = 0 \in \sh O_{\mathfrak p}\) so \(\phi\) is injective.
\end{proof}

\begin{proposition}
  For any \(f \in A\), \(\sh O(D(f)) \cong A_f\). In particular \(\sh O(\Spec A) = A\).
\end{proposition}

\begin{proof}
  Define
  \begin{align*}
    \psi: A_f &\to \sh O(D(f)) \\
    \frac{a}{f^n} &\mapsto (\mathfrak p \mapsto \frac{a}{f^n} \in A_{\mathfrak p})
  \end{align*}
  We first show \(\psi\) is injective: if \(\psi(\frac{a}{f^n}) = 0\) then \(\frac{a}{f^n} = 0 \in A_{\mathfrak p}\) for all \(\mathfrak p \in D(f)\). Thus for each \(\mathfrak p\), exists \(h \notin \mathfrak p\) such that \(ah = 0\) in \(A\). Let
  \[
    I = \{g \in A: g a = 0\}
  \]
  so \(h \in I, h \notin \mathfrak p\) so \(I \nsubseteq \mathfrak p\). This is true for all \(\mathfrak p \in D(f)\), so \(V(I) \cap D(f) = \emptyset\). Thus
  \[
    f \in \bigcap_{\mathfrak p \in V(I)} \mathfrak p = \sqrt I,
  \]
  the radical of \(I\). Thus \(f^n \in I\) for some \(I\). Thus \(f^n a = 0\) so \(\frac{a}{f} = 0 \in A_f\).

  To show surjectivity, let \(s \in \sh O(D(f))\). Cover \(D(f)\) with open sets \(V_i\) on which \(s\) is represented by \(\frac{a_i}{gi}\) where \(a_i \in A, g_i \notin \mathfrak q\) for all \(\mathfrak q \in V_i\). By example sheet 1 question 1, the basic open sets form a basis for the topology of \(\Spec A\), so we can asume \(V_i = D(h_i)\) for some \(h_i \in A\). Since \(D(h_i) \subseteq D(g_i)\) and
  \begin{align*}
    D(h_i) \subseteq D(g_i)
    &\iff V((h_i)) \supseteq V((g_i)) \\
    &\iff \sqrt{(h_i)} \subseteq \sqrt{(g_i)} \\
    &\iff h_i^n \in (g_i) \text{ for some } n
  \end{align*}
  so \(h_i^n = c_i g_i\) for some \(c_i \in A\). Since \(\frac{a_i}{g_i} = \frac{c_i a_i}{h_i^n}\), we can assume \(g_i = h_i^n\). But also \(D(h_i) = D(h_i^n)\), we can replace \(h_i\) by \(h_i^n\) and assume that \(D(f)\) is covered by sets \(D(h_i)\) on which \(s\) is represented by \(\frac{a_i}{h_i}\). In fact, we claim that \(D(f)\) can be covered by a finite number of the \(D(h_i)\):
  \begin{align*}
    D(f) \subseteq \bigcup D(h_i)
    &\iff V((f)) \supseteq \bigcap_{i \in I} V((h_i)) = V(\sum_{i \in I} (h_i)) \\
    &\iff f \in \sqrt{\sum_{i \in I} (h_i)} \\
    &\iff f^m \in \sum_{i \in I} (h_i)
  \end{align*}
  for some \(n\). This means that \(f^m = \sum b_i h_i\) where all but a finite number of \(b_i\)'s are zero. So we can just take these \(h_i\) with \(b_i \neq 0\) and then \(\{D(h_i)\}\) still cover \(D(f)\).

  Thus we can now assume we have a finite covering \(\{D(h_i)\}\) of \(D(f)\) with \(s\) represented by \(\frac{a_i}{h_i}\) on \(D(h_i)\). On \(D(h_i) \cap D(h_j) = D(h_i h_j)\), note \(\frac{a_i}{h_i}, \frac{a_j}{h_j}\) both represent \(s\) so
  \[
    \frac{a_i}{h_i} = \frac{a_j}{h_j} \in A_{h_ih_j}
  \]
  which follows from injectivity of \(\psi\) on the open set \(D(h_ih_j)\). Therefore there exists \(n\) such that
  \[
    (h_ih_j)^n (h_j a_i - h_i a_j) = 0.
  \]
  Choose \(n\) large enough to work for all \(i, j\). Rewrite the equation as \(h_j^{n + 1} (h_ia_j) - h_i^{n + 1} (h_j^n a_i) = 0\). Replace each \(h_i\) by \(h_i^{n + 1}\) and \(a_i\) by \(h_i^n a_i\), we can assume \(h_ja_i - h_ia_j = 0\) for all \(i, j\). We also have \(f^m = \sum b_ih_i\) as in the proof of the claim. Let \(a = \sum b_i a_i\). Then for any \(j\),
  \[
    h_j a = \sum_i h_jb_ia_i = \sum_i h_ib_ia_j = f^n.
  \]
  Thus \(\frac{a}{f^n} = \frac{a_j}{h_j}\) on \(D(h_j) \cap D(f)\), i.e.\ in the ring \(A_{fh_j}\). Thus \(\frac{a}{f^n} \in A_f\) defines a section of \(\sh O(D(f))\) whose restriction to \(D(h_j) \cap D(f)\) agrees with \(s\) so \(\psi(\frac{a}{f^n}) = s\) and \(\psi\) is surjective.
\end{proof}

\begin{definition}[ringed space]\index{ringed space}
  A \emph{ringed space} is a pair \((X, \sh O_X)\) with \(X\) a topological space and \(\sh O_X\) a sheaf of rings on \(X\).

  A \emph{morphism between ringed spaces} \(f: (X, \sh O_X) \to (Y, \sh O_Y)\) is data
  \begin{enumerate}
  \item \(f: X \to Y\) continuous,
  \item \(f^\#: \sh O_Y \to f_* \sh O_X\) a morphism of sheaves of rings, i.e.\ for all \(U \subseteq X\), \(f_U^\#: \sh O_Y(U) \to \sh O_X(f^{-1}(U))\).
  \end{enumerate}
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Let \(X\) be a topological space and \(\sh O_X(u) = \{\varphi: U \to \R \text{ continuous}\}\). Note \(f: X \to Y\) induces \(f: (X, \sh O_X) \to (Y, \sh O_Y)\) by
    \[
      f_U^\#(\varphi) = \varphi \compose f: f^{-1}(U) \to \R.
    \]
    In other words, there is no additional information in the ringed space structure and all data is encoded in the topological spaces themselves.
  \item Let \(X\) be a variety and \(\sh O_X\) the sheaf of regular functions on \(X\). Given \(f: X \to Y\) a morphism of varieties, we again get \(f_U^\#\) which acts by pullback.
  \end{enumerate}
\end{eg}

Both of these examples have the feature that \(\sh O_{X, p}\) is a local ring with maximal ideal \(\{(U, f) \in \sh O_{X, p}: f(p) = 0\}\) by shrinking \(U\): if \(f(p) \neq 0\) then we can assume \(f\) is nowhere zereo so \((U, f^{-1}) \in \sh O_{X, p}\). This inspires us to define

\begin{definition}[locally ringed space]\index{locally ringed space}
  A \emph{locally ringed space} \((X, \sh O_X)\) is a ringed space such that \(\sh O_{X, p}\) is a lcoal ring for all \(p \in X\).

  A \emph{morphism between locally ringed spaces} \(f: (X, \sh O_X) \to (Y, \sh O_Y)\) is a morphism of ringed spaces such that \(f_p^\#: \sh O_{Y, f(p)} \to \sh O_{X, p}\) is a local homomorphism for all \(p \in X\).
\end{definition}
Here
\begin{align*}
  f_p^\#: \sh O_{Y, f(p)} &\to \sh O_{X, p} \\
  (U, s) &\mapsto (f^{-1}(U), f_U^\#(s))
\end{align*}
and a homomorphism \(\varphi: (A, \mathfrak m_A) \to (B, \mathfrak m_B)\) between local rings is \emph{local}\index{local homomorphism} if \(\varphi^{-1}(\mathfrak m_B) = \mathfrak m_A\). Note that we always have \(\varphi^{-1}(\mathfrak m_B) \subseteq \mathfrak m_A\).

The local homomorphism condition thus says that, for example in the two examples above, if a function vanishes at \(f(p)\) then its pullback vanishes at \(p\).

\begin{eg}
  \((\Spec A, \sh O_{\Spec A})\) is a locally ringed space.
\end{eg}

\begin{definition}[affine scheme]\index{affine scheme}
  The \emph{category of affine schemes} is the category whose objects are \((\Spec A, \sh O_{\Spec A})\) for all rings \(A\) and morphisms are morphisms as locally ringed spaces.
\end{definition}

\begin{theorem}
  The category of affine schemes is equivalent to \(\c{Ring}^{\mathrm{op}}\).
\end{theorem}

\begin{proof}
  Need to show
  \begin{enumerate}
  \item if \(\varphi: A \to B\) is a homomorphism then we get a morphism of locally ringed spaces \((f, f^\#): (\Spec B, \sh O_{\Spec B}) \to (\Spec A, \sh O_{\Spec A})\).
  \item any morphism \((f, f^\#): (\Spec B, \sh O_{\Spec B}) \to (\Spec A, \sh O_{\Spec A})\) is contructed as in 1 from some ring homomorphism \(\varphi: A \to B\).
  \end{enumerate}

  Let's do 1 first. Given \(\varphi: A \to B\), define
  \begin{align*}
    f: \Spec B &\to \Spec A \\
    \mathfrak p &\mapsto \varphi^{-1}(\mathfrak p)
  \end{align*}
  \(f\) is continuous as for \(I \subseteq A\),
  \begin{align*}
    f^{-1}(V(I))
    &= \{\mathfrak p \in \Spec B: \varphi^{-1}(\mathfrak p) \supseteq I\} \\
    &= \{\mathfrak p \in \Spec B: \mathfrak p \supseteq \varphi(I)\} \\
    &= V(\varphi(I))
  \end{align*}
  For \(\mathfrak p \in \Spec B\), we obtain
  \begin{align*}
    \varphi_{\mathfrak p}: A_{\varphi^{-1}({\mathfrak p})} &\to B_{\mathfrak p} \\
    \frac{a}{s} &\mapsto \frac{\varphi(a)}{\varphi(s)}
  \end{align*}
  which makes sense as if \(s \notin \varphi^{-1}(\mathfrak p)\) then \(\varphi(s) \notin \mathfrak p\). It is also well-defined. Note \(\varphi_{\mathfrak p}\) is a local homomorphism: indeed the maximal ideal of \(B_{\mathfrak p}\) is generated by the image of \(\mathfrak p\), which we often write as \(\mathfrak p B_{\mathfrak p}\) and similarly the maximal ideal of \(A_{\varphi^{-1}(\mathfrak p)}\) is \(\varphi^{-1}(\mathfrak p) A_{\varphi^{-1}(\mathfrak p)}\) and clearly \(\varphi_{\mathfrak p}^{-1} (\mathfrak p B_{\mathfrak p}) = \varphi^{-1}(\mathfrak p) A_{\varphi^{-1}(\mathfrak p)}\).

  Thus given \(V \subseteq \Spec A\), we get
  \begin{align*}
    f_V^\#: \sh O_{\Spec A} (V) &\to (f_* \sh O_{\Spec B})(V) = \sh O_{\Spec B}(f^{-1}(V)) \\
    (\mathfrak p \mapsto s(\mathfrak p)) &\mapsto (\mathfrak q \mapsto \varphi_{\mathfrak q} (s (f(\mathfrak q))))
  \end{align*}
  where \(\mathfrak p \in V, \mathfrak q \in f^{-1}(V)\). If locally \(s\) is represented on \(W\) by \(\frac{a}{f}\) then \(f_V^\#(s)\) is locally represented on \(f^{-1}(W)\) by \(\frac{\varphi(a)}{\varphi(f)}\). This defined \(f^\#: \sh O_{\Spec A} \to f_* \sh O_{\Spec B}\) and since \(f^\#\) induces \(\varphi_{\mathfrak q}\) on stalks, this defines a morphism of locally ringed spaces.

  Conversely, suppose given \((f, f^\#): (\Spec B, \sh O_{\Spec B}) \to (\Spec A, \sh O_{\Spec A})\), we get
  \[
    \varphi = f_{\Spec A}^\#: \Gamma(\Spec A, \sh O_{\Spec A}) = A \to \Gamma(\Spec B, \sh O_{\Spec B}) = B
  \]
  and we need to show \(\varphi\) gives rise to \((f, f^\#)\) using the construction in the first part. We have a commutative diagram
  \[
    \begin{tikzcd}
      A \ar[r, "\varphi"] \ar[d] & B \ar[d] \\
      A_{f(\mathfrak p)} \ar[r, "f_{\mathfrak p}^\#"] & B_{\mathfrak p}
    \end{tikzcd}
  \]
  where \(\varphi\) is induced by the map on sections, the vertical maps are passing to stalks, which are easily seen to be localisations, and the bottom map is the induced map on stalks so is a local homomorphism. Since pullback of the maximal ideal in the localisation gives the prime ideal, we have \(\varphi^{-1}(\mathfrak p) = f(\mathfrak p)\). Note that this depends crucially on the fact that we have a local homomorphism. Thus we conclude that \(f\) is induec by \(\varphi\) and \(f_{\mathfrak p}^\# = \varphi_{\mathfrak p}\). Thus \(f^\#\) agrees with the map constructed from \(\varphi\) in the first part.
\end{proof}

Now we make a slight modification to the definition of affine scheme:
\begin{definition}[affine scheme]\index{affine scheme}
  An \emph{affine scheme} is a locally ringed space isomorphic in the category of locally ringed spaces to \((\Spec A, \sh O_{\Spec A}\) for some \(A\).
\end{definition}

\begin{definition}[scheme]\index{scheme}
  A \emph{scheme} is a locally ringed space \((X, \sh O_X)\) with an open cover \(\{(U_i, \sh O_X|_{U_i})\}\) with each \((U_i, \sh O_X|_{U_i})\) an affine scheme.

  A \emph{morphism of schemes} is a morphism as locally ringed spaces.
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Let \(k\) be a field. Then \(\Spec k\) consists of a singleton \(\{0\}\) and a sheaf over the point, which is just the field \(k\). We write \(\Spec k = (\{0\}, k)\).

    What does a morphism \(f: \Spec k \to X\) for \(X\) a scheme mean? First it selects a point \(f(0) = x \in X\). Second we get a local homomorphism \(f_x^\#: \sh O_{X, x} = \sh O_{\Spec k, 0} = k\), meaning that \(\ker f_x^\# = (f_x^\#)^{-1}(0) = \mathfrak m_x \subseteq \sh O_{X, x}\), where \(\mathfrak m_x\) is the maximal ideal of \(\sh O_{X, x}\). In particular we get a factorisation
    \[
      \sh O_{X, x} \to \sh O_{X, x}/\mathfrak m_x \embed k
    \]
    We call \(k(x) = \sh O_{X, x}/\mathfrak m_x\) the \emph{residue field}\index{residue field} of \(x\) in \(X\).

    Conversely, if given an inclusion \(k(x) \embed k\), we get a morphism \(f: \Spec k \to X\) with \(f(0) = x\) and
    \begin{align*}
      f_U^\#: \sh O_X(U) &\to (f_* k)(U) \\
      s &\mapsto
          \begin{cases}
            (U, s \pmod{\mathfrak m_x}) & x \in U \\
            0 & x \notin U
          \end{cases}
    \end{align*}

    We can ask the opposite question: what does it mean to give a morphism \(f: X \to \Spec k\)? \(f\) is constant but we need \(f^\#: k \to f_* \sh O_X\), i.e.\ \(f^\#_{\Spec k}: k \to \sh O_X(X)\) so \(\Gamma(X, \sh O_X)\) has the structure of a \(k\)-algebra and via omposition with restriction
    \[
      k \to \Gamma(X, \sh O_X) \to \Gamma(U, \sh O_X)
    \]
    so \(\sh O_X\) becomes a sheaf of \(k\)-algebras. We say \(X\) is a \emph{scheme over \(\Spec k\)}\index{scheme!over \(k\)}. A morphism of schemes over \(\Spec k\) is a commutative diagram
    \[
      \begin{tikzcd}[column sep=tiny]
        X \ar[rr, "f"] \ar[dr] & & Y \ar[dl] \\
        & \Spec k
      \end{tikzcd}
    \]
    i.e.\ \(f^\#: \sh O_Y \to f_* \sh O_X\) is a morphsim of sheaves of \(k\)-algebras. More generally we can replace \(\Spec k\) by any scheme \(Z\) and talk about schemes over \(Z\) and their morphisms.
  \item Affine variety: let \(k\) be a field and \(A = k[x_1, \dots, x_n]/I\) with \(I = \sqrt I\). In other words, \(A\) is a finitely generated \(k\)-algebra with no nilpotents. The homomorphism \(k \to A\) gives a map \(\Spec A \to \Spec k\). We say \(\Spec A\) is an \emph{affine variety over \(k\)}.

    If \(k'\) is a field extension of \(k\), a diagram
    \[
      \begin{tikzcd}[column sep=tiny]
        \Spec k' \ar[rr] \ar[dr] & & \Spec A \ar[dl] \\
        & \Spec k
      \end{tikzcd}
    \]
    is the same as giving a \(k\)-algebra homomorphism \(A \to k'\), i.e.\ this is the same thing as giving \((a_1, \dots, a_n) \in (k')^n\) with \(f(a_1, \dots, a_n) = 0\) for all \(f \in I\). With \(X = \Spec A\), we write \(X(k')\) for the set of all such diagrams.

    More generally, we usually fix a base scheme \(S\) and consider the category of schemes over \(S\). Given \(X \to S, T \to S\), we write \(X(T)\) to be the set of morphisms \(T \to X\), the set of \emph{\(T\)-valued points} of \(X\).
  \item An example of a scheme that is not a variety: \(D = \Spec k[t]/(t^2) = (\{(t)\}, k[t]/(t^2))\). \(t\) is a ``function'' on a single point which squares to \(0\). What information is contained in \(D\)? Let \(X\) be any scheme over \(\Spec k\) and consider a morphism \(f: D \to X\) over \(\Spec k\). This specifies a point \(x = f((t)) \in X\) and a local homomorphism of \(k\)-algebras.
    \begin{align*}
      f_x^\#: \sh O_{X, x} &\to \sh O_{D, (t)} = k[t]/(t^2) \\
      \mathfrak m_x &\to (t) \\
      \mathfrak m_x^2 &\to 0
    \end{align*}
    so we obtain a map \(\mathfrak m_x/\mathfrak m_x^2 \to (t) \cong k\) where the isomorphism is as a \(k\)-vector space. We also have a corresponding \(k\)-algebra homomorphism
    \[
      \sh O_{X, x} \to k[t]/(t^2) \to k[t]/(t) \cong k
    \]
    with kernel \(\mathfrak m_x\). This gives an inclusion \(k(x) = \sh O_{X, x}/\mathfrak m_x \embed k\) of \(k\)-algebras, i.e.\ \(k(x) \cong k\). Note \(\mathfrak m_x/\mathfrak m_x^2\) is a \(\sh O_{X, x}/\mathfrak m_x\)-vector space and thus \(\mathfrak m_x/\mathfrak m_x^2 \to k \cong k(x)\) is a map of \(k\)-vector spaces, i.e.\ an element of \((\mathfrak m_x/\mathfrak m_x^2)^*\). This is the \emph{Zariski tangent space}\index{Zariski tangent space} to \(X\) at \(x\). Thus giving \(D \to X\) is the same as giving a point \(x \in X\) with \(k(x) = k\) plus a Zariski tangent vector at \(x\).
  \end{enumerate}
\end{eg}

\paragraph{glued scheme}

(special case of example sheet 1 Q14): given schemes \(X_1, X_2\) and \(U_1 \subseteq X_1, U_2 \subseteq X_2\) open subsets with induced scheme structure \((U_i, \sh O_{X_i}|_{U_i})\) and an isomorphism \(f: U_1 \cong U_2\), we can then glue \(X_1, X_2\) along \(f\) to get a scheme \(X\) with open subsets \(X_1', X_2'\) with \(X_i' \cong X_i, X_1' \cap X_2' \cong U_i\).

\begin{eg}
  Define \(\A_k^n = \Spec k[x_1, \dots, x_n]\). In particular \(\A_k^1 = \Spec k[x]\). Glue
  \begin{align*}
    U_1 &= \A_k^1 \setminus \{0\} \subseteq \A_k^1 = X_1 \\
    U_2 &= \A_k^1 \setminus \{0\} \subseteq \A_k^1 = X_2
  \end{align*}
  where \(0\) denotes the maximal ideal at \(0\) via \(\id: U_1 \to U_2\), then we obtain the affine line with double origin. This is pathological in some sense as in the classical topology this is non-Hausdorff. Later we will be able to pin down precisely what the pathology is.

  Alternatively, glue \(U_1\) to \(U_2\) via \(x \mapsto x^{-1}\): since
  \[
    U_i = D(x) = \Spec k[x]_x = \Spec k[x, x^{-1}]
  \]
  we specify this map via the ring homomorphism \(k[x, x^{-1}] \to k[x, x^{-1}], x \mapsto x^{-1}\). This gives a glued scheme \(\P_k^1\), the \emph{projective line}.
\end{eg}

\subsection{Projective schemes}

The gluing contruction brings about a whole class of schemes that are not affine, called \emph{projective schemes}. They are geometric objects associated to graded rings.

Let \(S = \bigcup_{d \geq 0} S_d\) be a graded ring, meaning that \(S_d \cdot S_e \subseteq S_{d + e}\). For example \(S = k[x_1, \dots, x_n] = \bigcup_{d \geq 0} S_d\) where \(S_d\) is the space of homogeneous polynomials of degree \(d\). If \(f \in S_d\), we say \(f\) is \emph{homogeneous of degree \(d\)} and write \(\deg f = d\). Define \(S_+ = \bigoplus_{d > 0} S_d\), the \emph{irrelevant ideal}\index{irrelevant ideal}. An ideal \(I \subseteq S\) is \emph{homogeneous}\index{homogeneous ideal} if it is generated by homogeneous elements. Define
\[
  \Proj S = \{\mathfrak p \subseteq S \text{ homogeneous prime ideals not containing } S_+\}.
\]

\begin{eg}
  Suppose \(k\) is algebraically closed and define \(\P^1_k = \Proj k[x_0, x_1]\). The maximal ideals of \(k[x_0, x_1]\) are of the form \((x_0 - a_0, x_1 - a_1)\), which is homogeneous if and only if \(a_0 = a_1 = 0\). Hence no maximal ideals of \(k[x_0, x_1]\) lies in \(\Proj k[x_0, x_1]\). By results in commutative algebra, \(k[x_1, x_2]\) has dimesion \(2\) and all other primes of \(k[x_1, x_2]\) are either \(0\) or principal. Consider \(\mathfrak p = (f)\) with \(f\) homogeneous. Thus since \(k = \overline k\), \(f\) can be factored into linear factors. So if \(\mathfrak p\) is prime, in fact \(\mathfrak p = (a_1 x_0 - a_0 x_1)\) for some \(a_0, a_1 \in k\) not both \(0\). Note that the generators of the ideal are written in this way to show that \((a_0, a_1)\) is only defined by up to scaling by an element of \(k^\times\), so these points are in one-to-one correspondence with points of \((k^2 \setminus \{0\})/k^*\).
\end{eg}

Back to the construction of projective schemes. We start to define a topology and a structure sheaf on \(\Proj S\). For \(I \subseteq S\) homogeneous, define
\[
  V(I) = \{\mathfrak p \subseteq \Proj S: \mathfrak p \supseteq I\}.
\]
Check these are the closed sets for a topology in \(\Proj S\).

Fix \(\mathfrak p \in \Proj S\). Let
\[
  T = \{f \in S \setminus \mathfrak p: f \text{ homogeneous}\} \subseteq S
\]
which is a multiplicatively closed set, and let \(S_{(\mathfrak p)} \subseteq T^{-1}S\) be the subring of elements of degree \(0\), where we define \(\deg \frac{a}{b} = \deg a - \deg b\). We require the numerator and the denominator to be the same degree so that it defines a well-defined function on \(\Proj S\). Similarly if \(f \in S\) is homogeneous  write \(S_{(f)} \subseteq S_f\) for the set of elements of degree \(0\) in \(S_f\).

We now define the structure sheaf \(\sh O_{\Proj S}\). For \(U \subseteq S\), define
\[
  \sh O_{\Proj S}(U) =
  \left\{
    \begin{tabular}{l}
      \(s: U \to \coprod_{\mathfrak p \in U} S_{(\mathfrak p)}\): \(s(\mathfrak p) \in S_{(\mathfrak p)}\), \\
      for each \(\mathfrak p \in U\), exists \(\mathfrak p \in V \subseteq U\) \\
      and \(a, f \in S\) homogeneous of the same degree \\
      such that \(f \notin \mathfrak q, s(\mathfrak q) = \frac{a}{f} \in S_{(\mathfrak q)}\) for all \(\mathfrak q \in V\)
    \end{tabular}
  \right\}
\]
This defines \(\sh O_{\Proj S}\) with \(\sh O_{\Proj S, \mathfrak q} = S_{(\mathfrak q)}\), making \((\Proj S, \sh O_{\Proj S})\) a locally ringed space.

\begin{proposition}
  For \(f \in S_+\) homogeneous, define
  \[
    D_+(f) = \{\mathfrak p \in \Proj S: f \notin \mathfrak p\},
  \]
  an open subset of \(\Proj S\). Then \(D_+(f)\)'s cover \(\Proj S\) and
  \[
    (D_+(f), \sh O_{\Proj S}|_{D_+(f)}) \cong \Spec S_{(f)}.
  \]
  In particular \((\Proj S, \sh O_{\Proj S})\) is a scheme.
\end{proposition}

\begin{proof}
  Example sheet 2.
\end{proof}




\printindex
\end{document}
