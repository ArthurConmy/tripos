\documentclass[a4paper]{article}

\def\npart{II}

\def\ntitle{Number Fields}
\def\nlecturer{J.\ Thorne}

\def\nterm{Lent}
\def\nyear{2018}

\input{header}

\renewcommand*{\O}{\mathcal{O}}
\DeclareMathOperator{\n}{N}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\Cl}{Cl}%ideal class group

\makeindex

\begin{document}

\input{titlepage}

\tableofcontents

\setcounter{section}{-1}

\section{Motivation}

Recall the following example from IB Groups, Rings and Modules:

\begin{theorem}
  Let \(p\) be an odd prime, then \(p = a^2 + b^2\) if and only if \(p = 1 \pmod 4\).
\end{theorem}

\begin{proof}
  If \(p = a^2 + b^2\) then \(p = 0, 1 \text{ or } 2 \pmod 4\) so this condition is necessary.

  Suppose instead \(p = 1 \pmod 4\), then \(\binom{-1}{p} = 1\) so there exists \(a \in \Z\) such that \(a^2 = 1 \pmod p\), or \(p \divides a^2 + 1\). We can factor \(a^2 + 1 = (a + i)(a - i) \in \Z[i]\). We know from IB Groups, Rings and Modules that \(\Z[i]\) is a UFD. As \(p \divides (a + i)(a - i)\), if \(p\) is irreducible in \(\Z[i]\)  then \(p \divides a + i\) or \(p \divides a - i\). Thus \(p \in \Z[i]\) is reducible so \(p = z_1z_2\) with \(z_1z_2 \in \Z[i]\). If \(z_1 = A + Bi\) where \(A, B \in \Z\) then \(A^2 + B^2 = p\).
\end{proof}

\begin{notation}
  If \(R \subseteq S\) are rings and \(\alpha \in S\) then
  \[
    R[\alpha] = \left\{ \sum{i = 0}^n a_i\alpha^i \in s: a_i \in R \right\}
  \]
  which is the smallest subring of \(S\) containing both \(R\) and \(\alpha\).
\end{notation}

Another example is given \(p\) an odd prime, does the equation
\[
  x^p + y^p = z^p
\]
have solutions such that \(x, y, z \in \Z, xyz \neq 0\)?

\begin{theorem}[Kummer, 1850]
  If \(\Z[e^{2\pi i/p}]\) is a UFD then there are no solutions.
\end{theorem}

The strategy is to factor
\[
  x^p + y^p = \prod_{j = 0}^{p - 1} (x + e^{2\pi ij/p}j) \in \Z[e^{2\pi i/p}].
\]
We now know that \(\Z[e^{2\pi i/p}]\) is a UFD if and only if \(p \leq 19\), so unfortunately this does not lead us very far. Instead, we have the more power theorem

\begin{theorem}[Kummer, 1850]
  If \(p\) is a \emph{regular} prime then there are no solutions.
\end{theorem}

We will define regular prime later in this course. This theorem is more powerful that the previous one. To give an idea, if \(p < 100\) then \(p\) is regular if and only if \(p \neq 37, 59, 67\).

Given a number field, this course studies the ring of integers. In the end of the course we will come back to Kummer's theorem.

\section{Ring of integers}

Recall that a field extension \(L/K\) is an inclusion \(K \subseteq L\) of fields. The degree of \(L/K\) is
\[
  [L:K] = \dim_K L.
\]
We say \(L/K\) is finite if \([L:K] < \infty\).

\begin{definition}[Number field]\index{number field}
  A \emph{number field} is a finite extension \(L/\Q\).
\end{definition}

Here are two ways to construct number fields:
\begin{enumerate}
\item Let \(\alpha \in \C\) be an algebraic number. Then \(L = \Q(\alpha)\) is a number field.
\item Let \(K\) be a number field \(K\) and \(f(x) \in K[x]\) be irreducible. Then \(L = K[x]/(f(x))\) is a number field. Recall Tower Law from IID Galois Theory:
  \[
    [L:\Q] = [L:K][K:\Q] < \infty.
  \]
\end{enumerate}
Note that the first one comes with an embedding in \(\C\), but the second one doesn't (and in general there are more than one).

\begin{definition}[Algebraic integer]\index{algebraic integer}\leavevmode
  \begin{enumerate}
  \item Let \(L/K\) be a field extension. We say \(\alpha \in L\) is \emph{algebraic} over \(K\) if there exists a monic polynomial \(f(x) \in K[x]\) such that \(f(\alpha) = 0\).
  \item Let \(L/\Q\) be a field extension. We say \(\alpha \in L\) is an \emph{algebraic integer} if there exists a monic polynomial \(f(x) \in \Z[x]\) such that \(f(\alpha) = 0\).
  \end{enumerate}
\end{definition}

\begin{definition}[Minimal polynomial]\index{minimal polynomial}
  Let \(L/K\) be a field extension and let \(\alpha \in L\) be an algebraic over \(K\). We call the \emph{minimal polynomial} of \(\alpha\) over \(K\) the monic polynomial \(f_\alpha(x) \in K[x]\) of the least degree such that \(f_\alpha(\alpha) = 0\).
\end{definition}

Note that \(f_\alpha(x)\) is well-defined: firstly there exists some monic \(f(x) \in K[x]\) such that \(f(\alpha) = 0\) since \(\alpha\) is algebraic. If \(f_\alpha(x), f_\alpha'(x) \in K[x]\) both satisfy the definition of minimal plynomial then we apply the polynomial division algorithm to write
\[
  f_\alpha(x) = q(x)f_\alpha'(x) + r(x)
\]
where \(p(x), r(x) \in K[x]\) and \(\deg r < \deg f_\alpha'\). Evaluate at \(\alpha\), we get
\[
  0 = f_\alpha(\alpha) = p(\alpha)f_\alpha'(\alpha) + r(\alpha) = r(\alpha)
\]
so by minimality of \(\deg f_\alpha'\), \(r = 0\). Then \(\deg f_\alpha = \deg f_\alpha'\) and they are both monic so \(p = 1\). \(f_\alpha = f_\alpha'\).

\begin{lemma}
  Let \(L/\Q\) be a field extension and let \(\alpha \in L\) to be an algebraic integer. Then
  \begin{enumerate}
  \item the minimal polynomial \(f_\alpha(x)\) of \(\alpha\) over \(\Q\) lies in \(\Z[x]\);
  \item if \(g(x) \in \Z[x]\) satisfies \(g(\alpha) = 0\) then there exists \(q(x) \in \Z[x]\) such that \(g(x) = f_\alpha(x)q(x)\);
  \item the kernel of the ring homomorphism
    \begin{align*}
      \Z[x] &\to L \\
      f(x) &\mapsto f(\alpha)
    \end{align*}
    equals to \((f_\alpha(x))\).
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Recall from IB Groups, Rings and Modules that given \(f(x) = \sum_{i = 0}^n a_ix^i \in \Z[x]\), we define the content to be
    \[
      c(f) = \gcd(a_n, \dots, a_0).
    \]
    Gauss' Lemma says that if \(f(x), g(x) \in \Z[x]\) then \(c(fg) = c(f)c(g)\).

    Since \(\alpha \in L\) is an algebraic integer, there exists a monic \(f(x) \in \Z[x]\) such that \(f(\alpha) = 0\). Thus \(c(f) = 1\). Apply polynomial division in \(\Q[x]\) to get
    \[
      f(x) = p(x)f_\alpha(x) + r(x)
    \]
    where \(p(x), r(x) \in \Q[x]\). Same as before, we must have \(r(x) = 0\) so \(f(x) = p(x)f_\alpha(x)\). Now choose integers \(n, m \geq 1\) such that \(np(x) \in \Z[x], c(np) = 1\) and \(mf_\alpha(x) \in \Z[x], c(mf_\alpha) = 1\). Then
    \[
      nmf(x) = np(x) \cdot mf_\alpha(x).
    \]
    Take contents,
    \[
      nm = c(nmf(x)) = c(np \cdot mf_\alpha) = c(np)c(mf_\alpha) = 1.
    \]
    Thus \(n = m = 1\) so \(f_\alpha(x) \in \Z[x]\).
  \item This is similar to the previous one. Let \(g(x) \in \Z[x]\) be such that \(g(\alpha) = 0\). wlog \(g(x) \neq 0\) and \(c(g) = 1\). We deduce \(g(x) = q(x)f_\alpha(x)\) where \(q(x) \in \Q[x]\). Choose \(k \geq 1\) such that \(kq(x) \in \Z[x]\) and \(c(kq) = 1\). Then
    \[
      k = c(kg) = c(kq \cdot f_\alpha) = c(kq) c(f_\alpha) = 1
    \]
    so \(q(x) \in \Z[x]\).
  \item Reformulation of (2).
  \end{enumerate}
\end{proof}

\begin{corollary}
  If \(a \in \Q\), then \(\alpha\) is an algebraic integer if and only if \(\alpha \in \Z\).
\end{corollary}

\begin{proof}
  By the above lemma, \(\alpha\) is an algebraic integer if and only if \(f_\alpha(x) \in \Z[x]\). If \(\alpha \in \Q\) then \(f_\alpha(x) = x - \alpha\).
\end{proof}

\begin{notation}
  If \(L/\Q\) is a field extension, we write
  \[
    \O_L = \{\alpha \in L: \alpha \text{ is an algebraic integer}\}.
  \]
\end{notation}

\begin{proposition}
  If \(L/\Q\) is a field extension, \(\O_L\) is a ring.
\end{proposition}

\begin{proof}
  \(0, 1 \in \O_L\). If \(\alpha \in \O_L\) then
  \[
    f_{-\alpha}(x) = (-1)^{\deg f_\alpha} f_\alpha(-x)
  \]
  so \(-\alpha \in \O_L\). Easy. Now given \(\alpha, \beta \in \O_L\), we need to show \(\alpha + \beta, \alpha\beta \in \O_L\). First notice the following characterisation of algebraic integers: if \(\alpha \in \O_L\) then \(\Z[\alpha] \subseteq L\) is a finitely generated \(\Z\)-module: by definition, \(\Z[\alpha]\) is generated by \(1, \alpha, \alpha^2, \dots\). Let
  \[
    f_\alpha(x) = x^d + a_1x^{d - 1} + \dots + a_d \in \Z[x],
  \]
  then
  \[
    \alpha^d = -(a_1\alpha^{d - 1} + \dots + a_d) \in \sum_{i = 0}^{d - 1} \Z \alpha^i.
  \]
  Thus by induction, \(\alpha^n \in \sum_{i = 0}^{d - 1}\Z \alpha^i\) for all \(n \geq d\).

  Now take \(\alpha, \beta \in \O_L\) and let \(d = \deg f_\alpha, e = \deg f_\beta\). By definition, \(\Z[\alpha, \beta] = \Z[\alpha][\beta]\) is generated as an \(\Z\)-module by \(\{\alpha^i\beta^j\}_{i, j \in \N_0}\). The same argument shows that in fact the ring is generated as a \(\Z\)-module by \(\{\alpha^i\beta^j\}_{0 \leq i < d, 0 \leq j < e}\). Now use classification of finitely generated \(\Z\)-modules, there is an isomorphism
  \[
    \Z[\alpha, \beta] \cong \Z^r \oplus T
  \]
  for some \(r \geq 1\) and finite abelian group \(T\). In fact \(T = 0\): if \(\gamma \in T\) then \(|T|\gamma = 0\) by Lagrange's Theorem. But \(\Z[\alpha, \beta] \subseteq L\), a \(\Q\)-vector space, so this forces \(\gamma = 0\). We can therefore fix an isomorphism
  \[
    \Z[\alpha, \beta] \cong \Z^r
  \]
  for some \(r \geq 1\). Now there is a \(\Z\)-module endomorphism
  \begin{align}
    m_{\alpha\beta}: \Z[\alpha, \beta] &\to \Z[\alpha, \beta] \\
    \gamma &\mapsto \alpha\beta\gamma
  \end{align}
  \(m_{\alpha\beta}\) can be represented by an \(r \times r\) matrix \(A_{\alpha\beta} \in \matrixring_{r \times r}(\Z)\). Let
  \[
    F_{\alpha\beta}(x) = \det(x \cdot I_r - A_{\alpha\beta}) \in \Z[x]
  \]
  be the characteristic polynomial. Then by Cayley-Hamilton Theorem,
  \[
    F_{\alpha\beta}(m_{\alpha\beta}) = 0.
  \]
  Write
  \[
    F_{\alpha\beta}(x) = x^r + b_1x^{r - 1} + \dots + b_r \in \Z[x]
  \]
  so
  \[
    m_{\alpha\beta}^r + b_1m_{\alpha\beta}^{r - 1} + \dots + b_r \cdot \id = 0.
  \]
  Apply the above endomorphism to \(1 \in \Z[\alpha, \beta]\), we get
  \[
    (\alpha\beta)^r + b_1(\alpha\beta)^{r - 1} + \dots + b_r = F_{\alpha\beta}(\alpha\beta) = 0
  \]
  so \((\alpha\beta)^r \in \O_L\).

  The argument to show \(\alpha + \beta \in \O_L\) is identical, replacing \(m_{\alpha\beta}\) by
  \begin{align*}
    m_{\alpha + \beta}: \Z[\alpha, \beta] &\to \Z[\alpha, \beta] \\
    \gamma &\mapsto (\alpha + \beta)\gamma
  \end{align*}
\end{proof}

\begin{definition}[Ring of integers]\index{ring of integers}
  \(\O_L\) is the \emph{ring of algebraic integers} of \(L\).
\end{definition}

\begin{lemma}
  Let \(L/\Q\) be a number field and let \(\alpha \in L\). Then there exists \(n \in \Z, n \geq 1\) such that \(n \alpha \in \O_L\).
\end{lemma}

\begin{proof}
  Let \(f(x) \in \Q[x]\) be a monic polynomial such that \(f(\alpha) = 0\). Then there exists \(n \in \Z, n \geq 1\) such that \(g(x) = n^{\deg f} f(x/n) \in \Z[x]\) is monic. Then
  \[
    g(n\alpha) = n^{\deg f} f(\alpha) = 0
  \]
  so \(n\alpha \in \O_L\).
\end{proof}

\section{Complex Embeddings}

Let \(L\) be a number field.

\begin{definition}[Complex embedding]\index{complex embedding}
  A \emph{complex embedding} of \(L\) is a field homomorphism
  \[
    \sigma: L \to \C.
  \]
\end{definition}

\begin{note}
  In this case \(\sigma\) is injective and \(\sigma|_\Q\) is the unique embedding \(\Q \to \C\).
\end{note}

\begin{proposition}
  Let \(L/K\) be an extension of number fields, and let \(\sigma_0: K \to \C\) be a complex embedding. Then there exist exactly \([L:K]\) embeddings \(\sigma: L \to \C\) such that \(\sigma|_K = \sigma_0\).
\end{proposition}

\begin{proof}
  By induction on \([L:K]\). If \([L:K] = 1\) then \(L = K\).

  In general, choose \(\alpha \in L \setminus K\) and consider \(L/K(\alpha)/K\). By the Tower Law
  \[
    [L:K] = [L:K(\alpha)][K(\alpha):K]
  \]
  and \([K(\alpha):K] > 1\). By induction, it suffices to show that there are exactly \([K(\alpha):K]\) embeddings \(\sigma: K(\alpha) \to \C\) extending \(\sigma_0\). Let \(f_\alpha(x) \in K[x]\) be the minimal polynomial of \(\alpha\) over \(K\). Notice that there is an isomorphism of fields
  \begin{align*}
    K[x]/(f_\alpha(x)) &\to K(\alpha) \\
    x &\mapsto \alpha
  \end{align*}
  To get a complex embedding \(\sigma: K(\alpha) \to \C\) extending \(\sigma_0\), it's equivalent to give a root \(\beta\) of \((\sigma_0f_\alpha)(x)\) in \(\C\). We have
  \[
    [K(\alpha):K] = \deg f_\alpha = \deg \sigma_0f_\alpha
  \]
  so it suffices to show that \(\sigma_0f_\alpha\) has distinct roots in \(\C\). The polynomial \(f_\alpha(x) \in K[x]\) is irreducible so is prime to its derivative \(f_\alpha'(x)\). We can therefore find \(A(x), B(x) \in K[x]\) such that
  \[
    Af_\alpha + Bf_\alpha' = 1.
  \]
  Hence
  \[
    (\sigma_0 A)(\sigma_0f_\alpha) + (\sigma_0B)(\sigma_0f_\alpha') = 1.
  \]
  Hence if \(\beta \in \C\) and \((\sigma_0f_\alpha)(\beta) = 0\), \((\sigma_0f_\alpha')(\beta) \neq 0\).
\end{proof}

\begin{notation}
  If \(\sigma: L \to \C\) is a complex embedding, then \(\conj \sigma\) is also a complex embedding where \(\conj \sigma(\alpha) = \conj{\sigma(\alpha)}\). In the other words, complex conjugation is an automorphism of \(\C\) and we can post-compose it with any field embedding.

  If \(\sigma = \conj \sigma\) then \(\sigma(L) \subseteq \R\). Otherwise \(\sigma \neq \conj \sigma\) and \(\sigma(L)\) is not contained in \(\R\). We write \(r\) for the number of complex embeddings \(\sigma\) such that \(\sigma = \conj \sigma\) and \(s\) for the number of pairs of embeddings \(\{\sigma, \conj \sigma\}\) where \(\sigma \neq \conj \sigma\). It then follows that
  \[
    r + 2s = [L:\Q].
  \]
\end{notation}

\begin{eg}[Quadratic field]\index{quadratic field}
  Let \(d \in \Z\) be square-free and \(d \neq 0, 1\). Let\
  \[
    \Q(\sqrt d) = \Q[x]/(x^2 - d).
  \]
  If \(d > 0\) then \(r = 2, s = 0\), which we call real quadratic field. If \(d < 0\) then \(r = 0, s = 1\), which we call imaginary quadratic field.
\end{eg}

\begin{eg}
  Let \(m \in \Z\) be cube-free and \(m \neq -1, 0, 1\). Let
  \[
    \Q(\sqrt[3]{m}) = \Q[x]/(x^3 - m).
  \]
  Then \(r = 1, s = 1\).
\end{eg}

\begin{definition}[Trace \& norm]\index{trace}\index{norm}
  Let \(L/K\) be a extension of number fields and let \(\alpha \in L\). Let \(m_\alpha\) be the \(K\)-linear map
  \begin{align*}
    m_\alpha: L &\to L \\
    \beta &\mapsto \alpha\beta
  \end{align*}
  Then we define the \emph{trace} of \(\alpha\) to be
  \[
    \tr_{L/K}(\alpha) = \tr m_\alpha \in K
  \]
  and the \emph{norm} of \(\alpha\) to be
  \[
    \n_{L/K}(\alpha) = \det m_\alpha \in K.
  \]
\end{definition}

\begin{lemma}
  If \(L/K\) is an extension of number fields and \(\alpha \in L\), then
  \begin{enumerate}
  \item \(\tr_{L/K}(\alpha) = [L:K(\alpha)] \tr_{K(\alpha)/K}(\alpha)\).
  \item \(\n_{L/K}(\alpha) = \n_{K(\alpha)/K}(\alpha)^{[L:K(\alpha)]}\).
  \end{enumerate}
\end{lemma}

\begin{proof}
  There is an isomorphism \(L \cong K(\alpha)^{[L:K(\alpha)]}\) of \(K(\alpha)\)-vector spaces.
\end{proof}

\begin{lemma}
  Let \(L/K\) be an extension of number fields and let \(\alpha \in L\). Let \(\sigma_0: K \to \C\) be a complex embedding and \(\sigma_1, \dots, \sigma_n: L \to \C\) be complex embeddings extending \(\sigma_0\). Then
  \begin{align*}
    \sigma_0(\tr_{L/K}(\alpha)) &= \sum_{i = i}^n \sigma_i(\alpha) \\
    \sigma_0(\n_{L/K}(\alpha)) &= \prod_{i = 1}^n \sigma_i(\alpha)
  \end{align*}
\end{lemma}

\begin{proof}
  wlog \(L = K(\alpha)\). Let \(f_\alpha(x) \in K[x]\) be the minimal polynomial of \(\alpha\) over \(K\). Recall that
  \[
    (\sigma_0f_\alpha)(x) = \prod_{i = 1}^n (x - \sigma_i(\alpha)).
  \]
  Write \(f_\alpha(x) = x^n + a_1x^{n - 1} + \dots + a_n\). Then
  \begin{align*}
    \sigma_0(a_1) &= - \sum_{i = 1}^n \sigma_i(\alpha) \\
    \sigma_0(a_n) &= (-1)^n \prod_{i = 1}^n \sigma_i(\alpha)
  \end{align*}
  Let \(g(x) \in K[x]\) be the characteristic polynomial of \(m_\alpha\). If \(g(x) = x^n + b_1x^{n - 1} + \dots + b_n\) then
  \begin{align*}
    b_1 &= -\tr m_\alpha = -\tr_{L/K}(\alpha) \\
    b_n &= (-1)^n\det m_\alpha = (-1)^n \n_{L/K}(\alpha)
  \end{align*}
  so done if we can show \(f_\alpha(x) = g(x)\). By Cayley-Hamilton, \(g(m_\alpha) = 0\) so \(g(\alpha) = 0\). Thus \(f_\alpha(x) = g(x)\).
\end{proof}

\begin{corollary}
  If \(\alpha \in \O_L\) then \(\tr_{L/K}(\alpha), \n_{L/K}(\alpha) \in \O_K\).
\end{corollary}

\begin{proof}
  We have the following characterisation of ring of integers: if \(\beta \in L\) then \(\beta \in \O_L\) if and only if \(\sigma_0(\beta) \in \O_\C\) as for all \(f(x) \in \Z[x]\), \(f(\beta) = 0\) if and only if \(f(\sigma_0(\beta)) = 0\).

  By the lemma, \(\sigma_0 \tr_{L/K}(\alpha) = \sigma_1(\alpha) + \dots + \sigma_n(\alpha)\). If \(\alpha \in \O_L\) then \(\sigma_i(\alpha) \in \O_\C\) for all \(i\). But \(\O_\C\) is a ring so \(\sigma_0 \tr_{L/K}(\alpha) \in \O_\C\). Thus \(\tr_{L/K}(\alpha) \in \O_K\). Similar for norm.
\end{proof}

\begin{proposition}[Classification of ring of integers of quadratic fields]
  Let \(d \in \Z\) be square-free and \(d \neq 0, 1\). Let \(L = \Q(\sqrt d)\). Then
  \[
    \O_L =
    \begin{cases}
      \Z[\sqrt d] & \text{if } d = 2, 3 \pmod 4 \\
      \Z[\frac{1 + \sqrt d}{2}] & \text{if } d = 1 \pmod 4
    \end{cases}
  \]
\end{proposition}

\begin{proof}
  We have a nice characterisation of algebraic integers in the case of quadratic fields: if \(\alpha \in L\), then \(\alpha \in \O_L\) if and only if \(\tr_{L/\Q}(\alpha), \n_{L/\Q}(\alpha) \in \Z\). (Why?)

  Let \(\alpha \in L\). Write \(\alpha = \frac{u}{2} + \frac{v}{2}\sqrt d\) where \(u, v \in \Q\). If \(\alpha \in \O_L\) then
  \begin{align*}
    \tr_{L/\Q}(\alpha) &= u \in \Z \\
    \n_{L/\Q}(\alpha) &= \frac{1}{4}(u + v\sqrt d)(u - v\sqrt d) = \frac{1}{4}(u^2 - dv^2) \in \Z
  \end{align*}
  so \(u^2 - dv^2 \in 4\Z\), \(dv^2 \in \Z\). Write \(v = \frac{r}{s}\) where \(r, s \in \Z\) and are coprime. Then \(dr^2 \in s^2\Z\) so \(s^2 \divides dr^2\). If \(p\) is a prime and \(p \divides s\) then \(p^2 \divides d\). But this is absurd as \(d\) is square-free. Thus \(v \in \Z\).

  We have shown that if \(\alpha \in \O_L\) then \(\alpha = \frac{u}{2} + \frac{v}{2}\sqrt d\) where \(u, v \in \Z\) and \(u^2 = dv^2 \pmod 4\). Split into cases:
  \begin{enumerate}
  \item \(d = 2, 3 \pmod 4\): \(u^2 = 0, 1 \pmod 4, v^2 = 0, 1 \pmod 4\). Consider the congruence \(u^2 =dv^2 \pmod 4\) shows that both \(u, v \in 2\Z\). Hence \(\alpha \in \Z[\sqrt d]\). Thus \(\O_L = \Z[\sqrt d]\).
  \item \(d = 1 \pmod 4\): \(u^2 = v^2 \pmod 4\) so \(u = v \pmod 2\). Hence
    \[
      \O_L \subseteq \left\{ \frac{u}{2} + \frac{v}{2}\sqrt d: u, v \in \Z, u = v \pmod 2 \right\} \cong \Z\oplus\Z\cdot \left(\frac{1 + \sqrt d}{2} \right).
    \]
    It thus remains to show that \(\frac{1 + \sqrt d}{2}\) is an algebraic integer. But we know
    \begin{align*}
      \tr_{L/\Q} \frac{1 + \sqrt d}{2} &= 1 \\
      \n_{L/\Q} \frac{1 + \sqrt d}{2} &= \frac{1 - d}{4} \in \Z
    \end{align*}
    so done.
  \end{enumerate}
\end{proof}

Recall that if \(R\) is a ring, then a \emph{unit} in \(R\) is an element \(u \in R\) such that there exists \(v \in R\) such that \(uv = 1\). The set
\[
  R^\times = \{u \in R: u \text{ is a unit}\}
\]
form a group under multiplication.

\begin{lemma}
  If \(L\) is a number field then
  \[
    \O_L^\times = \{\alpha \in \O_L: \n_{L/\Q}(\alpha) = \pm 1\}.
  \]
\end{lemma}

\begin{remark}
  We'll prove later in the course that \(\O_L^\times\) is a finite group if and only if \(L = \Q\) or \(L\) is an imaginary quadratic field.
\end{remark}

\begin{proof}
  Norm is multiplicative so
  \[
    \n_{L/\Q}(\alpha\beta) = \n_{L/\Q}(\alpha)\n_{L/\Q}(\beta)
  \]
  for all \(\alpha, \beta \in L\). If \(\alpha \in \O_L^\times\) then there exists \(\beta \in \O_L\) such that \(\alpha\beta = 1\). Thus \(\n_{L/\Q}(\alpha)\n_{L/\Q}(\beta) = 1\). As they are both integers,
  \[
    \n_{L/\Q}(\alpha) \in \Z^\times = \{\pm 1\}.
  \]

  Conversely, suppose \(\alpha \in \O_L\) and \(\n_{L/\Q}(\alpha) = \pm 1\). Then \(\alpha^{-1} \in L\). Let \(\sigma_1, \dots, \sigma_n: L \to \C\) be distinct complex embeddings of \(L\). Then
  \[
    \n_{L/\Q}(\alpha) = \prod_{i = 1}^n \sigma_i(\alpha) = \pm 1
  \]
  so
  \[
    \sigma_1(\alpha^{-1}) = \pm \prod_{i = 2}^n \sigma_i(\alpha) \in \O_\C
  \]
  so \(\alpha^{-1} \in \O_L\).
\end{proof}

\section{Discriminants and integral bases}

Let \(L\) be a number field, \(n = [L:\Q]\) and \(\sigma_1, \dots, \sigma_n: L \to \C\) be distinct complex embeddings of \(L\).

\begin{definition}[Discriminant]\index{discriminant}
  Let \(\alpha_1, \dots, \alpha_n \in L\). Then their \emph{discriminant} is
  \[
    \disc(\alpha_1, \dots, \alpha_n) = \det D^2
  \]
  where \(D \in \matrixring_{n \times n}(\C)\) is \(D_{ij} = \sigma_i(\alpha_j)\).
\end{definition}

\begin{notation}
  Sometimes we use the alternative notation
  \[
    \Delta(\alpha_1, \dots, \alpha_n) = \disc(\alpha_1, \dots, \alpha_n).
  \]
\end{notation}

\begin{note}
  This is independent of the choice of ordering of \(\sigma_i\)'s and \(\alpha_j\)'s, as changing them amounts to permuting the rows and columns, which changes \(\det D\) by a sign.
\end{note}

\begin{lemma}
  Let \(\alpha_1, \dots, \alpha_n \in L\). Then
  \[
    \disc(\alpha_1, \dots, \alpha_n) = \det T
  \]
  where \(T \in \matrixring_{n \times n}(\Q)\) is \(T_{ij} = \tr_{L/\Q}(\alpha_i\alpha_j)\).
\end{lemma}

\begin{proof}
  \[
    T_{ij}
    = \sum_{k = 1}^n \sigma_k(\alpha_i\alpha_j)
    = \sum_{k = 1}^n D_{ki}D_{kj}
    = (D^TD)_{ij}
  \]
\end{proof}

\begin{corollary}
  \(\disc(\alpha_1, \dots, \alpha_n) \in \Q\) and if further \(\alpha_1, \dots, \alpha_n \in \O_L\) then \(\disc(\alpha_1, \dots, \alpha_n) \in \Z\).
\end{corollary}

\begin{proof}
  \(\disc(\alpha_1, \dots, \alpha_n) = \det T \in \Q\).

  If \(\alpha_i\)'s are in \(\O_L\), then \(D_{ij} \in \O_\C\) for all \(i, j\). As \(\det\) is a polynomial, \(\disc(\alpha_1, \dots, \alpha_n) \in \O_\C \cap \Q = \Z\).
\end{proof}

\begin{proposition}
  Let \(\alpha_1, \dots, \alpha_n \in L\). Then \(\disc(\alpha_1, \dots, \alpha_n) \neq 0\) if and only if \(\alpha_i\)'s form a \(\Q\)-basis of \(L\).
\end{proposition}

\begin{proof}
  Suppose \(\alpha_i\)'s do not form a basis, i.e.\ they satisfy a non-trivial relation. Then the columns of the matrix \(D_{ij} = \sigma_i(\alpha_j)\) are linearly dependent so \(\disc(\alpha_1, \dots, \alpha_n) = 0\).

  Conversely, suppose \(\alpha_1, \dots, \alpha_n\) are linearly independent. Then \(\disc(\alpha_1, \dots, \alpha_n) \neq 0\) if and only if \(\det T \neq 0\), if and only if the symmetric bilinear form
  \begin{align*}
    \phi: L \times L &\to \Q \\
    (\alpha, \beta) &\mapsto \tr_{L/\Q}(\alpha\beta)
  \end{align*}
  is non-degenerate. In other words, for all \(\alpha \in L^\times\), there exists \(\beta \in L\) such that \(\phi(\alpha, \beta) \neq 0\). But if \(\alpha \in L^\times\) then \(\phi(\alpha, \alpha^{-1}) = \tr_{L/\Q}(1) = n \neq 0\).
\end{proof}

\begin{definition}[Integral basis]\index{integral basis}
  We say \(\alpha_1, \dots, \alpha_n \in L\) form an \emph{integral basis} for \(\O_L\) if
  \begin{enumerate}
  \item \(\alpha_1, \dots, \alpha_n \in \O_L\),
  \item \(\alpha_1, \dots, \alpha_n\) generate \(\O_L\) as a \(\Z\)-module.
  \end{enumerate}
\end{definition}

\begin{lemma}
  If \(\alpha_1, \dots, \alpha_n\) form an integral basis for \(\O_L\) then the function
  \begin{align*}
    f: \Z^n &\to \O_L \\
    (m_1, \dots, m_n) &\mapsto \sum_{i = 1}^n m_i\alpha_i
  \end{align*}
  is an isomorphism of \(\Z\)-modules.
\end{lemma}

\begin{proof}
  \(f\) is clearly a surjective homomorphism so remains to show it is injective. Observe that \(\alpha_1, \dots, \alpha_n\) form a \(\Q\)-basis of \(L\): we know that if \(\beta \in L\) then there exists \(N \geq 1, N \in \Z\) such that \(N\beta \in \O_L\). Write
  \[
    N\beta = \sum_{i = 1}^n m_i\alpha_i
  \]
  for some \(m_i \in \Z\). Thus \(\beta = \sum_{i = 1}^m \frac{m_1}{N} \alpha_i\). Thus \(\alpha_i\)'s span \(L\) and thus form a basis of \(L\).

  If \(f(m_1, \dots, m_n) = 0\) then \(\sum_{i = 1}^n m_i\alpha_i = 0\) so \(m_i = 0\) by linear independent of \(\alpha_i\)'s.
\end{proof}

We will soon prove that every number field has an integral basis.

\begin{lemma}[Sandwich lemma]\leavevmode
  \begin{enumerate}
  \item If \(H \leq G\) are abelian groups and \(G \cong \Z^a\) for some integer \(a \geq 0\), then \(H \cong \Z^b\) for some \(b \leq a\).
  \item If \(K \leq H \leq G\) are abelian groups and \(K \cong \Z^a, G \cong \Z^a\) for some \(a \geq 0\), then \(H \cong \Z^a\).
  \item If \(H \leq G\) are abelian groups and \(H \cong \Z^a, G \cong \Z^a\) for some \(a \geq 0\) then \(G/H\) is finite.
  \end{enumerate}
\end{lemma}

This is a generalisation of results about finite dimensional vector spaces (i.e.\ finitely generated free modules over fields) to finitely generated free \(\Z\)-modules.

\begin{proof}\leavevmode
  \begin{enumerate}
  \item \(G/H\) is a finitely generated abelian group. By the classification, \(G/H \cong \Z^n \oplus A\) where \(A\) is a finite abelian group. Choose \(p\) prime such that \(p \ndivides |A|\). Then the map
    \begin{align*}
      f: G/H &\to G/H \\
      x + H &\mapsto px + H
    \end{align*}
    is injective. Consider the map
    \begin{align*}
      f': H/pH &\to G/pG \\
      x + pH &\mapsto x + pG
    \end{align*}
    Claim this map is also injective: if \(x \in H, x \in pG\) then \(x = py\) for some \(y \in G\). Then \(y + H \in \ker f = H\). Thus \(x \in pH\).

    By classification \(H \cong \Z^b\). As \(f'\) is injective, \(|H/pH| \leq |G/pG|\), i.e.\ \(p^b \leq p^a\) so \(b \leq a\).
  \item Apply 1 to \(K \leq H\) and \(H \leq G\) to get \(H \cong \Z^b\) where \(a \leq b \leq a\) so \(a = b\).
  \item Again \(G/H\) is finitely generated so by classification \(G/H \cong \Z^N \oplus A\) where \(A\) is a finite abelian group. Let \(p\) be a prime such that \(p \ndivides |A|\). The same proof as in 1 shows that \(f': H/pH \to G/pG\) is injective. Since \(|H/pH| = |G/pG| = p^a\), \(f'\) is an isomorphism. Thus (?)
    \[
      G/H + pG \cong (\Z/p\Z)^N
    \]
    There is a surjective homomorphism \(G/pG \to G/H + pG\) which has kernel containing the image of \(f'\). Hence the map is surjective with kernel \(G/pG\). This forces \(N = 0\).
  \end{enumerate}
\end{proof}

\begin{proposition}
  There exists an integral basis for \(\O_L\).
\end{proposition}

\begin{proof}
  Let \(\beta_1, \dots, \beta_n \in L\) be a \(\Q\)-basis for \(L\). Wlog \(\beta_1, \dots, \beta_n \in \O_L\). Then \(\O_L \supseteq \bigoplus_{i = 1}^n \beta_i\Z\).

  Recall that
  \begin{align*}
    \phi: L \times L &\to \Q \\
    (\alpha, \beta) &\mapsto \tr_{L/\Q}(\alpha\beta)
  \end{align*}
  is a non-degenerate symmetric bilinear form. Let \(\beta_1^*, \dots, \beta_n^*\) be the dual basis, i.e.\ \(\tr_{L/\Q}(\beta_i \beta_j^*) = \delta_{ij}\). If \(\alpha \in \O_L\) then we can write
  \[
    \alpha = \sum_{i = 1}^n a_i\beta_i^*
  \]
  where \(a_i \in \Q\). We know \(\alpha\beta_i \in \O_L\) hence
  \[
    \tr_{L/\Q}(\alpha\beta_i)
    = \sum_{j = 1}^n \tr_{L/\Q}(a_j\beta_j^*\beta_i)
    = \sum_{j = 1}^n a_j \tr_{L/\Q} (\beta_j^*\beta_i)
    = a_i
    \in \Z
  \]
  so \(\O_L \subseteq \bigoplus_{i = 1}^n \beta_i^*\Z\). Thus by Sandwich lemma there is an isomorphism \(\O_L \cong \Z^n\).
\end{proof}

If \(\alpha_1, \dots, \alpha_n\) and \(\beta_1, \dots, \beta_n\) are both integral basis for \(\O_L\), then there exists \(A \in \matrixring_{n \times n}(\Z)\) such that
\[
  \beta_j = \sum_{i = 1}^n A_{ij}\alpha_i
\]
for each \(1 \leq j \leq n\). Moreover, we must have \(\det A = \pm 1\) and thus \(A \in \GL_n(\Z)\). Let \(D_{ij} = \sigma_i(\alpha_j), D_{ij}' = \sigma_i(\beta_j)\) and then \(\disc(\beta_1, \dots, \beta_n) = \det (D')^2\). We have
\[
  D_{ij}'
  = \sum_{k = 1}^n \sigma_i(A_{kj}\alpha_k)
  = \sum_{k = 1}^n \sigma_i(\alpha_k) A_{kj}
  = (DA)_{ij}
\]
We thus conclude that
\[
  \disc(\beta_1, \dots, \beta_n)
  = \det (D')^2
  = \det (DA)^2
  = \det D^2
  = \disc(\alpha_1, \dots, \alpha_n).
\]

\begin{definition}[Discriminant]\index{discriminant}
  The \emph{discriminant} \(D_L\) of a number field \(L\) is \(\disc(\alpha_1, \dots, \alpha_n)\) where \(\alpha_1, \dots, \alpha_n\) is any integral basis for \(\O_L\).
\end{definition}

\begin{proposition}
  Let \(L = \Q(\alpha)\) and let \(f(x) \in \Q[x]\) be the minimal polynomial of \(\alpha\) over \(\Q\). Then
  \[
    \disc(1, \alpha, \alpha^2, \dots, \alpha^{n - 1})
    = \prod_{i < j} (\sigma_i(\alpha) - \sigma_j(\alpha))^2
    = (-1)^{\binom{n}{2}} \n_{L/\Q}(f'(\alpha)).
  \]
\end{proposition}

\begin{note}
  In IID Galois Theory, we defined
  \[
    \disc f = \prod_{i < j} (\sigma_i(\alpha) - \sigma_j(\alpha))^2.
  \]
\end{note}

\begin{proof}
  Let \(D_{ij} = \sigma_i(\alpha^{j - 1})\). Then \(D \in \matrixring_{n \times n}(\C)\) and \(\disc(1, \alpha, \dots, \alpha^{n -1}) = \det D^2\). \(D\) is a Vandermonde matrix with
  \[
    \det D = \prod_{i < j} (\sigma_j(\alpha) - \sigma_i(\alpha)).
  \]

  For the second equality, note that
  \[
    \n_{L/\Q}(f'(\alpha))
    = \prod_{i = 1}^n \sigma_i(f'(\alpha))
    = \prod_{i = 1}^n f'(\sigma_i(\alpha)).
  \]
  Also since \(f(x) = \prod_{i = 1}^n (x - \sigma_i(\alpha))\), \(f'(x) = \sum_{i = 1}^n\prod_{j \neq i} (x - \sigma_j(\alpha))\). Substitute into the above formula to get
  \[
    \n_{L/\Q}(f'(\alpha))
    = \prod_{i = 1}^n \prod_{j \neq i} (\sigma_i(\alpha) - \sigma_j(\alpha))
    = (-1)^{\binom{n}{2}} \prod_{i < j}(\sigma_i(\alpha) - \sigma_j(\alpha))^2.
  \]
\end{proof}

\begin{note}
  If \(\alpha \in \O_L\) and \(\Z[\alpha] = \O_L\) then \(1, \alpha, \dots, \alpha^{n -1}\) is an integral basis for \(\O_L\). We can then use the above proposition to calculate \(D_L\).
\end{note}

\begin{eg}
  Let \(d \in \Z\) be square-free and \(\alpha \neq 0, 1\). Let \(L = \Q(\sqrt d)\). Then
  \[
    D_L =
    \begin{cases}
      4d & \text{if } d = 2, 3 \pmod 4 \\
      d & \text{if } d = 1 \pmod 4
    \end{cases}
  \]
  If \(d = 2, 3 \pmod 4\) then \(\O_L = \Z[\sqrt d]\). Apply the proposition to \(f(t) = t^2 - d\) to get
  \[
    D_L = \disc(1, \sqrt d) = -\n_{L/\Q}(2\sqrt d) = 4d.
  \]

  On the other hand if \(d = 1 \pmod 4\) then \(\O_L = \Z[\alpha]\) where \(\alpha  = \frac{1 + \sqrt d}{2}\). Apply the proposition to \(f(t) = t^2 - t + \frac{1 - d}{4}\), \(f'(x) = 2x - 1\), \(f'(\alpha) = \sqrt d\). Thus
  \[
    D_L = -N_{L/\Q}(\sqrt d) = d.
  \]
\end{eg}

\begin{proposition}
  If \(\alpha_1, \dots, \alpha_n \in \O_L\) are such that \(\disc(\alpha_1, \dots, \alpha_n)\) is a non-zero square-free integer then \(\alpha_1, \dots, \alpha_n\) form an integral basis for \(\O_L\).
\end{proposition}

\begin{proof}
  Let \(\beta_1, \dots, \beta_n\) be an integral basis for \(\O_L\). Then there exists \(A \in \matrixring_{n \times n}(\Z)\) such that
  \[
    \alpha_j = \sum_{i = 1}^n A_{ij}\beta_i
  \]
  for \(1 \leq j \leq n\). Then
  \[
    \disc(\alpha_1, \dots, \alpha_n) = \det A^2 \disc(\beta_1, \dots, \beta_n)
  \]
  using a previous argument. If \(\disc(\alpha_1, \dots, \alpha_n)\) is square-free and non-zero then \(\det A = \pm 1\) so \(A \in \GL_n(\Z)\). Thus \(\alpha_1, \dots, \alpha_n\) must generate \(\O_L\) and thus form an integral basis.
\end{proof}

\begin{eg}
  Let \(f(t) = t^3 - t - 1\). Use the formula
  \[
    \disc(t^3 + at + b) = -4a^3 - 27b^2
  \]
  to get \(\disc(f) = -23\), which is square-free (and non-zero of course). If \(L = \Q(\alpha)\) where \(\alpha\) is a root of \(f(t)\) then \(\O_L = \Z[\alpha]\).
\end{eg}

We have defined integral basis for rings of integers. In fact, we can generalise it to ideals of the ring:

\begin{definition}[Integral basis]\index{integral basis}
  Let \(I \subseteq \O_L\) be a non-zero ideal. Then elements \(\alpha_1, \dots, \alpha_n \in L\) form an \emph{integral basis} for \(I\) if
  \begin{enumerate}
  \item \(\alpha_1, \dots, \alpha_n \in I\),
  \item \(\alpha_1, \dots, \alpha_n\) generate \(I\) as a \(\Z\)-module.
  \end{enumerate}
\end{definition}

\begin{proposition}
  Let \(I \subseteq \O_L\) be a non-zero ideal. Then there exists an integral basis for \(I\).
\end{proposition}

\begin{proof}
  By definition \(I \subseteq \O_L \cong \Z^n\). Let \(\alpha_1, \dots, \alpha_n \in \O_L\) be an integral basis for \(\O_L\). Let \(a \in I\) be non-zero. Then \((a) \subseteq I\) and thus
  \[
    \bigoplus_{i = 1}^n a\alpha_i\Z \subseteq I \subseteq \O_L.
  \]
  By Sandwich lemma \(I \cong \Z^n\) as a \(\Z\)-module. Thus there exists an integral basis for \(I\).
\end{proof}

\begin{definition}[Norm]\index{norm}
  If \(I \subseteq \O_L\) is a non-zero ideal then its \emph{norm} is
  \[
    \n(I) = [\O_L:I].
  \]
\end{definition}

Note that norm is finite by Sandwich lemma.

\begin{definition}[Discriminant]\index{discriminant}
  If \(I \subseteq \O_L\) is a non-zero ideal then its \emph{discriminant} is
  \[
    \disc(I) = \disc(\alpha_1, \dots, \alpha_n)
  \]
  where \(\alpha_1, \dots, \alpha_n\) is any integral basis for \(I\).
\end{definition}

Note that the same argument for discriminant of ring of integers shows that this is well-defined.

\begin{lemma}
  If \(I \subseteq \O_L\) is a non-zero ideal then
  \[
    \disc(I) = \disc(\O_L) \cdot \n(I)^2.
  \]
\end{lemma}

\begin{proof}
  Let \(\alpha_1, \dots, \alpha_n\) be an integral basis for \(\O_L\) and \(\beta_1, \dots, \beta_n\) be an integral basis for \(I\). Then there exists \(A \in \matrixring_{n \times n}(\Z)\) such that
  \[
    \beta_j = \sum_{i = 1}^n A_{ij}\alpha_i
  \]
  for \(1 \leq j \leq n\) and
  \[
    \disc(\beta_1, \dots, \beta_n) = \disc(\alpha_1, \dots, \alpha_n) \det A^2.
  \]
  It thus suffices to show that \(\det A^2 = [\O_L:I]^2\). In fact we'll show that if \(B \in \matrixring_{n \times n}(\Z)\) and \(\det B \neq 0\) then
  \[
    |\Z^n/B\Z^n| = |\det B|.
  \]
  Then the result follows from \(\O_L \cong \Z^n\).

  \begin{proof}
    Recall from IB Groups, Rings and Modules that there exists \(P, Q \in \GL_n(\Z)\) such that
    \[
      PBQ = D = \operatorname{diag}(d_1, \dots, d_n)
    \]
    where \(d_i \in \Z\) (Smith normal form). Thus
    \[
      \Z^n/B\Z^n \cong \Z^n/D\Z^n \cong \bigoplus_{i = 1}^n \Z/d_i\Z
    \]
    so
    \[
      |\Z^n/B\Z^n| = |\Z^n/D\Z^n| = \prod_{i = 1}^n |d_i|.
    \]
    On the other hand \(|\det B| = |\det D| = \prod_{i = 1}^n |d_i|\).
  \end{proof}
\end{proof}

\begin{lemma}
  Let \(\alpha \in \O_L \setminus \{0\}\). Then
  \[
    \n((\alpha)) = |\n_{L/\Q}(\alpha)|.
  \]
\end{lemma}

\begin{proof}
  Let \(\alpha_1, \dots, \alpha_n\) be an integral basis for \(\O_L\). Then \(\alpha\alpha_1, \dots, \alpha\alpha_n\) is an integral basis for \(I = (\alpha)\).
  \begin{align*}
    \disc(I) 
    &= \disc(\alpha\alpha_1, \dots, \alpha\alpha_n) \\
    &= \det(\sigma_i(\alpha\alpha_j))^2 \\
    &= \det (\sigma_i(\alpha)\sigma_i(\alpha_j))^2 \\
    &= \left( \prod_{i = 1}^n \sigma_i(\alpha) \right)^2 \det(\sigma_i(\alpha_j))^2 \\
    &= \n_{L/\Q}(\alpha)^2 \det(\O_L)
  \end{align*}
  On the other had, we showed last time that for any non-zero ideal \(J \subseteq \O_L\),
  \[
    \disc(J) = \n(J)^2 \disc(\O_L)
  \]
  and the result follows.
\end{proof}

\begin{notation}
  If \(\alpha \in \O_L \setminus \{0\}\), we write
  \[
    \n(\alpha) = \n((\alpha)).
  \]
  Also define \(\n(0) = 0\). Then for all \(\alpha, \beta \in \O_L\), \(\n(\alpha\beta) = \n(\alpha)\n(\beta)\).
\end{notation}

In fact later we will show \(\n\) is multiplicative for all ideals.

\section{Unique factorisation in \texorpdfstring{\(\O_L\)}{O_{}L}}

Recall that a ring \(R\) is a \emph{unique factorisation domain} (UFD) if
\begin{enumerate}
\item \(R\) is an integral domain,
\item if \(x \in R\) is non-zero and not a unit, then there exists an expression
  \[
    x = p_1 \cdots p_r
  \]
  where \(p_i \in R\) are irreducibles. This expression is unique in the sense that if
  \[
    x = q_1 \cdots q_s
  \]
  is another such expressions then \(r = s\) and after reordering each \(q_i\) is an associate of \(p_i\), i.e.\ \(q_i \in R^\times p_i\).
\end{enumerate}

We know that \(\Z\) is a UFD. However, if \(L\) is a number field then \(\O_L\) need not be a UFD. Let's see an example where uniqueness fails.

\begin{eg}
  Let \(L = \Q(\sqrt{-5})\). Then \(\O_L = \Z[\sqrt{-5}]\). From example sheet we know \(\O_L^\times = \{\pm 1\}\). In \(\O_L\) we have
  \[
    6 = 2 \times 3 = (1 + \sqrt{-5})(1 - \sqrt{-5}).
  \]
  We can check that \(2, 3, 1 \pm \sqrt{-5}\) are irreducibles and no two are associates. For example, suppose \(2 = xy\) where \(\n(x) > 1, \n(y) > 1\). As \(\n(2) = 4\), \(\n(x) = \n(y) = 2\). But \(\n(a + b\sqrt{-5}) = a^2 + 5b^2\) which is never \(2\). Contradiction.
\end{eg}

But this does not go terribly wrong. In fact, any non-zero \(x \in \O_L\) which is not a unit can be expressed as a product of irreducible elements:

\begin{proof}
  If \(x \in \O_L\) then \(x\) is a non-zero non-unit if and only if \(\n(x) > 1\). Suppose \(x \in \O_L\) is a non-zero non-unit which cannot be written as a product of irreducibles, and with \(\n(x)\) minimal among such elements. Then \(x = yz\) with \(\n(y), \n(z) > 1\), hence \(\n(y), \n(z) < \n(x)\). By minimality of \(\n(x)\), both \(y\) and \(z\) can be written as products of irreducibles.
\end{proof}

The way to get around this is to consider multiplication of ideals insteads of elements. Recall that if \(R\) is a ring and \(I, J\) are ideal of \(R\), we can define
\begin{align*}
  IJ &= \left\{ \sum_{i = 1}^k a_ib_i: a_i \in I, b_i \in J \right\} \\
  I + J &= \{ a + b: a \in I, b \in J\}
\end{align*}

\begin{definition}[Irreducible ideal]\index{irreducible ideal}
  A proper ideal \(I \subseteq R\) is \emph{irreducible} if it does not admit an expression \(I = JK\) where \(J, K\) are proper ideals of \(R\).
\end{definition}

One caveat: even if \(\alpha \in \O_L\) is irreducible, the principal ideal \((\alpha)\) need not be irreducible. For example in \(\Z[\sqrt{-5}]\), we have
\begin{align*}
  (2) &= (2, 1 + \sqrt{-5})^2 \\
  (3) &= (3, 1 + \sqrt{-5})(3, 1 - \sqrt{-5})
\end{align*}

The aim of this chapter is to prove that factorisation of ideals into prime ideals is unique. Recall from IB Groups, Rings and Modules

\begin{definition}[Prime ideal]\index{prime ideal}
  Let \(R\) is a ring. We say that a proper ideal \(P \subseteq \R\) is \emph{prime} if for all \(x, y \in R\), \(xy \in P \implies x \in P \text{ or } y \in P\).
\end{definition}

The following lemma gives us a way to characterise prime ideals:
\begin{lemma}
  Let \(R\) be a ring and \(I, J, P \subseteq R\) be ideals. Suppose \(P\) is prime and \(IJ \subseteq P\) then \(I \subseteq P\) or \(J \subseteq P\).
\end{lemma}

\begin{proof}
  Wlog \(I \nsubseteq P\). Choose \(x \in I \setminus P\). For all \(y \in J\), \(xy \in IJ \subseteq P\) so \(y \in P\).
\end{proof}

Note that the converse is trivially true, so we can think about a prime ideal as a ``prime element'' among all ideals, instead of breaking the ideal apart and talking about properties of elements in the ideal.

From now on let \(L\) be a number field.

\begin{lemma}
  Any non-zero prime ideal \(P \subseteq \O_L\) is a maximal ideal.
\end{lemma}

\begin{proof}
  Recall that if \(R\) is a ring and \(I\) is a proper ideal of \(R\), then \(I\) is prime if and only if \(R/I\) is an integral domain and \(I\) is maximal if and only if \(R/I\) is a field.

  If \(P \subseteq \O_L\) is a non-zero prime ideal, then \(\O_L\) is a finite integral domain as its cardinality is \(\n(P)\). Any finite integral domain is a field.
\end{proof}

\begin{lemma}
  If \(I \subseteq \O_L\) is a non-zero proper ideal then there exists non-zero prime ideals \(P_1, \dots, P_r \subseteq \O_L\) such that \(P_1 \cdots P_r \subseteq I\).
\end{lemma}

\begin{proof}
  For contradiction, let \(I \subsetneq \O_L\) be an ideal which does not have this property with \(\n(I)\) minimal among all such ideals. Clearly \(I\) is not prime so there exists \(x, y \in \O_L\) such that \(xy \in I\) but \(x, y \notin I\). It follows that
  \begin{align*}
    I &\subsetneq I + (x) \\
    I &\subsetneq I + (y)
  \end{align*}
  and therefore
  \begin{align*}
    \n(I + (x)) &< \n(I) \\
    \n(I + (y)) &< \n(I)
  \end{align*}
  By minimality of \(\n(I)\), we can find non-zero prime ideals \(P_1, \dots, P_r, Q_1, \dots, Q_s\) such that
  \begin{align*}
    P_1, \dots, P_r &\subseteq I + (x) \\
    Q_1, \dots, Q_s &\subseteq I + (y)
  \end{align*}
  so
  \[
    P_1 \cdots P_rQ_1 \cdots Q_s \subseteq (I + (x))(I + (y)) \subseteq I^2 + xI + yI + (xy) \subseteq I.
  \]
  Absurd.
\end{proof}

\begin{lemma}
  If \(I \subsetneq \O_L\) is a non-zero ideal then there exists \(\gamma \in L \setminus \O_L\) such that \(\gamma I \subseteq \O_L\).
\end{lemma}

\begin{proof}
  Let \(\alpha \in I \setminus \{0\}\). Let \(P_1, \dots, P_r \subseteq \O_L\) be non-zero prime ideals such that \(P_1 \dots P_r \subseteq (\alpha)\). Wlog \(r\) is minimal among all such expressions. Let \(P\) be a maximal ideal containing \(I\). Then
  \[
    P \supseteq I \supseteq (\alpha) \supseteq P_1 \cdots P_r
  \]
  so \(P \supseteq P_i\) for some \(i\). After reordering, assume \(P \supseteq P_1\). Since non-zero prime ideals are maximal, we have \(P = P_1\). Since \(r\) is minimal, we have \(P_2 \cdots P_r \nsubseteq (\alpha)\). Choose \(\beta \in P_2 \cdots P_r \setminus (\alpha)\). Claim that the element \(\gamma = \frac{\beta}{\alpha}\) has the desired property: if \(\gamma \in \O_L\) then \(\beta = \alpha\gamma \in (\alpha)\). Absurd. In addition
  \[
    \gamma I = \frac{\beta}{\alpha}I \subseteq \frac{1}{\alpha} P_2 \cdots P_r I \subseteq \frac{1}{\alpha} P_1\cdots P_r \subseteq \O_L.
  \]
\end{proof}

\begin{proposition}
  If \(I \subseteq \O_L\) is a non-zero ideal then there exists a non-zero ideal \(J \subseteq \O_L\) such that \(IJ\) is principal.
\end{proposition}

\begin{proof}
  Choose \(\alpha \in I \setminus \{0\}\). Define
  \[
    J = \{\beta \in \O_L: \beta I \subseteq (\alpha)\}.
  \]
  \(J\) is a non-zero ideal as \(\alpha \in J\). We have \(IJ \subseteq (\alpha)\). Suffices to show equality.

  Let \(K = \frac{1}{\alpha}IJ \subseteq \O_L\). We will show in fact that \(K = \O_L\): if \(K \neq \O_L\), there exists \(\gamma \in L \setminus \O_L\) such that \(\gamma K \subseteq \O_L\). We have \((\alpha) \subseteq I\) hence \(\frac{1}{\alpha} I \supseteq \O_L\), hence \(K = \frac{1}{\alpha}IJ \supseteq J\). Hence \(\gamma J \subseteq \gamma K \subseteq \O_L\). We also have
  \[
    \gamma IJ = \gamma \alpha K \subseteq (\alpha).
  \]
  If \(\beta \in \gamma J\) then \(\beta \in \O_L\) and \(\beta I \subseteq (\alpha)\) so \(\gamma J \subseteq J\).

  Recall that \(J\) admits an integral basis so there is an isomorphism \(J \cong \Z^n\). If \(A \in \matrixring_{n \times n}(\Z)\) be the matrix representing multiplication by \(\gamma\), with \(f(x) \in \Z[x]\) its characteristic polynomial, by Cayley-Hamilton \(f(\gamma) = 0\). Thus \(\gamma \in \O_L\). Absurd.

  This shows that \(IJ = (\alpha)\).
\end{proof}

Now we have the machinery to discuss ``division'' of ideals:

\begin{corollary}
  If \(I, J, K \subseteq \O_L\) are non-zero ideals and \(IJ = IK\) then \(J = K\).
\end{corollary}

\begin{proof}
  Choose a non-zero ideal \(A \subseteq \O_L\) such that \(AI = (\alpha)\) is principal. Then
  \[
    \alpha J = AIJ = AIK = \alpha K
  \]
  so \(J = K\).
\end{proof}

\begin{definition}[Ideal divisibility]\index{ideal divisibility}
  If \(I, J \subseteq \O_L\) are non-zero ideals, say \(I\) \emph{divides} \(J\), written \(I \divides J\), if there exists an ideal \(K \subseteq \O_L\) such that \(IK = J\).
\end{definition}

\begin{corollary}
  If \(I, J \subseteq \O_L\) are non-zero ideals, then \(I \divides J\) if and only if \(I \supseteq J\).
\end{corollary}

\begin{proof}
  If \(IK = J\) then \(J \subseteq I\). Conversely, suppose \(I \supseteq J\). Choose a non-zero ideal \(A \subseteq \O_L\) such that \(AI = (\alpha)\) is principal. Then \((\alpha) = AI \supseteq AJ\) and so \(\O_L \supseteq \frac{1}{\alpha}AJ\). So \(K = \frac{1}{\alpha}AJ\) is a non-zero ideal of \(\O_L\) and \(IK = \frac{1}{\alpha}AIJ = J\).
\end{proof}

Finally, the theorem we have promised:

\begin{theorem}
  If \(I \subseteq \O_L\) is a non-zero ideal, then there exist prime ideals \(P_1, \dots, P_r \subseteq \O_L\) such that
  \[
    I = P_1\cdots P_r.
  \]
  Moreover, the expression is unique up to reordering.
\end{theorem}

\begin{proof}
  We show existence by contradiction. Suppose \(I\) is an ideal which cannot be written as a product of primes, and with \(\n(I)\) minimal subject to this condition. We can find a maximal ideal \(P \supseteq I\), which is also prime. Then \(P \divides I\) so we can write \(I = PJ\) for some \(J \subseteq \O_L\). Then \(J \divides I\), hence \(J \supseteq I\). If \(J = I\) then we get \(I = IP\) and hence \(\O_L = P\), contradicting the maximality of \(P\). Therefore \(J \supsetneq I\), hence \(N(J) < N(I)\). By minimality of \(N(I)\), we can write \(J = P_2 \cdots P_r\) where \(P_i \subseteq \O_L\) are prime ideals. Hence
  \[
    I = PJ = PP_2 \cdots P_r.
  \]
  Absurd.

  For the uniqueness part, suppose \(P_1, \dots, P_r\) and \(Q_1, \dots, Q_s\) are non-zero ideals in \(\O_L\) such that
  \[
    P_1 \cdots P_r = Q_1 \cdots Q_s.
  \]
  Then \(P_1 \divides Q_1 \cdots Q_s\) so \(P_1 \supseteq Q_i\) for some \(1 \leq i \leq s\). Wlog \(P_1 \supseteq Q_1\). But both \(P_1\) and \(Q_1\) are maximal so \(P_1 = Q_1\). Cancel to get
  \[
    P_2\cdots P_r = Q_2 \cdots Q_s.
  \]
  Continue in this way to obtain \(r = s\) and \(P_i = Q_i\) after reordering.
\end{proof}

Before going to construct prime ideals and do arithmetics on them, we first define

\begin{definition}[Ideal class group]\index{ideal class group}
  The \emph{ideal class group} is defined to be
  \[
    \Cl(\O_L) = \{I \subseteq \O_L \text{ non-zero ideals}\}/\sim
  \]
  where \(I \sim J\) if there exists \(\alpha \in L^\times\) such that \(\alpha I = J\).

  Write \([I]\) for the equivalence class containing \(I\).
\end{definition}

\begin{lemma}
  \(\Cl(\O_L)\) is a group under the operation
  \[
    [I][J] = [IJ]
  \]
  with identity \([\O_L]\).
\end{lemma}

\begin{proof}
  If \(I, J \subseteq \O_L\) are non-zero ideals and \(\alpha, \beta \in L^\times\) are such that \(\alpha I, \beta J \subseteq \O_L\) then
  \[
    (\alpha I)(\beta J) = \alpha\beta IJ
  \]
  so the operation is well-defined.

  For any \(I \subseteq \O_L\), \(\O_L I = I\) so \([\O_L]\) is the identity. We showed that if \(I \subseteq \O_L\) is any non-zero ideal then there exists a non-zero ideal \(J \subseteq \O_L\) such that \(IJ = (\alpha)\) is principal. Then
  \[
    [IJ] = [I][J] = [(\alpha)] = [\O_L]
  \]
  so \([I]^{-1} = [J]\). Associativity follows from associativity of ideal multiplication.
\end{proof}

\begin{proposition}
  TFAE:
  \begin{enumerate}
  \item \(\O_L\) is a PID.
  \item \(\O_L\) is a UFD.
  \item \(\Cl(\O_L)\) is trivial.
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{itemize}
  \item \(1 \implies 2\): See IB Groups, Rings and Modules.
  \item \(2 \implies 3\): Suffices to show every ideal \(I \subseteq \O_L\) is principal. We know that we can write
    \[
      I = P_1 \cdots P_r
    \]
    as a product of prime ideals. As products of principal ideals are principal, it suffices to show that every prime ideal of \(\O_L\) is principal. Let \(P \subseteq \O_L\) be a prime ideal and \(\alpha \in P\) non-zero, and let
    \[
      \alpha = \alpha_1 \cdots \alpha_r
    \]
    be a factorisation of \(\alpha\) into irreducibles. Recall that if a ring is a UFD then irreducible elements are prime. Since
    \[
      P \supseteq (\alpha) = (\alpha_1) \cdots (\alpha_r)
    \]
    so \(P \divides P_1 \cdots P_r\) where \(P_i = (\alpha_i)\). Since \(\alpha_i\)'s are prime, \(P_i\) is a prime ideal. Hence we must have \(P = P_i = (\alpha_i)\) for some \(i\). Thus \(P\) is principal.
  \item \(3 \implies 1\): Let \(I \subseteq \O_L\) be a non-zero ideal. Since \(\Cl(\O_L)\) is trivial, we have \([I] = [\O_L]\), so there exists \(\alpha \in L^\times\) such that \(\alpha \O_L = I\). We have \(\alpha \cdot 1 = \alpha \in I \subseteq \O_L\) so \(\alpha \in \O_L\). Then \(I = (\alpha)\) is principal.
  \end{itemize}
\end{proof}

\begin{lemma}
  If \(I, J \subseteq \O_L\) are non-zero ideals then
  \[
    \n(IJ) = \n(I)\n(J).
  \]
\end{lemma}
which says that ideals of \(\O_L\) behaves like principal ideals under norm.

\begin{proof}
  Example sheet.
\end{proof}









\printindex


\iffalse
Reading

Marcus, Number Fields
secret notes: https://www.dpmms.cam.ac.uk/~jat58/nfl2018
\fi
\end{document}
