\documentclass[a4paper]{article}

\def\npart{II}

\def\ntitle{Linear Analysis}
\def\nlecturer{R.\ Bauerschmidt}

\def\nterm{Michaelmas}
\def\nyear{2018}

\input{header}

\newtheorem*{fact}{Fact}

\newcommand{\K}{{\mathbb{K}}} % field

\begin{document}

\input{titlepage}

\tableofcontents

\section{Normed spaces and linear operators}

Unless stated, vector spaces are real or complex, and \(\K\) stands for \(\R\) or \(\C\).

\subsection{Normed vector spaces}

\begin{definition}[normed vector space]\index{normed vector space}
  A \emph{normed vector space} \((X, \norm{\cdot})\) is a vector space \(X\) with a norm \(\norm{\cdot}: X \to \R, x \mapsto \norm x\) satisfying
  \begin{enumerate}
  \item positive-definite: \(\norm x \geq 0\) for all \(x \in X\) and \(\norm x = 0\) if and only if \(x = 0\),
  \item positive homogeneity: \(\norm{\lambda x} = |\lambda| \norm x\) for all \(\lambda \in K\) and \(x \in X\),
  \item triangle inequality: \(\norm{x + y} \leq \norm x + \norm y\) for all \(x, y \in X\).
  \end{enumerate}
\end{definition}

In particular, every norm induces a \emph{metric} by \(d(x, y) = \norm{x - y}\).

\begin{fact}
Vector space operations and the norm are continuous maps, i.e.\ the following maps
\begin{align*}
  \K \times X &\to X \\
  (\lambda, x) &\mapsto \lambda x \\
  X \times X &\to X \\
  (x, y) &\mapsto x + y \\
  X &\to \R \\
  x &\mapsto \norm x
\end{align*}
are continuous and the metric is translation invariant: \(d(x, y) = d(x + z, y + z)\) for all \(x, y, z \in X\).
\end{fact}

\begin{proof}
  We only check scalar multiplication. The others are left as exercises. Since \(\K\) and \(X\) are both metric spaces, it suffices to check that \(\lambda_j \to \lambda\) in \(\K\) and \(x_j \to x\) in \(X\) implies \(\lambda_j x_j \to \lambda x\).

  Indeed,
  \begin{align*}
    &\norm{\lambda_j x_j - \lambda x} \\
    =& \norm{(\lambda_j - \lambda) x_j + \lambda(x_j - x)} \\
    \leq& \norm{(\lambda_j - \lambda) x_j} + \norm{\lambda(x_j - x)} \\
    =& |\lambda_j - \lambda| \norm{x_j} +|\lambda| \norm{x_j - x} \\
    \to& 0
  \end{align*}
\end{proof}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(\ell_n^2 = (\R^n, \norm \cdot_2)\) where \(\norm x_2 = (\sum_{i = 1}^n |x_i|^2)^{1/2}\), i.e.\ Euclidean norm.
  \item \(\ell_n^1 = (\R^n, \norm \cdot_1)\) where \(\norm x_1 = \sum_{i = 1}^n |x_i|\).
  \item \(\ell_n^\infty = (\R^n, \norm \cdot_\infty)\) where \(\norm x_\infty = \max_i |x_i|\).
  \end{enumerate}
\end{eg}

It is often useful to consider the \emph{unit ball} \(B = B(X) = \{x \in X: \norm x \leq 1\}\). (Pictures)

\begin{fact}\leavevmode
\begin{enumerate}
\item \(B\) determines the norm through \(\norm x = \inf \{t > 0: x \in tB\}\).
\item \(B\) is \emph{convex}: for all \(x, y \in B, \lambda \in (0, 1), \lambda x + (1 - \lambda) y \in B\).
\end{enumerate}
\end{fact}

\begin{remark}
  Any set \(B \subseteq \R^n\) which is a closed, bounded, symmetric (\(x \in B \implies -x \in B\)) neighbourhood of \(0\) defines a norm by the same formula as above and \(B\) is the unit ball of that norm, although we will not use this fact in the course.
\end{remark}

\subsection{The space \(\mathcal l^p\)}

Let \(S = \{x = (x_i)_{i = 1}^\infty \subseteq \K\}\) be the set of scalar sequences with
\begin{align*}
  x + y &= (x_i)_i + (y_i)_i = (x_i + y_i)_i, \\
  \lambda x &= \lambda (x_i)_i = (\lambda x_i)_i.
\end{align*}

\begin{definition}
  For \(1 \leq p < \infty\), let \(\ell^p = \{x \in S: \sum_n |x_n|^p < \infty\}\) with norm \(\norm x_p = (\sum_n |x_n|^p)^{1/p}\). let \(\ell^\infty = \{x \in S: \sup_n |x_n| < \infty\}\) with norm \(\norm x_\infty = \sup_n |x_n|\). Finally, \(c_0 = \{x \in S: x_n \to 0\}\) with norm \(\norm x_\infty = \sup_n |x_n|\).
\end{definition}

We have yet proved \(\norm \cdot_p\) is a norm for general \(p\). The triangle inequality follows from Minkowski's inequality, discussed next.

Recall that \(f: \R^+ \to \R\) is \emph{convex} if
\[
  f(\lambda t + (1 - \lambda) s) \leq \lambda f(t) + (1 - \lambda) f(s)
\]
for all \(s, t \in \R^+, \lambda \in (0, 1)\). Graphically, the graph of \(f\) lies below the secant between any two points on the graph. \(f\) is concave if \(-f\) is convex. Note that \(\log: \R^+ \to \R\) is a concave function.

\begin{corollary}
  Let \(1 < p, q < \infty\) with \(\frac{1}{p} + \frac{1}{q} = 1\). Then
  \[
    \frac{1}{p} |x|^p + \frac{1}{q} |y|^q \geq |x| \cdot |y|
  \]
  for all \(x, y \in \K\).
\end{corollary}

\begin{proof}
  Set \(t = |x|^p, s = |y|^q, \lambda = \frac{1}{p}\). Then
  \begin{align*}
    &\frac{1}{p} |x|^p + \frac{1}{q} |y|^q \geq |x| |y| \\
    \iff& \lambda t + (1 - \lambda) s \geq t^\lambda s^{1 - \lambda} \\
    \iff& \log (\lambda t + (1 - \lambda) s) \geq \lambda \log t + (1 - \lambda) \log s
  \end{align*}
  which holds by concavity of \(\log\).
\end{proof}

\begin{theorem}[Hölder's inequality]\index{Hölder's inequality}
  Let \(1 < p, q < \infty\) with \(\frac{1}{p} + \frac{1}{q} = 1\), let \(x \in \ell^p, y \in \ell^q\). Then \(xy = (x_ny_n)_n \in \ell^1\) and
  \[
    \norm{xy}_1 \leq \norm x_p \norm x_q.
  \]
\end{theorem}

\begin{proof}
  It suffcies to assumes that \(\norm x_p = 1 = \norm y_q\). By Hölder's inequality,
  \[
    \sum_{n = 1}^N |x_n y_n| \leq \frac{1}{p} \sum_{n = 1}^N |x_n|^p + \frac{1}{q} \sum_{n = 1}^N |y_n|^q.
  \]
  Take \(N \to \infty\),
  \[
    \norm{xy}_1 \leq \frac{1}{p} + \frac{1}{q} = 1 = \norm x_p \norm y_q.
  \]
\end{proof}

\begin{theorem}[Minkowski's inequality]\index{Minkowski's inequality}
  Let \(1 < p < \infty\) and let \(x, y \in \ell^p\). Then \(x + y \in \ell^p\) and \(\norm{x + y}_p \leq \norm x_p + \norm y_p\).
\end{theorem}

\begin{proof}
  We call the power \(r\). Have
  \begin{align*}
    & \sum_n |x_n + y_n|^r \\
    =& \sum_n |x_n + y_n|^{r - 1}|x_n + y_n| \\
    \leq& \sum_n |x_n + y_n|^{r - 1} |x_n| + \sum_n |x_n + y_n|^{r - 1} |y_n| \\
    \intertext{Applying Hölder's inequality for \(p = \frac{r}{r - 1}, q = r\) to the first term and similarly to the second term,}
    \leq& \left( \sum_n |x_n + y_n|^r \right) ^{\frac{r - 1}{r}} \left( \sum_n |x_n|^r \right)^{\frac{1}{r}} + \left( \sum_n |x_n + y_n|^r \right) ^{\frac{r - 1}{r}} \left( \sum_n |y_n|^r \right)^{\frac{1}{r}}
  \end{align*}
  Divide by both sides by a common factor, get
  \[
    \norm{x + y}_r \leq \norm x_r + \norm y_r.
  \]
\end{proof}

\subsection{Banach spaces}

\begin{definition}[Banach space]\index{Banach space}
  A normed vector space is a \emph{Banach space} if it is \emph{complete} as a metric space, i.e.\ every Cauchy sequence converges.
\end{definition}

\begin{ex}
  For \(1 \leq p \leq \infty\), the space \(\ell^p\) is complete.
\end{ex}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Any finite dimensional normed space is a Banach space.
  \item Let \(S\) be a set and let \(B(S)\) be the vector space of bounded functions on \(S\). Then \(B(S)\) is a Banach space with norm \(\norm f_\infty = \sup_{s \in S} |f(s)|\).
  \item Let \(K\) be a compact Hausdorff space (for concreteness, take \([0, 1]\)) and let \(C(K)\) be the space of continuous functions on \(K\). Then \(C(K) \subseteq B(K)\) as every continuous function on \(K\) is bounded. Moreover \(C(K) \subseteq B(K)\) is closed as the uniform limit of a sequence of continuous functions is continuous. Therefore \(C(K)\) is a Banach space with norm \(\norm \cdot_\infty\).
  \item Let \(U \subseteq \R^n\) be open bounded and let \(C^k(\cl U)\) be the space of functions \(f: \cl U \to \K\) \(k\)-times continuously differentiable on \(U\). Then \(C^k(\cl U)\) is a Banach space with norm
    \[
      \norm f_{C^k(\cl U)} = \max_{|\alpha| < k} \norm{D^\alpha f}_\infty,
    \]
    where
    \[
      D^\alpha(f(x)) = \frac{\partial^{|\alpha|} f}{\partial x_1^{\alpha_1} \dots \partial x_n^{\alpha_n}}
    \]
    where \(\alpha = (\alpha_1, \dots, \alpha_n) \in \N_0^n, |\alpha| = \sum_{i = 1}^n \alpha_i\).
  \item Let \(X\) be the space of continuous functions on \([0, 1]\). Then for \(p \in [1, \infty)\),
    \[
      \norm f_p = \left( \int_0^1 |f(x)|^p dx \right)^{1/p}
    \]
    is a norm on \(X\). However, \(X\) is \emph{not} complete in this norm! In IID Probability and Measure, we will show that its completion has a very nice description, namely \(L^p\).
  \item Let \(D = \{z \in \C: |z| < 1\}\) and let \(A(\cl D)\) be the space of continuous functions \(f: \cl D \to \C\) that are analytic in \(D\). Then \(A(\cl D)\) is complete with \(\norm \cdot_\infty\) because the uniform limit of a sequence of analytic functions is analytic.
  \end{enumerate}
\end{eg}

In example 3 above we used the following fact:

\begin{fact}
  Let \(X\) be a normed space and \(Y \leq X\) a subspace. Then
  \begin{enumerate}
  \item if \(Y\) is complete then \(Y\) is closed in \(X\).
  \item if \(X\) is complete and \(Y\) is closed then \(Y\) is complete.
  \end{enumerate}
\end{fact}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Let \(x \in \cl Y\). Then there is \((y_n) \subseteq Y\) such that \(y_n \to x\). In particular, \((y_n)\) is Cauchy so converges to some \(y \in Y\) by completeness. Thus by uniqueness of limit \(x = y \in Y\).
  \item Suppose \((y_n) \subseteq Y\). Then \((y_n)\) is Cauchy in \(X\). By completeness there is \(x \in X\) such that \(y_n \to x\). Since \(Y\) is closed, in fact \(x \in Y\).
  \end{enumerate}
\end{proof}

\begin{definition}[separable]\index{separable}
  A topological space is \emph{separable} if it has a countable dense subset.
\end{definition}

\begin{ex}\leavevmode
  \begin{enumerate}
  \item For \(1 \leq p < \infty\), \(\ell^p\) is separable.
  \item \(\ell^\infty\) is not separable.
  \item \(c_0\) is separable.
  \end{enumerate}
\end{ex}

\subsection{Bounded operators and the dual space}

\begin{proposition}
  Let \(X, Y\) be normed spaces, \(T: X \to Y\) linear, then TFAE:
  \begin{enumerate}
  \item \(T\) is continuous.
  \item \(T\) is continuous at \(0\).
  \item \(T\) is bounded, i.e.\ there is \(C > 0\) such that \(\norm{Tx} \leq C \norm x\) for all \(x \in X\).
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{itemize}
  \item \(1 \implies 2\): obvious.
  \item \(2 \implies 3\): since \(T\) is continuous at \(0\) and \(\{y \in Y: \norm y \leq 1\}\) is a neighbourhood of \(0 = T(0) \in Y\), there is \(\delta > 0\) such that \(\norm x < \delta\) implies that \(\norm{T x} \leq 1\). For any \(x \in X, x \neq 0\), by linearity,
    \[
      \norm{T x} = \frac{\norm x}{\delta} \norm{T \left(\delta \frac{x}{\norm x} \right)} \leq \frac{\norm x}{\delta}.
    \]
  \item \(3 \implies 1\): let \(\varepsilon > 0\). Set \(\delta = \frac{\varepsilon}{C}\). Then \(\norm{x - y} < \delta\) implies that
    \[
      \norm{Tx - Ty} = \norm{T(x - y)} \leq C \norm{x - y} \leq \varepsilon
    \]
    so \(T\) is (uniformly) continuous.
  \end{itemize}
\end{proof}

The infimum of such \(C\) is called

\begin{definition}[operator norm]\index{operator norm}
  For \(T: X \to Y\) bounded linear, the \emph{operator norm} is
  \[
    \norm T = \norm T_{\text{op}} = \sup_{\norm x \leq 1} \norm{Tx}.
  \]
\end{definition}

\begin{notation}
  \(B(X, Y) = \{T: X \to Y \text{ bounded and linear}\}\).
\end{notation}

\begin{fact}
  \(B(X, Y)\) is a normed space with norm given by the operator norm.
\end{fact}

\begin{proof}
  Let \(T, S \in B(X, Y)\). Then
  \[
    \norm{(T + S)x} = \norm{Tx + Sx}
    \leq \norm{Tx} + \norm{Sx}
    \leq (\norm T + \norm S) \norm x
  \]
  so \(\norm{T + S} \leq \norm T + \norm S\).

  The other axioms are clear.
\end{proof}

\begin{eg}
  Let \(p \in (1, \infty)\).
  \begin{enumerate}
  \item Define
    \begin{align*}
      T: \ell^p &\to \ell^p \\
      (x_1, x_2, \dots) &\mapsto (x_1, x_2, \dots, x_r, 0, 0, \dots)
    \end{align*}
    for some fixed \(r > 0\). Then \(T \in B(\ell^p, \ell^p)\) with \(\norm T = 1\).
  \item Define
    \begin{align*}
      T: \ell^p &\to \ell^p \\
      (x_1, x_2, \dots) &\mapsto (0, x_1, x_2, \dots ),
    \end{align*}
    called the right shift operator. Then \(T \in B(\ell^p, \ell^p)\) with \(\norm T = 1\). In fact, \(\norm{Tx} = \norm x\) for all \(x \in \ell^p\). This means that \(T\) is an isometry but not surjective.
  \item Similarly define
    \begin{align*}
      S: \ell^p &\to \ell^p \\
      (x_1, x_2, \dots) &\mapsto (x_2, x_3, \dots)
    \end{align*}
    with \(\norm S = 1\). Note that \(S\) is surjective but not injective. \(ST = \id \neq TS\).
  \item Let \(p, q \in [1, \infty]\) with \(\frac{1}{p} + \frac{1}{q} = 1\). Fix \(y \in \ell^q\) and define
    \begin{align*}
      \phi_y: \ell^p & \to \K \\
      x &\mapsto (x, y) := \sum_{n} x_yy_n
    \end{align*}
    i.e.\ \(\phi_y = (\cdot, y)\). By Hölder's inequality, this is well-defined and \(\norm{\phi_y} \leq \norm y_q\).
  \item An unbounded map: let \(F\) be the space of finite real sequences with \(\norm \cdot_1\). Define
    \begin{align*}
      T: F &\to \R \\
      (x_1, \dots, x_n, 0, 0, \dots) &\mapsto \sum_{i = 1}^n i x_i
    \end{align*}
    Then \(T\) is not bounded (i.e.\ not continuous) as \(\norm{T e_n} = n \to \infty\) as \(n \to \infty\).
  \item Define
    \begin{align*}
      T: \ell^1 &\to \ell^2 \\
      x &\mapsto x
    \end{align*}
    which has \(\norm T = 1\) because \(\sum_n |x_n| \leq 1\) implies \(\sum_n |x_n|^2 \leq 1\). But \(T\ell^1 \neq \ell^2\). Since \(T\ell^1\) is also dense in \(\ell^2\), \(T\ell^1\) is not closed in \(\ell^2\) and thus not complete.
  \end{enumerate}
\end{eg}

\begin{definition}[isomorphism, isometric isomorphism]\index{isomorphism}\index{isometric isomorphism}
  Let \(X\) and \(Y\) be normed spaces. Then
  \begin{enumerate}
  \item an \emph{isomorphism} from \(X\) to \(Y\) is a map \(T: X \to Y\) that is a linear homeomorphism. Thus \(T \in B(X, Y)\) and \(T^{-1} \in B(X, Y)\), i.e.\ there are \(C_1, C_2 > 0\) such that
    \[
      C_1 \norm x \leq \norm{Tx} \leq C_2 \norm x
    \]
    for all \(x \in X\).
  \item a bijective linear map \(T: X \to Y\) is an \emph{isometric isomorphism} if \(\norm{Tx} = \norm x\) for all \(x \in X\).
  \end{enumerate}

\end{definition}

\begin{definition}[dual space]\index{dual space}
  Let \(X\) be a normed space. Its \emph{dual space} is
  \[
    X^* = B(X, \K).
  \]

  A linear map \(X \to \K\) is called a \emph{functional}.
\end{definition}

\begin{theorem}
  Let \(X\) and \(Y\) be normed spaces with \(Y\) complete. Then \(B(X, Y)\) is also complete. In particular \(X^* = B(X, \K)\) is complete.
\end{theorem}

\begin{proof}
  Let \((T_n)_n \subseteq B(X, Y)\) be a Cauchy sequence. Then for every \(x \in X\), the sequence \((T_nx)_n \subseteq Y\) is Cauchy:
  \[
    \norm{T_n x - T_mx}
    = \norm{(T_n - T_m) x}
    \leq \underbrace{\norm{T_n - T_m}}_{< \frac{\varepsilon}{\norm x}} \norm x
    \leq \varepsilon
  \]
  Since \(Y\) is complete, there is \(y \in Y\) such that \(T_nx \to y\). Set \(Tx = y\). Need to check \(T \in B(X, Y)\) and \(\norm{T_n - T} \to 0\).
  \begin{itemize}
  \item \(T\) is linear:
    \begin{align*}
      &T(\lambda x + \mu y) \\
      =& \lim_{n \to \infty} T_n(\lambda x + \mu y) \\
      =& \lim_{n \to \infty} (\lambda T_n x + \mu T_n y) \\
      =& \mu T_x + \mu T_y
    \end{align*}
  \item \(T\) is bounded: for \(\norm x \leq 1\),
    \begin{align*}
      &\norm{Tx} \\
      \leq& \norm{T_nx} + \norm{(T_n - T) x} \\
      \leq& \norm{T_n} + \varepsilon \\
      \leq& \sup_n \norm{T_n}
    \end{align*}
    which is bounded as \((T_n)_n\) is Cauchy.
  \item \(T_n \to T\) in operator norm: for \(\norm x \leq 1\),
    \begin{align*}
      &\norm{T_n x - Tx} \\
      \leq& \norm{(T_n - T_m) x} + \norm{(T_m - T) x} \\
      \leq& \norm{T_n - T_m} + \varepsilon \\
      \leq& \limsup_{n \to \infty} \norm{T_n - T_m} \\
      \to& 0
    \end{align*}
  \end{itemize}
\end{proof}

\begin{eg}
  Let \(p, q \in (1, \infty)\) with \(\frac{1}{p} + \frac{1}{q} = 1\). Then the map
  \begin{align*}
    \phi: \ell^q &\to (\ell^p)^* \\
    y &\mapsto \phi_y = (\cdot, y)
  \end{align*}
  is an isometric isomorphism, i.e.\ \(\ell^q = (\ell^p)^*\).

\end{eg}

\begin{proof}
  Clearly \(\phi\) is linear. We have already seen that \(\norm{\phi_y} \leq \norm y_q\). Claim that \(\norm{\phi_y} \geq \norm y_q\): note that LHS is a supremum so suffices to find \(\norm x \leq 1\) such that \(|\phi_y(x)| \geq \norm y_q\). Take
  \[
    x_n =
    \begin{cases}
      |y_n|^{q/p - 1} \overline y_n & y_n \neq 0 \\
      0 & y_n = 0
    \end{cases}
  \]
  Then
  \[
    \norm x_p^p = \sum_n |x_n|^p = \sum_n |y_n|^q = \norm y_q^q < \infty
  \]
  so \(x \in \ell^p\). We have
  \[
    \phi_y(x) = (x, y) \geq \sum_{n} |y_n|^{q/p + 1} = \sum_n |y_n|^q = \norm y_q^q = \norm y_q \norm y_q^{q - 1}.
  \]
  Note that
  \[
    \norm y_q^{q - 1} = \norm x_p^{\frac{p}{q}(q - 1)} = \norm x_p^{p (1 - \frac{1}{q})} = \norm x_p
  \]
  so
  \[
    |\phi_y(x)| = \norm y_q \norm x_p.
  \]
  Thus \(\phi\) is an isometry. It remains to check that \(\phi\) is surjective. Let \(T \in (\ell^p)^*\). Set \(y_n = Te_n\). Claim that \(y \in \ell^p\) and \(\norm y_q \leq \norm T\): define
  \[
    x_n =
    \begin{cases}
      |y_n|^{q/p - 1} \overline y_n & n \leq N \text{ and } y_n \neq 0 \\
      0 & \text{otherwise}
    \end{cases}
  \]
  We want to proceed as before but we don't know if \(y \in \ell^q\) this time so we only take the first \(N\) terms. Then \(\norm x_p^p = \sum_{n = 1}^N |y_n|^q\) so \(x \in \ell^p\) and
  \[
     Tx
    = \sum_{n = 1}^N x_n Te_n
    = \sum_{n = 1}^N x_n y_n
    = \sum_{n = 1}^N |y_n|^q
  \]
  Rewrite the equation backward,
  \[
    \sum_{n = 1}^N |y_n|^q
    = Tx
    \leq \norm T \norm x_p
    = \norm T \left( \sum_{n = 1}^N |y_n|^q \right)^{1/p}
  \]
  so
  \[
    \left( \sum_{n = 1}^N |y_n|^q \right)^{1 - 1/p} \leq \norm T
  \]
  so \(\norm y_q \leq \norm T\).

  Finally, claim that \(T = \phi_y\): for all \(n\), by construction we know
  \[
    Te_n = \phi_y(e_n) = y_n.
  \]
  Since \(T\) and \(\phi_y\) are both continuous and linear, \(T = \phi_y\) on the span of \(\{e_n: n \geq 1\}\) which is just \(\ell^p\).
\end{proof}

\begin{remark}
  Similarly, \((\ell^1)^* = \ell^\infty\) and \(c_0^* = \ell^1\) by the same argument. But the argument does \emph{not} show \((\ell^\infty)^* = \ell^1\) since \(\{e_n\}\) is not dense in \(\ell^\infty\), i.e.\ it is not separable.
\end{remark}

\begin{corollary}
  For \(1 \leq p \leq \infty\), \(\ell^p\) is complete.
\end{corollary}










\printindex
\end{document}

% http://www.statslab.cam.ac.uk/~rb812/teaching/la2018/index.html