\documentclass[a4paper]{article}

\def\npart{IB}

\def\ntitle{Complex Analysis}
\def\nlecturer{G.\ P.\ Paternain}

\def\nterm{Lent}
\def\nyear{2018}

\input{header}

\newcommand*{\D}{\mathcal{D}}

\makeindex

\begin{document}

\input{titlepage}

\tableofcontents

\section{Basic notions}

Some preliminary notations/definitions:

\begin{notation}\leavevmode
  \begin{itemize}
  \item \(D(a, r)\) is the open disc of radius \(r > 0\) and centred at \(a \in \C\).
  \item \(U \subseteq \C\) is open if for any \(a \in U\), there exists \(\varepsilon > 0\) such that \(D(a, \varepsilon) \subseteq U\).
  \item A \emph{curve} is a continuous map from a closed interval \(\varphi: [a, b] \to \C\). It is continuously differentiably, i.e.\ \(C^1\), if \(\varphi'\) exists and is continuous on \([a, b]\).
  \item An open set \(U \subseteq \C\) is \emph{path-connected} if for every \(z, w \in U\) there exists a curve \(\varphi: [0, 1] \to U\) with endpoints \(z, w\).
  \end{itemize}
\end{notation}

\begin{definition}[Domain]\index{domain}
  A \emph{domain} is an non-empty path-connected open subset of \(\C\).
\end{definition}

The goal of this course is to study functions \(f: U \to \C\) where \(U \subseteq \C\) is open or is a domain. Given such an \(f\), we may write
\[
  f(x + iy) = u(x, y) + iv(x, y)
\]
where \(u, v: U \to \R\) are the real and imaginary part of \(f\). Here we use \((x, y) \in \R^2\) to denote the coordinates of \(a + bi \in \C\).

\begin{definition}[Differentiable, holomorphic]\index{differentiable}\index{holomorphic}\leavevmode
  \begin{enumerate}
  \item \(f: U \to \C\) is differentiable at \(w \in U\) if the limit
    \[
      f'(w) = \lim_{z \to w} \frac{f(z) - f(w)}{z - w}
    \]
    exists. \(f'(w)\) is called the \emph{derivative} of \(f\) at \(w\).
  \item \(f\) is \emph{holomorphic} at \(w\) if there exists \(\varepsilon > 0\) such that \(f\) is differentiable at all points of \(D(w, \varepsilon)\). \(f\) is holomorphic on \(U\) if it is differentiable at all \(w \in U\). Equivalent, \(f\) is holomorphic at at all \(w \in U\).
  \end{enumerate}
\end{definition}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item There is an alternative term \emph{analytic}. In actuality, it is the same as holomorphic for complex functions. However, it comes with a flavour associated with the Taylor expansion and sometimes defined in terms of such. Later in the course we will prove that the definitions are equivalent.
  \item Complex differentiation follows the same rules as real differentiation. For example, sums of differentiable functions are differentiable, product, quotient, chain rules etc also hold.
  \end{enumerate}
\end{remark}

\begin{definition}[Entire]\index{entire}
  An \emph{entire} function is a holomorphic function \(f: \C \to \C\).
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Polynomials are entire functions.
  \item If \(p(z)\) and \(q(z)\) are polynomials with \(q(z)\) not identically zero, then \(\frac{p}{q}\) is holomorphic on \(\C \setminus \{\text{zeros of } q\}\).
  \end{enumerate}
\end{eg}

In IB Analysis II we studied function from \(\R^n\) to \(\R^m\) and their differentiability. Indeed a complex function \(\C \to \C\) can be view as a function \(\R^2 \to \R^2\) so how does complex differentiability relates to differentiablitiy in \(\R^2\)? It turns out that in addition to satisfy the differentiability on \(\R^2\), the function has to satisfy a particular partial differential equation.

Recall that \(u\) is differentiable at \((c, d) \in U\) if there exists \((\lambda, \mu) \in \R^2\) such that
\[
  \frac{u(x, y) - u(c, d) - (\lambda(x - c) + \mu(y -d))}{\sqrt{(x - c)^2 + (y - d)^2}} \to 0
\]
as \((x, y) \to (c, d)\). In this case \(\D u(c, d) = (\lambda, \mu)\) is the derivative of \(u\) at \((c, d)\). If this holds then \(\lambda = u_x(c, d)\) and \(\mu = u_y(c, d)\), the partical derivatives of \(u\) at \((c, d)\).

\begin{theorem}[Cauchy-Riemann equations]\index{Cauchy-Riemann}
  \(f: U \to \C\) is differentiable at \(w = c + id \in U\) if and only if the functions \(u\) and \(v\) are differentiable at \((c, d)\) and
  \begin{align*}
    u_x(c, d) &= v_y(c, d) \\
    u_y(c, d) &= -v_x(c, d)
  \end{align*}
  in which case
  \[
    f'(w) = u_x(c, d) + iv_x(c, d).
  \]
\end{theorem}

\begin{proof}
  From the definition, \(f\) will be differentiable at \(w\) with derivative \(f'(w) = p + iq\) if and only if
  \[
    \lim_{z \to w} \frac{f(z) - f(w) - f'(w)(z - w)}{|z - w|} = 0
  \]
  or equivalently, splitting into real and imaginary parts,
  \begin{align*}
    \lim_{(x, y) \to (c, d)} \frac{u(x, y) - u(c, d) - (p(x - c) - q(y - d))}{\sqrt{(x - c)^2 + (y - d)^2}} &= 0 \\
    \lim_{(x, y) \to (c, d)} \frac{v(x, y) - v(c, d) - (q(x - c) + p(y - d))}{\sqrt{(x - c)^2 + (y - d)^2}} &= 0
  \end{align*}
  since \(f'(w)(z - w) = (p(x - c) - q(y - d)) + i(q(x - c) + p(y - d))\). So \(f\) is differentiable at \(w\) with derivative \(f'(w) = p + iq\) if and only if \(u\) and \(v\) are differentiable at \((c, d)\) with
  \begin{align*}
    \D u(c, d) &= (p, -q) \\
    \D v(c, d) &= (q, p)
  \end{align*}
  hence the result.
\end{proof}

\begin{eg}
  Let \(f(z) = \conj z\). Then \(f(x + iy) = x - iy\), \(u(x, y) = x, v(x, y) = -y\). We have
  \[
    u_x = 1 \neq -1 = v_y
  \]
  so \(f\) is not differentiable anywhere in \(\C\).
\end{eg}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item We could have discovered Cauchy-Riemann as follows: let \(z = w + h\) where \(h \in \R\). Then
    \[
      f'(w) = \lim_{h \to 0} \frac{f(w + h) - f(w)}{h} = u_x(c, d) + iv_x(c, d).
    \]
    Let \(z = w + ih\), we get
    \[
      f'(w) = \lim_{h \to 0} \frac{f(w + ih) - f(w)}{h} = v_y(c, d) - iu_y(c, d).
    \]
    As \(f\) is assumed to be differentiable, these two must agree.
  \item Later on we'll see that if \(f\) is holomorphic, so is \(f'\). This will imply right away that all partial derivatives of \(u\) and \(v\) exist and are continuous, i.e.\ \(C^\infty\). Thus
    \begin{align*}
      u_{xx} &= v_{yx} \\
      u_{yy} &= -v_{xy}
    \end{align*}
    By symmetry of second derivatives, we get that \(u\) satisfies the Laplace equation
    \[
      u_{xx} + u_{yy} = 0.
    \]
    Hence \(f\) is holomorphic implies that the real and imaginary parts are harmonic functions.
  \end{enumerate}
\end{remark}

\begin{corollary}
  Let \(f = u + iv: U \to \C\). Suppose the functions \(u\) and \(v\) have continuous partial derivatives everywhere in \(U\) and satisfy Cauchy-Riemann equations. Then \(f\) is holomorphic in \(U\).
\end{corollary}

\begin{proof}
  From IB Analysis II, \(u\) and \(v\) are differentiable. The result follows from the previous theorem.
\end{proof}

\begin{corollary}
  Let \(f: D \to \C\) be holomorphic on a domain \(D\) and suppose \(f'(z) = 0\) for all \(z \in D\). Then \(f\) is constant on \(D\).
\end{corollary}

\begin{proof}
  Follows from the analogous result for differentiable functions on a path-connected subset of \(\R^2\) (Mean Value Inequality from IB Analysis II).
\end{proof}

\section{Power Series}

Recall that

\begin{theorem}[Radius of convergence]\index{radius of convergence}
  Let \(c_n\) be a sequence of complex numbers. Then there exists a unique \(R \in [0, \infty]\), the \emph{radius of convergence} of the series, such that
  \[
    \sum_{n = 0}^\infty c_n(z - a)^n,\, z, a \in \C
  \]
  converges absolutely if \(|z - a| < R\) and diverges if \(|z - a| > R\). If \(0 < r < R\) then the series converges uniformly on \(\{|z - a| \leq r\}\). The radius of convergence is given by
  \[
    R = \sup\{r \geq 0: |c_n|r^n \to 0\}.
  \]
\end{theorem}

\begin{theorem}
  Let \(f(z) = \sum_{n = 0}^\infty c_n(z - a)^n\) be a complex power series with radius of convergence \(R > 0\). Then
  \begin{enumerate}
  \item \(f\) is holomorphic on \(D(a, R)\),
  \item its derivative is given by the series \(\sum_{n = 1}^\infty nc_n(z - a)^{n - 1}\), which also has radius of convergence \(R\),
  \item \(f\) has derivatives of all orders on \(D(a, R)\) and \(f^{(n)}(a) = n!c_n\),
  \item if \(f\) vanishes identically on some disc \(D(a, \varepsilon)\) then \(c_n = 0\) for all \(n\).
  \end{enumerate}
\end{theorem}

\begin{proof}
  wlog assume \(a = 0\). Claim that \(\sum_{n = 1}^\infty nc_nz^{n - 1}\) has radius of convergence \(R\).

  \begin{proof}
    \(|nc_n| \geq |c_n|\) so its radius of convergence \(R'\) is at most \(R\).

    Suppose \(0 \leq r < R\) and pick \(\rho \in (r, R)\). Then \(\sum |c_n|\rho^n\) converges and
    \[
      \frac{n|c_n|r^{n - 1}}{|c_n|\rho^n} = \frac{n}{r}\underbrace{\left(\frac{r}{\rho}\right)^n}_{< 1} \to 0
    \]
    so by comparison test \(\sum nc_nr^{n - 1}\) converges and hence \(R' = R\).
  \end{proof}

  To show the derivative is of the desired form we shall do something clever. Consider the continous function
  \[
    h_n(z, w) = \sum_{j = 0}^{n - 1} z^j w^{n - 1 - j} =
    \begin{cases}
      \frac{z^n - w^n}{z - w} & \text{if } z \neq w \\
      nw^{n - 1} & \text{if } z = w
    \end{cases}
  \]
  for \(n \geq 1\). Consider the series
  \begin{equation}
    \label{eqn:hzw}
    \sum_{n = 1}^\infty c_nh_n(z, w).
    \tag{\(\ast\)}
  \end{equation}
  Claim that for every \(r < R\), \eqref{eqn:hzw} converges uniformly on the set \(\{(z, w): |z|, |w| \leq r\}\).

  \begin{proof}
    \(|c_nh_n(z, w)| \leq |c_n|nr^{n - 1} = M_n\). Since we know \(\sum M_n < \infty\), by Weierstrass M-test \eqref{eqn:hzw} converges uniformly.
  \end{proof}

  Thus it converges to a continuous function \(g(z, w)\). By definition
  \[
    g(z, w) =
    \begin{cases}
      \sum_{n = 1}^\infty c_n \frac{z^n - w^n}{z - w} = \frac{f(z) - f(w)}{z - w} & \text{if } z \neq w \\
      \sum_{n = 1}^\infty c_nnw^{n - 1} & \text{if } z = w
    \end{cases}
  \]
  As \(g\) is continuous, fixing \(w\) and letting \(z \to w\) we get
  \[
    \lim_{z \to w} \frac{f(z) - f(w)}{z - w} = \sum_{n = 1}^\infty nc_nw^{n - 1}.
  \]
  So \(f'(w)\) exists and equals to \(g(w, w)\) as desired. This proves (1) and (2). (3) follows by induction on \(n\). Finally if \(f\) vanishes identically on a disc about \(a\) then \(f^{(n)} = 0\) for all \(n\) and by (3) \(c_n = 0\) for all \(n\).
\end{proof}

\begin{proposition}[Weierstrass M-test]
  Let \(f_n\) be a sequence of functions such that \(|f_n(x)| \leq M_n\) for all \(x \in A\). If \(\sum M_n < \infty\) then \(\sum f_n(x)\) converges uniformly on \(A\).
\end{proposition}

\begin{proof}
  Exercise.
\end{proof}

\begin{definition}[Exponential]\index{exponential}
  The \emph{complex exponential} function is defined as
  \[
    e^z = \exp(z) = \sum_{n = 0}^\infty \frac{z^n}{n!}.
  \]
\end{definition}

\begin{proposition}\leavevmode
  \begin{enumerate}
  \item \(e^z\) is an entire function and \((e^z)' = e^z\).
  \item For all \(z, w \in \C\), \(e^{z + w} = e^ze^w\) and \(e^z \neq 0\).
  \item If \(z = x+ iy\), \(e^z = e^x (\cos y + i \sin y)\).
  \item \(\exp(z) = 1\) if and only if \(z \in 2\pi i \Z\).
  \item If \(w \in \C\), there exists \(z \in \C\) such that \(e^z = w\) if and only if \(w \neq 0\).
  \end{enumerate}
\end{proposition}

\begin{proof}
  Similar to the proof in IA Analysis I.
\end{proof}

We also define
\begin{align*}
  \cos z &= \frac{e^{iz} + e^{-iz}}{2} \\
  \sin z &= \frac{e^{iz} - e^{-iz}}{2i} \\
  \cosh z &= \frac{e^z + e^{-z}}{2} \\
  \sinh z &= \frac{e^z - e^{-z}}{2}
\end{align*}

\begin{definition}[Logarithm]\index{logarithm}
  If \(z \in \C\), we say that \(w \in \C\) is a \emph{logarithm} of \(z\) if \(\exp(w) = z\).
\end{definition}

From above we know \(z\) has a logarithm if and only if \(z \neq 0\). However, unlike in the real case, \(z\) would have an infinite number of logarithms, all different by an integer multiplier of \(2\pi\).

\begin{definition}[Branch of logarithm]
  Let \(U \subseteq \C\setminus \{0\}\) be open. We say that a continuous function \(\lambda: U \to \C\) is a \emph{branch of logarithm} if \(e^{\lambda(z)} = z\).
\end{definition}

\begin{remark}
  Any branch of logarithm is in fact automatically holomorphic:
  \begin{align*}
    \frac{\lambda(z) - \lambda(w)}{z - w}
    &= \frac{\lambda(z) - \lambda(w)}{e^{\lambda(z)} - e^{\lambda(w)}} \\
    \intertext{Let \(\lambda(w) = k, \lambda(z) = k + h\). Due to continuity of \(\lambda\), \(\lambda(z) - \lambda(w) = h \to 0\) so}
    &= \frac{h}{e^{k + h} - e^k} \\
    &\to \frac{1}{e^k} \\
    &= \frac{1}{w}
  \end{align*}
  as \(z \to w\). Thus \(\lambda\) is holomorphic and \(\lambda'(z) = \frac{1}{w}\).

  %the argument would have given differential exists for inverse function. If we know the invere was continuous. ONe can describe the inverse function theorem (with the argumentabove the continuity of the inverse is needed.
\end{remark}

One useful choice of branch is
\begin{definition}[Principal branch of logarithm]\index{principal branch of logarithm}
  Let \(U = \C \setminus \{x \in \R: x\leq 0\} = \R_{\leq 0}\). The \emph{principal branch of logarithm} is the function
  \begin{align*}
    \log: U &\to \C \\
    z &\mapsto \log |z| + i \arg(z)
  \end{align*}
  where \(\arg(z)\) takes the unique argument of \(z\) in the interval \((-\pi, \pi)\).
\end{definition}

Check that this is indeed a branch of logarithm: the projection onto \(S^1\) \(\C \setminus \{0\} \to S^1, z \mapsto z/|z|\) is continuous and maps \(U\) to \(S^1 \setminus \{-1\}\). \((-\pi, \pi) \to S^1 \setminus \{-1\}, \theta \mapsto e^{i\theta}\) is a homeomorphism so has a continuous inverse. Thus \(z \mapsto \arg(z)\) is continuous. Also
\[
  \exp(\log z) = e^{i \log |z|}(\cos \arg(z) + i \sin \arg(z)) = z.
\]

\begin{proposition}\leavevmode
  \begin{enumerate}
  \item \(\log z\) is holomorphic on \(U\) with derivative \(\frac{1}{z}\).
  \item If \(|z| < 1\) then
    \[
      \log(1 + z) = \sum_{n = 1}^\infty \frac{(-1)^{n - 1}z^n}{n}.
    \]
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item See remarks above.
  \item Note that
    \begin{align*}
      \frac{d \log(1 + z)}{dz}
      &= \frac{1}{1 + z} \\
      \frac{d}{dz} \sum_{n = 1}^\infty \frac{(-1)^{n - 1}z^n}{n}
      &= \sum_{n = 1}^\infty (-1)^{n - 1}z^{n -1}
        = \frac{1}{1 + z}
    \end{align*}
    Thus their difference is constant. Now set \(z = 0\).
  \end{enumerate}
\end{proof}

\begin{remark}
  There is no way to extend \(\log z\) to a holomorphic (or even just continuous) function on \(\C \setminus \{0\}\) since
  \begin{align*}
    \lim_{\theta \to -\pi} \log e^{i\theta} &= -i\pi \\
    \lim_{\theta \to \pi} \log e^{i\theta} &= i\pi \\
  \end{align*}
  Later on we will see that there is no branch of logarithm on \(\C \setminus \{0\}\).
\end{remark}

We can also define fractional/complex powers by the formula
\[
  z^\alpha = \exp (\alpha \log z)
\]
for \(z \in U\). See example sheet.


\subsection{Conformal maps}

Let \(f: U \to \C\) be a holomorphic function on an open set \(U\) and suppose \(w \in U\) and \(f'(w) \neq 0\). In this section we study the property of \(f\) in neighbourhoods of \(w\). Take two \(C^1\)-curves \(\gamma_i: [0, 1] \to U\), \(i = 1, 2\) such that \(\gamma_i(0) = w, \gamma_i'(0) \neq 0\). Define the angle between \(\gamma_1, \gamma_2\) to be
\[
  \operatorname{angle}(\gamma_1, \gamma_2) = \arg(\gamma_1'(0)) - \arg(\gamma_2'(0)).
\]
Here \(\arg(z) = \in \in [0, 2\pi)\) for \(z = re^{i\theta}\). Consider the image \(\delta_i(t) = f(\gamma_i(t))\). The new angle is
\[
  \operatorname{angle}(\delta_1, \delta_2) = \arg((f \compose \gamma_1)'(0)) - \arg((f \compose \gamma_2)'(0)).
\]
Now recall that
\[
  \arg(z) - \arg(w) = \arg(\frac{z}{w})
\]
so
\[
  \frac{(f \compose \gamma_1)'(0)}{(f \compose \gamma_2)'(0)}
  = \frac{f'(w)\gamma_1'(0)}{f'(w)\gamma_2'(0)}
  = \frac{\gamma_1'(0)}{\gamma_2'(0)}
\]
since \(f'(w) \neq 0\). Thus \(f\) preserves angles at \(w\). We say \(f\) is \emph{conformal}\index{conformal} at \(w\) in this case.

\begin{definition}[Conformal equivalence]\index{conformal equivalence}
  If \(f: D \to \C\) is holomorphic on a domain \(D\) with \(f' \neq 0\) everywhere and \(f\) injective, we say \(f\) is a \emph{conformal equivalence}.
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Möbius maps \(f(z) = \frac{az + b}{cz + d}\) where \(ad - bc \neq 0\). It is a bijection from \(\C \cup \{\infty\}\) to itself. It maps circles/lines to circles/lines.
  \item \(z \mapsto z^n\), \(\{z \in \C\setminus\{0\}: 0 < \arg z < \pi/n\} \to \{z \in \C: \Im z > 0\}\). The inverse, \(z^{1/n}\) using the principal branch, is also a conformal map.
  \item \(\exp\) maps conformally the strip \(\{z \in \C: \Re(z) \in (-\pi, \pi)\}\) to \(\C\subseteq\{z \leq 0\}\), with inverse \(\log z\) with principal branch cut.
  \end{enumerate}
\end{eg}

We will just state an important theorem here which will be proved later:

\begin{theorem}[Riemann mapping theorem]
  Let \(D \subseteq \C\) be any domain bounded by a simple closed curve. Then there exists a conformal equivalence \(D \to D(0, 1)\) between \(D\) and \(D(0, 1)\).

  More generally, this holds for any simply connected domain which is not all \(\C\).
\end{theorem}

\section{Complex Integration I}

\subsection{Integration along curves}

Let \(f: [a, b] \to \C\) be a continuous map, then its integral is simply the sum of the integral of the real and imaginary part:
\[
  \int_a^b f(t) dt = \int_a^b \Re f(t) dt + i \int_a^b \Im f(t) dt.
\]

\begin{proposition}
  \label{prop:absolute value integral inequality}
  \[
    \left| \int_a^b f(t) dt \right| \leq (b - a) \sup_{t \in [a, b]} |f(t)|
  \]
  with equality if and only if \(f\) is constant.
\end{proposition}

\begin{proof}
  Let \(\theta = \arg \int_a^b f(t)d(t)\) and let \(M = \sup_{t \in [a, b]} |f(t)|\). Clearly
  \[
    \int_a^b f(t) dt = \left| \int_a^b f(t) dt\right| e^{i\theta}
  \]
  so
  \begin{align*}
    \left|\int_a^b f(t)dt\right| &= e^{-i\theta} \int_a^b f(t) dt \\
                                 &= \int_a^b e^{-i\theta}f(t)dt \\
                                 &= \int_a^b \Re(e^{-i\theta}f(t)) dt \\
                                 &\leq \int_a^b|f(t)|dt \\
                                 &\leq M(b - a)
  \end{align*}
  If the equality holds then \(|f(t)| = M\) is constant by the last inequality, and it follows from the second last inequality that \(\arg f(t) = \theta\) so \(f\) is constant.
\end{proof}

If \(\gamma: [a, b] \to \C\) is a \(C^1\) curve, we can define its length as follow. Write \(\gamma(t) = x(t) + iy(t)\) and define the length to be
\[
  \int_a^b |\gamma'(t)|dt = \int_a^b \sqrt{x'(t) + y'(t)} dt.
\]

\begin{definition}[Simple curve]
  We say \(\gamma\) is \emph{simple} if \(\gamma(t_1) \neq \gamma(t_2)\) unless \(t_1 = t_2\) or \(\{t_1, t_2\} = \{a, b\}\).
\end{definition}

\begin{definition}[Integration along a curve]\index{integration along a cruve}
  Suppose \(f: U \to \C\) is continuous with \(U \subseteq \C\) an open subset. Let \(\gamma: [a, b] \to U\) be a \(C^1\) curve. The \emph{integral of \(f\) along \(\gamma\)} is
  \[
    \int_\gamma f(z)dz = \int_a^b f(\gamma(t))\gamma'(t) dt.
  \]
\end{definition}

Some basic properties:
\begin{enumerate}
\item linearity:
  \[
    \int_\gamma (c_1f_1(z) + c_2f_2(z))dz = c_1 \int_\gamma f_1(z) dz + c_2 \int_\gamma f_2(z) dz.
  \]
\item additivity: if \(a < a' < b\),
  \[
    \int_\gamma f(z)dz = \int_{\gamma|_{[a, a']}} f(z) dz + \int_{\gamma|_{[a', b]}} f(z)dz.
  \]
\item inverse path: define the inverse path of \(\gamma\) to be
  \begin{align*}
    -\gamma: [-b, -a] &\to U \\
    t &\mapsto \gamma(-t)
  \end{align*}
  then
  \[
    \int_{-\gamma} f(z)dz = -\int_\gamma f(z)dz.
  \]
\item independence of reparameterisation: if \(\phi: [a', b'] \to [a, b]\) is \(C^1\) and \(\phi(a') = a, \phi(b') = b\), then let \(\delta = \gamma \compose \phi: [a', b'] \to U\), we have
  \[
    \int_\gamma f(z) dz = \int_\delta f(z)dz.
  \]
\end{enumerate}
All except the last one is trivial. A quick check
\begin{align*}
  \int_\delta f(z)dz &= \int_{a'}^{b'} f(\delta(t))\delta'(t) dt \\
                     &= \int_{a'}^{b'} f(\gamma(\phi(t))) \gamma'(\phi(t)) \phi'(t) dt \\
                     &= \int_a^b f(\gamma(s))\gamma'(s) ds \\
                     &= \int_{\gamma}^{ } f(z) dz
\end{align*}

In reality, we may encounter curves that are not \(C^1\), for example along the sides of a square. However, they are made of pieces of \(C^1\) curves. In a sense that will be address by the definition below, this is the worst case we will encounter in this course.

\begin{definition}[Piecewise \(C^1\)]
 Let \(\gamma: [a, b] \to \C\) be a continuous curve. Suppose we have
\[
  a = a_0 < a_1 < \dots < a_n = b
\]
such that \(\gamma|_{[a_{i - 1}, a_i]}\) is \(C^1\) for \(1 \leq i \leq n\). Then we say that \(\gamma\) is \emph{piecewise differentiable} or \emph{piecewise \(C^1\)}.
\end{definition}

Then we define
\[
  \int_\gamma f(z) dz = \sum_{i = 1}^n \int_{\gamma_i} f(z)dz.
\]

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(f(z) = z^n\) where \(n \in \Z\). Form now on define the \emph{punctured complex plane} to be \(\C^* = \C \setminus \{0\}\). Let \(U = \C^*\). Let
    \begin{align*}
      \gamma: [0, 2\pi] &\to U \\
      t &\mapsto e^{it}
    \end{align*}
    which is a circle around the origin. Then
    \[
      \int_\gamma f(z) dz =
      \int_0^{2\pi} e^{int}ie^{it} dt
      = i\int_0^{2\pi} e^{i(n + 1)t} dt
      =
      \begin{cases}
        2\pi i & \text{if } n = -1 \\
        0 & \text{otherwise}
      \end{cases}
    \]
    In the case \(n = -1\) \(f\) is not defined at \(0\), which is encircled by the closed path.
  \item \(f(z) = z^2\). \(\gamma = \gamma_1 + \gamma_2\) where
    \begin{align*}
      \gamma_1: [-R, R] &\to \C \\
      t &\mapsto t \\
      \gamma_2:[0, 1] &\to \C \\
      t &\mapsto Re^{i\pi t}
    \end{align*}
    Then
    \begin{align*}
      &\phantom{=} \int_\gamma f(z)dz \\
      &= \int_{\gamma_1} f(z)dz + \int_{\gamma_2} f(z) dz \\
      &= \int_{-R}^R t^2dt + \int_0^1 R^2e^{2\pi it}i\pi Re^{i\pi t} dt \\
      &= \frac{2R^3}{3} - \frac{2R^3}{3} \\
      &= 0 
    \end{align*}
  \end{enumerate}
\end{eg}

In general, for a holomorphic function, if the closed path does not include a pole of the function then the integral along the curve is \(0\).

\begin{proposition}
  For any continuous \(f: U \to \C\) and any curve \(\gamma: [a, b] \to U\),
  \[
    \left| \int_\gamma f(z)dz \right| \leq \ell(\gamma) \cdot \sup_\gamma|f|
  \]
  where \(\sup_\gamma |f| = \sup_{t \in [a, b]} |f(\gamma(t))|\).
\end{proposition}

\begin{proof}
  wlog assume \(\gamma\) is \(C^1\),
  \begin{align*}
    \left| \int_\gamma f(z)dz \right| &= \left| \int_a^bf(\gamma(t))\gamma'(t)dt \right| \\
                                      &\leq \int_a^b |f(\gamma(t))||\gamma'(t)| dt \\
                                      &\leq \sup_\gamma|f| \int_a^b |\gamma'(t)| dt \\
                                      &= \sup_\gamma|f| \cdot \ell(f)
  \end{align*}
\end{proof}

\begin{theorem}[Fundamental Theorem of Calculus]\index{Fundamental Theorem of Calculus}
  Suppose \(f: U \to \C\) is continuous and suppose there exists \(F(z)\) such that for all \(z \in U\), \(F'(z) = f(z)\). Then for any curve \(\gamma: [a, b] \to U\), we have
  \[
    \int_\gamma f(z) dz = F(\gamma(b)) - F(\gamma(a)).
  \]
\end{theorem}

\begin{note}
  \(F\) is called an \emph{anti-derivative} of \(f\) on \(U\).
\end{note}

\begin{proof}
  \begin{align*}
    \int_\gamma f(z)dz
    &= \int_a^b f(\gamma(t))\gamma'(t) dt \\
    &= \int_a^b (F \compose \gamma)'(t) dt \\
    &= F(\gamma(b)) - F(\gamma(a))
  \end{align*}
\end{proof}

\begin{corollary}
  If \(\gamma\) is closed (\(\gamma(b) = \gamma(a)\)) and \(f\) is continuous and has an anti-derivative \(F\) on  \(U\), then
  \[
    \int_\gamma f(z)dz = 0.
  \]
\end{corollary}

\begin{eg}
  \(f(z) = z^n\) where \(n \in \Z\) defined on \(\C^*\). If \(n \neq -1\),
  \[
    f(z) = \frac{d}{dz} \left( \frac{z^{n + 1}}{n + 1} \right)
  \]
  so the integral along any closed curve is \(0\).

  However, if \(n = -1\) we do not have an anti-derivative on all \(\C^*\) and we computed last time
  \[
    \int_\gamma \frac{dz}{z} = 2\pi i.
  \]
  This is because we can't define \(\log\) as an anti-derivative of \(\frac{1}{z}\) on all \(\C^*\).
\end{eg}

Now we prove a converse to the corollary:

\begin{proposition}
  \label{prop:existence of anti-derivative}
  Let \(U \subseteq \C\) be a domain. If \(f: U \to \C\) is continuous and \(\int_\gamma f(z)dz = 0\) for all closed curves \(\gamma\) on \(U\), then \(f\) has an anti-derivative \(F\) on \(U\), i.e.\ there exists \(F\) such that \(F' = f\).
\end{proposition}

\begin{proof}
  Given that \(U\) is path-connected, the immediate choice of \(F\) coming to mind is
  \[
    F(w) = \int_{\gamma_w} f(z)dz
  \]
  where \(\gamma_w: [0, 1] \to U\) is a path from a fixed point \(a_0\) to \(w\). Note that \(F\) is \emph{independent} of the choice of \(\gamma_w\) precisely because of the hypothesis.

  Now claim that \(F\) is holomorphic and \(F' = f\). Since \(U\) is open, there exists \(r > 0\) such that \(D(w, r) \subseteq U\). Let \(h\) be such that \(|h| < r\) and let \(\delta_h\) be the radial path from \(w\) to \(w + h\). Note that \(\delta_n \subseteq D(w, r)\). Let \(\gamma = \gamma_w \cdot \delta_h \cdot (-\gamma_{w + h})\) where \(\cdot\) denotes path concatenation. Then
  \[
    0 = \int_\gamma f(z) dz = F(w) + \int_{\delta_h} f(z)dz - F(w + h).
  \]
  Now
  \begin{align*}
    \left| \frac{F(w + h) - F(w)}{h} - f(w) \right|
    &= \frac{1}{|h|} \left| \int_{\delta_h} (f(z) - f(w)) dz \right| \\
    &\leq \frac{\ell(\delta_h)}{|h|} \sup_{z \in \delta_h} |f(z) - f(w)| \\
    &\to 1 \cdot 0
  \end{align*}
  as \(h \to 0\) since \(f\) is continuous.
\end{proof}

This proposition, or the proof thereof contains an idea can be applied to more general circumstances. We first define

\begin{definition}[Star-shaped]\index{star-shaped}
  A domain \(U\) is \emph{star-shaped} (or called a star domain) if there exists \(p \in U\) such that for all \(a \in U\), the straight segment from \(a\) to \(p\) is contained in \(U\).
\end{definition}

We thus have
\[
  \text{disc} \implies \text{convex} \implies \text{star-shape} \implies \text{domain}.
\]

\begin{corollary}\label{cor:anti-derivative}
  If \(U\) is star-shaped, \(f: U \to \C\) is continuous and \(\int_\gamma f(z)dz = 0\) for all triangles \(\gamma \subseteq U\) then \(f\) has an anti-derivative on \(U\).
\end{corollary}

A triangle is, as one might infer, a closed curve made of three straight line segments.

\begin{proof}
  Let \(a_0 = a\) and \(\delta_w\) and \(\delta_{w + h}\) be straight line segments in the previous proof.
\end{proof}

\subsection{Cauchy's Theorem, weak version}

\begin{theorem}[Cauchy's Theorem for triangles]\index{Cauchy's theorem}
  Let \(U\) be a domain and \(T\) be a triangle contained in \(U\). If \(f: U \to \C\) is holomorphic, then
  \[
    \int_{\p T} f(z)dz = 0.
  \]
\end{theorem}

\begin{proof}
  Let \(y = |\int_{\p T} f(z)dz|\), \(\ell = \ell(\p T)\). Let \(T = T^0 = T_1 \cup \dots T_4\) be a subdivision into 4 equal triangles all with the same orientation. Then
  \[
    \int_{\p T} f(z)dz = \sum_{i = 1}^4 \int_{\p T_i} f(z)dz
  \]
  since internal lines cancel in pair. Thus there exists \(i\) such that
  \[
    \left| \int_{\p T_i} f(z)dz \right| \geq \frac{y}{4}.
  \]
  Let \(T^1 = T_i\) for this \(i\) and repeat. We produce a sequence
  \[
    T^0, T^1, \dots
  \]
  such that
  \[
    \left| \int_{\p T^i} f(z)dz \right| \geq \frac{y}{4^i}
  \]
  and
  \[
    \ell(\p T^i) = \frac{\ell}{2^i}.
  \]
  Now as \(T\) is compact, the \(T^i\) are closed nested sets, they have non-empty intersection, i.e.\ there exists
  \[
    z_0 \in \bigcap_{i = 0}^\infty T^i.
  \]
  As \(f\) is differentiable at \(z_0\), given \(\varepsilon > 0\), there exists \(\delta > 0\) such that \(|w - z_0| < \delta\) implies
  \[
    |f(w) - f(z_0) - (w - z_0) f'(z_0)| < \varepsilon |w - z_0|.
  \]
  Pick \(n\) such that \(T^n \subseteq D(z_0, \delta)\). Then
  \begin{align*}
    \frac{y}{4^n} &\leq \left| \int_{\p T^n} f(z)dz \right| \\
                  &= \left| \int_{\p T^n} (f(z) - \underbrace{f(z_0) - (z - z_0)f'(z_0))}_{\text{has anti-derivaative so vanishes}} dz \right| \\
                  &\leq \ell(\p T^n) \varepsilon \sup_{z \in \p T^n} |z - z_0| \\
                  &\leq \frac{\varepsilon \ell^2}{4^n}.
  \end{align*}
  Thus \(y \leq \ell^2 \varepsilon\). Since \(\varepsilon\) is arbitrary, \(y = 0\).
\end{proof}

\begin{corollary}[Convex Cauchy]
  Let \(f\) be a holomorphic function on a star-domain \(U\). Then
  \[
    \int_\gamma f(z)dz = 0
  \]
  for all closed curves in \(U\).
\end{corollary}

\begin{proof}
  By the previous theorem, \(\int_{\p T} f(z)dz = 0\) for all triangles \(T \subseteq U\). By \Cref{cor:anti-derivative}, \(f\) has an anti-derivative \(F\) on \(U\). Then the Fundamental Theorem of Calculus says
  \[
    \int_\gamma f(z)dz = 0
  \]
  for all closed paths \(\gamma\) in \(U\).
\end{proof}

Actually, we can prove the same result even if \(f\) is not assumed to be holomorphic on finitely many points:

\begin{proposition}
  \label{prop:Cauchy with holes}
  Let \(U\) be a star-domain and \(S \subseteq U\) be a finite set. Let \(f: U \to \C\) be continuous on \(U\) and holomorphic on \(U \setminus S\). Then the conclusion of the convex Cauchy theorem stil holds.
\end{proposition}

\begin{proof}
  It suffices to prove that the integral along a triangle is zero for all triangles in \(U\). Subdivide a triangle \(T\) into \(4^n\) equal triangles as before. Let \(M = \sup_T |f|\). Let \(T' \subseteq T\) be a subtriangle. If \(T' \cap S = \emptyset\) then the integral is zero by Cauchy. Otherwise, for any \(T'\),
  \[
    \left| \int_{\p T'} f(z)dz \right| \leq \ell(\p T') M 2^{-n} 
  \]
  so
  \begin{align*}
    \left| \int_{\p T} f(z)dz \right|
    &= \left|\sum_{T'} \int_{\p T'} f(z) dz \right| \\
    &\leq \sum_{T'}\left| \int_{\p T'} f(z)dz \right| \\
    &\leq 6|S|\ell M 2^{-n}
  \end{align*}
  where the last line is because a point can belong to at most \(6\) triangles. Let \(n \to \infty\) gives the result.
\end{proof}

In fact, we will later prove that \(f\) is also holomorphic on \(S\).

\subsection{Cauchy Integral Formula, weak version}

\begin{theorem}[Cauchy integral formula for a disc]\index{Cauchy integral formula}
  Let \(D = D(a, r)\) be a disc and \(f: D \to \C\) holomorphic. For every \(w \in D\) and \(\rho\) with \(|w - a| < \rho < r\),
  \[
    f(w) = \frac{1}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{z - w} dz.
  \]
\end{theorem}

This is a surprising result as the value of a holomorphic inside a disc is completely determined by its value on the boundary.

\begin{proof}
  Consider the function
  \[
    g(z) =
    \begin{cases}
      \frac{f(z) - f(w)}{z - w} & \text{if } z \neq w \\
      f'(w) & \text{if } z = w
    \end{cases}
  \]

Then \(g\) is continuous on \(D\) and holomorphic on \(D \setminus \{w\}\). Thus by the previous result
\[
  \int_{|z - a| = \rho} g(z)dz = 0.
\]
It would be easy if the path is a circle around \(w\) but unfortuntely it isn't. Instead, 
\begin{align}
  \int_{|z - a| = \rho} \frac{f(z)}{z - w} dz
  &= \int_{|z - a| = \rho} \frac{f(w)}{z - w} dz \\
  &= \sum_{n = 0}^\infty \int_{|z - a| = \rho} \frac{f(w)(w - a)^n}{(z - a)^{n + 1}} dz \\
  &= \int_{|z - a| = \rho} \frac{f(w)}{z - a} dz \\
  &= 2\pi i f(w)
\end{align}
where (3) is justified by using the example of \(z^n\) before and (2) is justified by the geometric series
\[
  \frac{1}{z - w}
  = \frac{1}{(z - a)\left( 1- \frac{w - a}{z - a} \right)}
  = \sum_{n = 0}^\infty \frac{(w - a)^n}{(z - a)^{n + 1}}
\]
which converge uniformly as a function of \(z\) on \(|z - a| = \rho\), as well as the following easy lemma:

\begin{lemma}
  If \(f_n: U \to \C\) and \(f: U \to \C\) are continuous and \(\gamma: [a, b] \to U\) is a curve such that \(f_n \to f\) uniformly on \(\gamma([a, b])\), then
  \[
    \int_\gamma f_n(z)dz \to \int_\gamma f(z) dz.
  \]
\end{lemma}

\begin{proof}
  Let \(M_n = \sup_\gamma |f_n - f|\). By uniform convergence \(\lim_{n \to \infty} M_n = 0\). Hence
  \[
    \left| \int_\gamma f_n(z) dz - \int_\gamma f(z) dz \right|
    \leq M_n \ell(\gamma) \to 0
  \]
  as \(n \to \infty\).
\end{proof}
\end{proof}

\begin{corollary}[Mean-value property]\index{Mean-value Property}
  \label{cor:mean-value property}
  If \(f: D(w, R) \to \C\) is holomorphic, then for every \(0 < r < R\),
  \[
    f(w) = \int_0^1 f(w + re^{2\pi it})dt.
  \]
\end{corollary}

\begin{proof}
  Take \(w = a\) in the previous theorem and parameterise the circle of integration as \(\gamma(t) = w + re^{2\pi it}, t \in [0, 1]\).
\end{proof}

\subsection{Application of Cauchy Integration Formula}

\begin{theorem}[Liouville]\index{Liouville's Theorem}
  Every bounded entire function is constant.
\end{theorem}

\begin{proof}
  Suppose \(f: \C \to \C\) is entire such that \(|f| \leq M\) and let \(w \in \C\). Then if \(R > |w|\),
  \begin{align*}
    |f(w) - f(0)|
    &=\frac{1}{2\pi}\left| \int_{|z| = R} f(z) \left( \frac{1}{z - w} - \frac{1}{z} \right) dz \right| \\
    &= \frac{1}{2\pi} \left| \int_{|z| = R} \frac{wf(z)}{z(z - w)} dz \right| \\
    &\leq \frac{1}{2\pi}\frac{2\pi R|w|M}{R(R - |w|)} \\
    &\to 0
  \end{align*}
  as \(R \to \infty\).
\end{proof}

\begin{theorem}[Fundamental Theorem of Algebra]\index{Fundamental Theorem of Algebra}
  Every non-constant polynomials with complex coefficients has a complex root.
\end{theorem}

\begin{proof}
  Let \(p(z) = z^n + c_{n - 1}z^{n - 1} + \dots + c_0\) be a polynomial of degree \(n > 0\). Then \(|p(z)| \to \infty\) as \(z \to \infty\), so there exists \(R > 0\) such that \(|p(z)| > 1\) for all \(|z| > R\).

  Now consider \(f(z) = \frac{1}{p(z)}\). If \(p\) does not have a zero then \(f\) is an entire function. Moreover, since \(f\) is bounded on \(\{z: |z| \leq R\}\) by continuity and \(|f(z)| < 1\) if \(|z| > R\). By Liouville's Theorem \(f\) is constant. Absurd.
\end{proof}

\begin{theorem}[Local maximum modulus principle]\index{local maximum modulus principle}
  Let \(f: D(a, r) \to \C\) be holomorphic. If for every \(z \in D(a, r)\), \(|f(z)| \leq |f(a)|\) then \(f\) is constant.
\end{theorem}

Thus on a open domain \(U\), if the function \(f\) extends analytically to the boundary \(\p U\) then the maximum can only achieved on the boundary \(U\), unless \(f\) is constant.

\begin{proof}
  By \nameref{cor:mean-value property} we have for \(0 < \rho < r\),
  \[
    |f(a)|
    = \left| \int_0^1 f(a + \rho e^{2\pi it}) dt \right|
    \leq \sup_{|z - a| = \rho} |f(z)|
    \leq |f(a)|
  \]
  Hence equality holds, and by \Cref{prop:absolute value integral inequality} \(|f(z)| = |f(a)|\) for all \(z\) on \(|z - a| = \rho\). Since \(\rho\) is arbitrary, \(|f(z)| = |f(a)|\) for all \(z \in D(a, r)\). Thus \(f\) is constant (see example sheet 1).
\end{proof}

\begin{theorem}[Taylor expansion]\index{Taylor expansion}
  \label{thm:Taylor}
  Let \(f: D(a, r) \to \C\) be holomorphic. Then \(f\) has a convergent power series on \(D(a, r)\):
  \[
    f(z) = \sum_{n = 0}^\infty c_n (z - a)^n
  \]
  where
  \[
    c_n = \frac{f^{(n)}(a)}{n!} = \frac{1}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{(z - a)^{n + 1}} dz
  \]
  for any \(0 < \rho < r\).
\end{theorem}

An immediate corollary is that holomorphic functions are analytic. The converse is trivial so the two terms are synonymous semantically, although the choice of terminology may enunciate your standing point: the term ``holomorphic'' is preferred in pure mathematics, while ``analytic'' is used more often in applied mathematics.

\begin{proof}
  If \(|w - a| < \rho < r\) then by Cauchy integral formula
  \begin{align*}
    f(w) &= \frac{1}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{z - w} dz \\
         &= \frac{1}{2\pi i} \int_{|z - a| = \rho} \sum_{n = 0}^\infty \frac{(w - a)^n}{(z - a)^{n + 1}} dz \\
         &= \sum_{n = 0}^\infty \underbrace{\left( \frac{1}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{(z - a)^{n + 1}} dz \right)}_{c_n} (w - a)^n
  \end{align*}
\end{proof}

\begin{corollary}
  If \(f\) is holomorphic in \(U\) then its derivatives of all orders exist and are holomorphic.
\end{corollary}

\begin{proof}
  Taylor expansion plus theory on power series.
\end{proof}

The next theorem is a converse to Cauchy:

\begin{corollary}[Morera]\index{Morera's Theorem}
  Let \(U\) be a domain and \(f: U \to \C\) continuous. If \(\int_\gamma f(z) dz = 0\) for every closed paths in \(U\), then \(f\) is holomorphic in \(U\).
\end{corollary}

\begin{proof}
  By \Cref{prop:existence of anti-derivative}, \(f\) has an anti-derivative \(F\). \(F\) is holomorphic and \(F' = f\) so \(f\) is holomorphic on \(U\).
\end{proof}

This gives us something we promised a while ago in \Cref{prop:Cauchy with holes}: we see that \(f\) ends up being holomorphic also on \(S\).

\begin{proposition}[Cauchy integral formula for derivatives]\index{Cauchy integral formula!derivatives}
  Use the same notation as in \nameref{thm:Taylor}, we have
  \[
    f^{(n)}(w) = \frac{n!}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{(z - w)^{n + 1}} dz.
  \]
\end{proposition}

\begin{proof}
\[
  \frac{d}{dz} \left( \frac{f(z)}{z - w} \right)
  = \frac{f'(z)}{z - w} - \frac{f(z)}{(z - w)^2}
\]
Now integrate over \(|z - a| = \rho\), since anti-derivative of \(\frac{d}{dz} \frac{f(z)}{z - w}\) exists,
\[
  0 = \int_{|z - a| = \rho}  \frac{d}{dz} \left( \frac{f(z)}{z - w} \right)dz
  = \int_{|z - a| = \rho} \frac{f'(z)}{z - w} dz - \int_{|z - a| = \rho} \frac{f(z)}{(z - w)^2} dz
\]
Now apply Cauchy integral formula to the first term. Inductively, we derive
\[
  f^{(n)}(w) = \frac{n!}{2\pi i} \int_{|z - a| = \rho} \frac{f(z)}{(z - w)^{n + 1}} dz.
\]
\end{proof}

Note the subtlety between this and Taylor's theorem: Taylor's theorem gives us the coefficient of the power series expansion around \(z\) (which holds trivially at \(z\)) while Cauchy integral formula tells us the value of derivatives of any order at a point in the disc.

\subsection{Uniform limits of holomorphic functions}

We want to construct new holomorphic functions from old ones. Recall in IB Analysis II uniform limit theorem tells us that the uniform limit of continuous functions is continuous. We are going to adopt the same idea except one catch: continuity is a local property so if we can produce an cover on each element of which a given sequence of functions converges uniformly, then the resulting function by patching everything together is continuous on the entire space. This is a weaker requirement than uniform convergence and indeed sometimes this is the best that we can do, illustrated by the example below.

\begin{definition}[Locally uniform convergence]\index{locally uniform convergence}
  Let \(U\) be an open domain and \(f_n: U \to \C\) be a sequence of functions. We say that \(\{f_n\}\) is \emph{locally uniformly convergent} in \(U\) if for any \(a \in U\) there exists \(r > 0\) such that \(D(a, r) \subseteq U\) on which \(\{f_n\}\) is uniformly convergent.
\end{definition}

\begin{eg}
  Let \(U = D(0, 1)\) and \(f_n(z) = \frac{1}{1 - z^n}\). Note that \(f_n \to 1\) pointwise as \(n \to \infty\). It is not uniformly convergent on \(D(0, 1)\) but it is locally uniformly convergent. In fact it is uniformly convergent on any \(|z| \leq \rho < 1\).
\end{eg}




\printindex

\iffalse
past lecture notes:
T. Scholl, K. Carne

Book
Ahlfors, Complex Analysis
\fi

\end{document}
