\documentclass[a4paper]{article}

\def\npart{IV}

\def\ntitle{Geometric Group Theory}
\def\nlecturer{A.\ Khukhro}

\def\nterm{Lent}
\def\nyear{2020}

\input{header}

\DeclareMathOperator{\rk}{rk} % rank
\DeclareMathOperator{\Cay}{Cay} % Cayley graph
\DeclareMathOperator{\Ends}{Ends} % Ends
\DeclareMathOperator{\QI}{QI} % quasi-isometry group

\begin{document}

\input{titlepage}

\tableofcontents

\setcounter{section}{-1}

\section{Introduction}

Contents:
\begin{enumerate}
\item free groups: ``universal property'', study subgroups using topology,
\item group presentations and constructions, ways of making new groups from old,
\item Cayley graphs, viewing groups geometrically (e.g.\ \(\Z\)), connections to group actions,
\item geometric properties of groups, growth, other geometric invariants, ``dictionary'' between algebra and geometry,
\item amenable groups.
\end{enumerate}

\section{Free groups}

Let \(S\) be a set, called an \emph{alphabet}\index{alphabet}, and let \(S^{-1}\) be the set of formal inverses of elements in \(S\), i.e.\ \(S^{-1} = \{s^{-1}: s \in S\}\). A \emph{word}\index{word} in the alphabet \(S\) is a finite sequence of elements in \(S \cup S^{-1}\) and the empty word. A word is \emph{reduced}\index{word!reduced} if it does not contain occurrences of \(ss^{-1}, s^{-1}s\). Given a word, we can reduce it by removing any such subwords. For example if \(S = \{a, b, c\}\), \(aa^{-1}bcb^{-1}bc^{-1}\) is a word and we can reduce it to \(bcc^{-1}\), and further to \(b\). This induces an equivalence relation such that there is a unique reduced word in each class. We also write \(s^2\) for \(ss\).

\begin{definition}[free group]\index{free group}
  The \emph{free group} on the set \(S\), denoted \(F(S)\), is the set of reduced words in \(S\), with the operation of concatenation (followed by reduction if necessary).
\end{definition}

Free groups satisfies the universal property

\begin{theorem}
  Given a free group \(F(S)\) with an inclusion \(\iota: S \to F(S)\), whenever \(G\) is a group with a function \(\varphi: S \to G\), there is a unique group homomorphism \(\overline \varphi: F(S) \to G\) such that the following diagram commutes
  \[
    \begin{tikzcd}
      S \ar[r, "\iota"] \ar[dr, "\varphi"] & F(S) \ar[d, "\overline \varphi"] \\
      & G
    \end{tikzcd}
  \]
\end{theorem}

\begin{proof}
  Given \(\varphi: S \to G\), define \(\overline \varphi: F(S) \to G\) by \(\overline \varphi(s_{i_1}^{\alpha_1} \cdots s_{i_n}^{\alpha_n}) = \varphi(s_{i_1})^{\alpha_1} \cdots \varphi(s_{i_n})^{\alpha_n}\). Check this is a homomorphism.
\end{proof}

\begin{definition}[rank]\index{rank}
  The cardinality of \(S\) is the \emph{rank} of \(F(S)\), denoted by \(\operatorname{rk}(F(S))\).
\end{definition}

\begin{corollary}
  If \(|S| = |T|\) the \(F(S) \cong F(T)\).
\end{corollary}

\begin{proof}
  If \(|S| = |T|\) then there exists a bijection \(\phi: S \to T\). Consider
  \[
    \begin{tikzcd}
      S \ar[r] \ar[dr, "\theta"] & F(S) \ar[d, dotted, "\overline \theta"] \\
      & F(S)
\end{tikzcd}
  \]
  where \(\overline \theta\) is a homomorphism by the universal property. Similarly we have \(\overline{\theta^{-1}}: F(T) \to F(S)\) and \(\overline{\theta^{-1}} \compose \overline \theta: F(S) \to F(S)\) extends the identity map \(S \to F(S)\) so must be the identity on \(F(S)\). Same for the other way so \(\overline \theta\) is an isomorphism.
\end{proof}

\begin{notation}
  Write \(F_n\) for the isomorphism class of \(F(S)\) with \(|S| = n\).
\end{notation}

\begin{ex}
  If \(F_n \cong F_m\) then \(n = m\).
\end{ex}

\begin{corollary}
  Every group is a quotient of a free group.
\end{corollary}

\begin{proof}
  Given \(G\), consider \(F(G)\). By the universal property exists a homomorphism \(\pi: F(G) \to G\) extending the identity, so must be surjective.
\end{proof}

\begin{definition}
  Let \(G\) be a group, \(A \subseteq G\) a subset. Define \(\langle A\rangle\) to be the intersection of all subgroups containing \(A\), i.e.\ the unique smallest subgroup containing \(A\).We also call it the subgroup generated by \(A\).
\end{definition}

\begin{definition}
  \(G\) is \emph{generated} by \(A \subseteq G\) if \(\langle A \rangle = G\). Then \(A\) is a \emph{generating set} of \(G\). \(G\) is \emph{finitely generated} if exists a finite generating set of \(G\).
\end{definition}

\begin{notation}
  Write \(\langle a_1, \dots, a_n \rangle\) to mean \(\langle \{a_1, \dots, a_n\} \rangle\).
\end{notation}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(\Z_n, \Z\) can be generated by one element.
  \item \(\Z^n\) can be generated by \(\geq n\) elements.
  \item \(F_2 = \langle a, b \rangle = \langle a, ab \rangle\) so generating sets are not unique.
  \end{enumerate}
\end{eg}

\begin{definition}
  A group \(F\) is \emph{freely generated} by \(S \subseteq F\) if for any group \(G\) and any map \(\varphi: S \to G\), exists a unique homomorphism \(\tilde \varphi: F \to G\) extending \(\varphi\).
\end{definition}

\begin{lemma}
  If \(F\) is freely generated by \(S\) then \(F\) is generated by \(S\).
\end{lemma}

\subsection{Subgroups of free groups}

Let's see some examples of subgroups of free groups.

\begin{itemize}
\item Given any \(e \ne w \in F_n\), \(\langle w \rangle \cong \Z\).
\item Given \(T \subseteq S\), \(\langle T \rangle\) is a free subgroup of \(F(S)\) of rank \(|T|\).
\item If \(S = \{a, b\}\), the set \(\{a^{-n} ba^n: n \in \N\}\) freely generates a subgroup of \(F_2\), so isomorphic to \(F_\infty\) (exercise).
\end{itemize}

\begin{remark}
  Subgroups of finitely generated groups are not necessarily finitely generated.
\end{remark}

Revision of fundamental groups. See IID Algebraic Topology. Particularly relevant to this course is \(\pi_1(\bigvee_{i = 1}^n S^1) = F_n\), and a connected loop-free graph is contractible so has trivial \(\pi_1\).

It is the fact that if \(X\) is sufficiently nice and \(Y \subseteq X\) is closed simply connected, then collapsing \(Y\) to a piont does not alter \(\pi_1(X)\). In particular, for graphs we can collapsing \(T\), a maximal spanning tree, to get a bouquet of circles. Since maximal spanning tree always exists (use axiom of choice if the graph is infinite), \(\pi_1\) of a graph is a free group of rank equal to the number edges not in the maximal spanning tree.

Recall the Galois correspondence between subgroups of \(\pi_1(X)\) and covering spaces: we have a bijection between covering maps \(p: (\tilde X, \tilde x_0) \to (X, x_0)\) and subgroups of \(\pi_1(X, x_0)\).

Thus let \(X = \bigvee_{i = 1}^n S^1\). For any \(H \leq \pi_1(X) \cong F_n\), there is a covering space \(\overline X\) with \(\pi_1(\overline X) \cong H\). Since \(\overline X\), being a cover of a graph, is a graph, we have \(H\) is free. This shows that every subgroup of a free group is free.

We work out the rank of \(H\) given its index in \(F_n\). The index of \(H\) in \(F_n\) is exactly the degree of the covering map \(\overline X \to X\), i.e.\ the number of vertices of \(\overline X\). Each vertex of \(\overline X\) has degree \(2n\) so the number of edges in \(\overline X\) is \([F_n: H] \cdot 2n \cdot \frac{1}{2} = [F_n : H] \cdot n\). To work out the number of edges not in a maximal spanning tree, use the graph theoretic fact that a tree on \(n\) vertices has exactly \(n - 1\) edges (exercise), so the number of edges not in a maximal spanning tree is
\[
  [F_n: H] \cdot n - [F_n : H] - 1 = (n - 1) [F_n : H] + 1.
\]

\begin{theorem}[Nielsen-Schreier]\index{Nielsen-Schreier formula}
  Every subgroup of a free group is free and if the subgroup has finite index then
  \[
    \rk(H) = [F_n: H] (\rk(F_n) - 1) + 1.
  \]
\end{theorem}
Mnemonic:
\[
  \rk(H) - 1 = (\rk(F_n) - 1) [F_n : H].
\]

\begin{eg}
  A degree \(2\) cover of \(S^1 \vee S^1\) realises \(F_3\) as a subgroup of index \(2\) in \(F_2\).
\end{eg}

The group of \emph{covering transformation}, or \emph{deck transformation} of a cover is the group of isomorphisms \(\overline X \to \overline X\).

A cover is \emph{normal}\index{normal cover} if for any two lifts of the basepoint \(x_0 \in X\), there is a covering transformation of \(\overline X\) sending one to the other.

Normal covering spaces correspond to normal subgroups of \(\pi_1(X)\). If the cover is normal then the group of covering transformations is isomorphic to \(\pi_1(X)\) quotiented by the corresponding subgroup.

\begin{eg}
  In the previous example we have \(F_3 \normal F_2\). We can have a nonnormal index 3, and a normal one.
\end{eg}

\section{Group presentations and constructions}

\begin{definition}[normal closure]\index{normal closure}
  The \emph{normal closure} of a subset \(A \subseteq G\), denoted \(\langle\langle A\rangle\rangle\), is the unique smallest normal subgroup of \(G\) containing \(A\).
\end{definition}

Given a free group \(F(S)\) and \(R \subseteq F(S)\), we write \(\langle S|R \rangle\) for the group \(F(S)/\langle\langle R\rangle\rangle\). \(R\) and \(S\) are called \emph{generators} and \emph{relators} respectively.

\begin{definition}[group presentation]\index{group presentation}
  A \emph{presentation} of a group \(G\) is an isomorphism of \(G\) with a group of the form \(\langle S|R \rangle\).

  \(G\) is \emph{finitely presented} if it admits a presentation \(\langle S|R \rangle\) with \(S, R\) finite.
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item If \(R = \emptyset\) then \(\langle S|R \rangle \cong F(S)\).
  \item \(\langle a|a^n \rangle \cong \Z_n\).
  \item \(\langle a, b|aba^{-1}b^{-1}\rangle\) is a presentation of \(\Z^2\): let \(\Z^2 = \{(c^n, d^m): n, m \in \Z\}\). We have a homomorphism
    \begin{align*}
      \varphi: F(a, b) &\to \Z^2 \\
      a &\mapsto c \\
      b &\mapsto d
    \end{align*}
    Need to show \(\ker \varphi = \langle\langle aba^{-1}b^{-1} \rangle\rangle\). \(\supseteq\) is clear since \(\Z^2\) is abelian so have \(F(a, b)/\langle\langle aba^{-1}b^{-1} \rangle\rangle \surj F(a, b)/\ker \varphi\). The domain is a 2-generated abelian group. But the only 2-generated abelian group that surjects onto \(\Z^2\) is itself.
  \item More generally a finitely generated abelian group is always finitely presented.
  \item The same is true for nilpotent groups. Recall that \(G\) is \emph{nilpotent}\index{nilpotent} if the \emph{lower central series}\index{lower central series} of \(G\) terminates in a finite number of steps. The lower central series of \(G\) is
    \[
      G_0 = G, G_{i + 1} = [G_i, G].
    \]
  \item \(\langle a, b| aba^{-1}b^{-2}, a^{-2}b^{-1}ab \rangle = \{1\}\).
  \end{enumerate}
\end{eg}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item It is difficult to tell which group is given by a particular presentation. Indeed there does not exist an algorithm that, upon input of a presentation, can determine whether the corresponding group is trivial. The is the \emph{word problem}, introduced by Dehn in early 20th century. The classes of groups for which it does have a solution are often geometry.
  \item There are uncountably many isomorphism classes of finitely generated groups (even 2-generated). For reference, see de la Harpe \emph{Geometric Group Theory} IIIB. But there are only countably many isomorphism classes of finitely presented groups.
  \end{enumerate}
\end{remark}

The notion of finite presentation makes sense without fixing a pecific surjection of a free group.

\begin{theorem}
  Given a not necessarily finite presentation \(\langle (s_j)_{j \in J} | (r_i)|_{r \in I} \rangle\) of a finitely presented group \(G\), there exists a finite subset \(J_0 \subseteq J\) and a finite set \((\tilde r_i)_{i \in I_0}\) of elements of the free group \(F((s_j)_{j \in J_0})\) such that \(\langle (s_j)_{j \in J_0} | (\tilde r_i)_{i \in I_0} \rangle\) is a finite presentation of \(G\).
\end{theorem}

\begin{proof}[``Proof'']
  de la Harpe has a proof but it seems to be wrong.
\end{proof}

Our aim is to prove that finite index subgroups of finitely generated (resp finitely presented) groups are finitely generated (resp finitely presented).

\begin{definition}[Schreier transversal]\index{Schreier transversal}
  Let \(F(S)\) be a free group and \(H \leq F(S)\) a subgroup. A (right) \emph{Schreier transversal} for \(H\) in \(F(S)\) is a set \(J\) of reduced words such that each right coset of \(H\) in \(G\) contains exactly one word of \(J\), called a \emph{representative} of this class, and all initial segments of these words are also in \(J\).

  For \(g \in F(S)\), denote by \(\overline g\) the element of \(J\) such that \(Hg = H \overline g\).
\end{definition}

\begin{theorem}
  For any \(H \leq F(S)\), there a Schreier transversal \(J\). Moreover \(H\) is freely generated by the set
  \[
    \{ts(\overline{ts})^{-1}: t \in J, s \in S \text{ and } ts(\overline{ts})^{-1} \ne 1\}.
  \]
\end{theorem}

\begin{proof}
  Take \(X = \bigvee_S S^1\) so \(\pi_1X = F(S)\). Take \(\overline X\) to be the cover corresponding to \(H \leq F(S)\). The vertices of \(\overline X\) correspond to cosets of \(H\) in \(F(S)\) and choosing a path from a fixed basepoint to a vertex gives us a coset representative for that coset. Pick a maximal spanning tree \(T \subseteq \overline X\). Choosing the unique path to each vertex in \(T\) gives us coset representatives with initial segments that are also such paths. Since \(H \cong \pi_1\overline X\) and it is freely generated by the set of loops with exactly one edge not in \(T\), this generating set is of the required form.
\end{proof}

\begin{remark}
  The argument also shows that the set of Schreier transversals for \(H\) in \(F(S)\) is in bijection with the set of maximal spanning trees in \(\overline X\).
\end{remark}

Write \(\gamma(t, s) = ts(\overline{ts})^{-1}\). Explicitly, given \(h \in H\) written as \(s_1s_2 \cdots s_n\) where \(s_i \in S \cup S^{-1}\), we can write
\[
  h = \gamma(1, s_1) \gamma(\overline s_1, s_2) \cdots \gamma(\overline{s_1 \cdots s_{i - 1}}, s_i) \cdots \gamma(\overline{s_1 \cdots s_{n - 1}}, s_n)
\]
(use \(\gamma(t, s^{-1}) = \gamma(\overline{ts^{-1}}, s)^{-1}\)).
This is the \emph{Reidemeister-Schreier rewriting process}\index{Reidemeister-Schreier rewriting process}.

\begin{theorem}
  Let \(G\) be a group with presentation \(\langle S| R\rangle\) and let \(\varphi: F(S) \to G\) correspond to this presentation. Let \(G_1 \leq G\) and let \(H\) be the subgroup of \(F(S)\) containing \(\ker \varphi\) such that \(\varphi(H) = G_1\). Then \(G_1\) has presentation
  \[
    \langle \gamma(t, s): t \in J, s \in S, \gamma(t, s) \ne 1| trt^{-1}: t \in J, r \in R \rangle
  \]
  where \(J\) is a Schreier transversal for \(H\) in \(F(S)\).
\end{theorem}

\begin{proof}
  Have \(G_1 = H/\langle\langle R\rangle\rangle^{F(S)}\) and would like to find some possibly larger set of words \(R'\) in \(H\) such that \(G_1 = H/\langle\langle R' \rangle\rangle^H\). Let \(H\) be generated freely by \(\gamma(t, s)\)'s. The subgroup \(\langle\langle R\rangle\rangle^{F(S)}\) is generated by \(\{grg^{-1}: g \in F(S), r \in R\}\), and writing each \(g\) as \(g = h_g \overline g\) where \(h_g \in H, \overline g \in J\), we have
  \[
    grg^{-1}
    = (h_g \overline g) r (h_g \overline g)^{-1}
    = h_g (\overline g r \overline g^{-1}) h_g^{-1}
  \]
  and so can take \(R' = \{trt^{-1}: t \in J, r \in R\}\). Thus \(G_1\) has the required presentation.
\end{proof}

\begin{corollary}
  Any subgroup of finite index in a finitely generated (resp. finitely presented) group is itself finitely generated (resp. finitely generated).
\end{corollary}

\begin{proof}
  If \([G: G_1] < \infty\) then \([F(S): H] < \infty\) so \(J\) is finite.
\end{proof}

\subsection{Free product}

One way to create new finitely generated/presented groups from old one is via free products. Given two groups \(A, B\), a \emph{normal form}\index{normal form} is an expression of the form \(g_1g_2 \cdots g_n\) where \(n \geq 0\) such that if \(n = 0\), take the identity element, \(g_i \in (A \setminus \{1\}) \amalg (B \setminus \{1\})\) and consecutive elements \(g_i, g_{i + 1}\) do not lie in the same group. \(n\) is the \emph{length of normal form}. We define multiplication of normal forms inductively by
\begin{itemize}
\item \((g_1 \cdots g_n) \cdot 1 = 1 \cdot (g_1 \cdots g_n) = g_1 \cdots g_n\).
\item For \(n, m \geq 1\), set
  \[
    (g_1 \cdots g_n)(h_1 \cdots h_m) =
    \begin{cases}
      g_1 \cdots g_nh_1 \cdots h_m & \text{if \(g_n, h_1\) in different groups} \\
      g_1 \cdots g_{n - 1}kh_2 \cdots h_m & \text{if \(g_n, h_1\) in same group, \(g_nh_1 = k \ne 1\)} \\
      (g_1 \cdots g_{n - 1})(h_2 \cdots h_m) & \text{if \(g_n, h_1\) in same group, \(g_nh_1 = 1\)}
    \end{cases}
  \]
\end{itemize}

\begin{definition}[free product]\index{free product}
  The set of normal forms with this multiplication forms a group \(A * B\), called the \emph{free product} of \(A\) and \(B\).
\end{definition}

\begin{remark}\leavevmode
  \begin{enumerate}
  \item The groups \(A, B\) embed naturally into \(A * B\).
  \item If \(A, B \leq G\) such that any \(g \ne 1\) in \(G\) can be represented in a unique way as a product \(g = g_1 \cdots g_n\) with \(g_i \in A \cup B \setminus \{1\}\) and consecutive \(g_i, g_{i + 1}\) not in the same group, then \(G = A * B\).
  \end{enumerate}
\end{remark}

\begin{theorem}
  If \(A = \langle S_A|R_A \rangle, B = \langle S_B|R_B \rangle\) and \(S_A \cap S_B = \emptyset\) then
  \[
    A * B = \langle S_A \cup S_B| R_A \cup R_B \rangle.
  \]
\end{theorem}

\begin{proof}
  Let \(\varphi: F(S_A) \to A, \psi: F(S_B) \to B\) be the homomorphisms with \(\ker \varphi = \langle\langle R_A \rangle\rangle^{F(S_A)}, \ker \psi = \langle\langle R_B \rangle\rangle^{F(S_B)}\). Let \(\theta: F(S_A \cup S_B) \to A * B\) be the homomorphism coinciding with \(\varphi\) on \(S_A\) and \(\psi\) on \(S_B\). Need to show \(\ker \theta = \langle\langle R_A \cup R_B \rangle\rangle^{F(S_A \cup S_B)}\). \(\supseteq\) is trivial. For \(\subseteq\), consider \(g = g_1 \cdots g_n \in \ker \theta\) in normal form (using \(F(S_A \cup S_B) = F(S_A) * F(S_B)\)). Then
  \[
    \theta(g) = \theta(g_1) \cdots \theta(g_n) = 1
  \]
  in \(A * B\). Thus exists \(i\) such that \(\theta(g_i) = 1\), so \(g_i \in \ker \varphi\) or \(g_i \in \ker \psi\). Proceed by induction.
\end{proof}

\begin{eg}
  \(D_\infty = \langle a, b| a^2 = 1, a^{-1}ba = b^{-1} \rangle\). It is the automorphism group of the graph \(C_\infty\), where \(a\) is a reflection (say about the origin) and \(b\) is a translation. Then \(D_\infty\) is generated by \(a\) and \(c = ba\), both have order \(2\). Can check (by acting on \(C_\infty\)'s vertices and edges) that \((ca)^n, (ca)^n c, a(ca)^n c, a (ca)^n\) give different elements of \(D_\infty\). By remark above
  \[
    D_\infty
    = \langle a, c| a^2, c^2\rangle
    = \langle a|a^2 \rangle * \langle c|c^2 \rangle
    = \Z_2 * \Z_2
  \]
\end{eg}

\begin{remark}
  \(\Z_2 * \Z_2\) is the only free product of non-trivial groups that does not contain a non-abelian free group. For example \(\Z_2 * \Z_3 \supseteq [\Z_2, \Z_3] \cong F_2\).
\end{remark}

\subsection{Group actions}

\begin{theorem}[ping-pong lemma]\index{ping-pong lemma}
  Let \(G\) act on \(X\). Let \(H_1, H_2 \leq G\) such that \(|H_1| \geq 3, |H_2| \geq 2\) and let \(H = \langle H_1, H_2 \rangle\). Suppose there exists nonempty \(X_1, X_2 \subseteq X\) with \(X_2 \nsubseteq X_1\) such that
  \begin{align*}
    h(X_2) &\subseteq X_1 \text{ for all } h \in H_1 \setminus \{e\} \\
    h(X_1) &\subseteq X_2 \text{ for all } h \in H_2 \setminus \{e\}
  \end{align*}
  then \(H \cong H_1 * H_2\).
\end{theorem}

\begin{proof}
  Let \(w\) be a nonempty reduced word in the alphabet \(H_1\setminus\{e\} \amalg H_2 \setminus \{e\}\). Need to show that the element defined by \(w\) in \(G\) is not \(e\). Cases:
  \begin{itemize}
  \item if \(w = a_1b_1 a_2b_2 \cdots a_k\) with \(a_i \in H_1 \setminus \{e\}, b_i \in H_2 \setminus \{e\}\), then
    \[
      w(X_2) = a_1b_1 \cdots a_k(X_2) \subseteq a_1b_1 \cdots b_{k - 1}(X_1)
      \subseteq \cdots \subseteq a_1(X_2) \subseteq X_1.
    \]
    As \(X_2 \nsubseteq X_1\), \(w \ne e\) in \(G\).
  \item if \(w = b_1a_2b_2 \cdots b_k\), then let \(a \in H_1 \setminus \{e\}\) we have \(a^{-1}wa \ne e\) by above.
  \item if \(w = a_1b_1 \cdots a_kb_k\) take \(a \in H_1 \setminus \{e, a_1\}\) and \(a^{-1}wa \ne e\).
  \item if \(w = b_1a_2 \cdots a_k\), take \(a \in H_1 \setminus \{e, a_k\}\) and use \(awa^{-1}\).
  \end{itemize}
\end{proof}

\begin{eg}
  Let \(\SL_2(\Z)\) act on \(\R^2\) in the usual way. Consider
  \begin{align*}
    H_1 &= \{
          \begin{pmatrix}
            1 & 0 \\
            2n & 1
          \end{pmatrix}
                 : n \in \Z \}
                 = \langle
                 \begin{pmatrix}
                   1 & 0 \\
                   2 & 1
                 \end{pmatrix}
                       \rangle
                       \cong \Z \\
    H_2 &= \{
          \begin{pmatrix}
            1 & 2n \\
            0 & 1
          \end{pmatrix}
                : n \in \Z\}
                = \langle
                \begin{pmatrix}
                  1 & 2 \\
                  0 & 1
                \end{pmatrix}
                      \rangle
                      \cong \Z
  \end{align*}
  and
  \begin{align*}
    X_1 &= \{
        \begin{pmatrix}
          x \\
          y
        \end{pmatrix}
    : |x| < |y|\} \\
    X_2 & = \{
          \begin{pmatrix}
            x \\
            y
          \end{pmatrix}
    : |x| > |y|\}
  \end{align*}
  If \(|x| > |y|\) then
  \[
    |2nx + y| \geq |2n| \cdot |x| - |y| \geq 2 |x| - |y| > |x|
  \]
  so the two subgroups map the subsets into each other. Thus by ping-pong lemma
  \[
    \langle H_1, H_2 \rangle \cong F_2 \leq \SL_2(\Z).
  \]
  Check this subgroup has finite index.
\end{eg}

\paragraph{Amalgamated free product}

Suppose \(A \leq G, B \leq H\) and there is an isomorphism \(\varphi: A \to B\). Then the \emph{free product of \(G\) and \(H\) with amalgamation \(A\) and \(B\) (via \(\varphi\))}\index{free product with amalgamation} is
\[
  G *_A H = G * H/ \langle\langle \varphi(a)a^{-1}: a \in A \rangle\rangle.
\]

The intuition is to glue \(G\) and \(H\) along \(A\). \(G, H\) embed as subgroups and elements in \(G *_A H\) admits normal forms. It is related to Seifert-van Kampen theorem.

\begin{eg}
  \(\SL_2(\Z) = \Z_4 *_{\Z_2} \Z_6\), see de la Harpe.
\end{eg}

\subsection{HNN extension}

Suppose \(A, B \leq G\), \(\varphi: A \to B\) is an isomorphism. We want \(A\) and \(B\) to be isomorphic via conjugation, but it might not be the case in \(G\) so we extend \(G\) to a larger group. The \emph{HNN extension}\index{HNN extension} of \(G\) (with \(A, B, \varphi\)) is
\[
  G *_\varphi = G * \langle t \rangle / \langle\langle t^{-1}at\varphi(a)^{-1}: a \in A \rangle\rangle.
\]

\(G\) embed in \(G *_\varphi\) and its elements admit normal forms. It has application to calculation of fundamental groups of surface bundles.

\subsection{Semidirect product}

\(G\) is the \emph{semidirect product of \(N\) by \(H\)}\index{semidirect product} of \(N \normal G, H \leq G\), \(N \cap H = \{e\}\) and \(G = NH\). Write \(N \rtimes H = G\). Equivalently, if \(H \leq G\) and exists a homomorphism \(\varphi: G \to H\) (such that the inclusion is a section) such that \(\ker \varphi = N\), then \(G = N \rtimes H\), i.e.\ the short exact sequence of groups
\[
  \begin{tikzcd}
    1 \ar[r] & N \ar[r] & G \ar[r] & H \ar[r] & 1
  \end{tikzcd}
\]
splits.

Alternatively, given two groups \(H\) and \(N\) and a homomorphism \(\alpha: H \to \aut(N)\), we can construct \(G = N \rtimes_\alpha H\) as follow: as a set \(G = N \times H\). The multiplication is defined by
\[
  (n_1, h_1) (n_2, h_2) = (n_1 \alpha(h_1)(n_2), h_1h_2).
\]
The subgroups \(N \times \{e\}, \{e\} \times H\) satisfiy the conditions above. Conversely, given subgroups \(N\) and \(H\), we can recover \(\alpha: H \to \aut(N), \alpha(h)(n) = hnh^{-1}\).

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Direct product \(H \times H\).
  \item \(D_{2n} \cong \Z_n \rtimes \Z_2\).
  \item \(\pi_1(\text{Klein bottle}) \cong \Z \rtimes \Z\) where the action is the only nontrivial automorphism.
  \end{enumerate}
\end{eg}

More generally, a \emph{group extension}\index{group extension} is a group \(G\) given by
\[
  \begin{tikzcd}
    1 \ar[r] & N \ar[r] & G \ar[r] & H \ar[r] & 0
  \end{tikzcd}
\]
We say \(G\) is the \emph{extension of \(N\) by \(H\)}.

\begin{note}\leavevmode
  \begin{enumerate}
  \item If \(H\) is free then \(G\) splits.
  \item Not all extensions split: \(2\Z \to \Z \to \Z_2\).
  \end{enumerate}
\end{note}

\subsection{Wreath product}

\begin{definition}[wreath product]\index{wreath product}
    The \emph{wreath product} of \(G\) and \(H\), \(G \wr H\), is \(\bigoplus_H G \rtimes H\) where, thinking of \(\bigoplus_H G\) as the set of finitely supported function \(H \to G\), the action of \(H\) is given by
    \[
      h(f)(h_1) = f(h^{-1}h_1).
    \]
\end{definition}

\begin{eg}
  Lamplight group\index{lamplight group} \(\Z_2 \wr \Z\), which is not finitely presented. An element \(f \in \bigoplus_\Z \Z_2\) is a function \(\Z \to 0, 1\) with compact support and the action of \(\Z\) is shifting.
\end{eg}

\begin{theorem}[Kaloujnine-Krasner]
  If \(D\) is a group and \(Q\) is a finite group then \(D \wr Q\) contains an isomorphic copy of every extension of \(D\) by \(Q\).
\end{theorem}

\begin{proof}
  If \(G\) is an extension of \(D\) by \(Q\) then let \(\pi: G \to Q\) where \(\ker \pi = D\). We are going to define \(\varphi: G \to D \wr Q\) and show its an injective homomorphism. Choose transversal for \(D\) in \(G\), writing it as a map \(T: Q \to G\). For \(a \in G\), define \(f_a: Q \to D\) by
  \[
    f_a(x) = T(x)^{-1}a T(\pi(a^{-1}) x)
  \]
  and define \(\varphi(a) = (f_a, \pi(a))\). To show this is a homomorphism, if \(a, b \in G\) then
  \begin{align*}
    (f_a \cdot \pi(a)f_b)(x)
    &= f_a(x) f_b(\pi(a)^{-1}x) \\
    &= T(x)^{-1} a \underbrace{T(\pi(a^{-1})x) \cdot T(\pi(a)^{-1}x)^{-1}}_{= e} b T(\pi(b^{-1}) \pi(a)^{-1} x) \\
    &= T(x)^{-1} ab T(\pi((ab)^{-1}) x) \\
    &= f_{ab}(x)
  \end{align*}

  For injectivity, suppose \(a \in \ker \varphi\) then \(\pi(a) = e\) so \(a \in D\) and \(e = f_a(x) = T(x)^{-1}aT(x)\) so \(a = e\).
\end{proof}

\begin{remark}
  The proof works verbatim for not necessarily finite groups \(G\) and \(H\) by using \(\prod_H G \rtimes H\).
\end{remark}

\subsection{Sketch of Bass-Serre theory}

Reference: J-P.\ Serre, Trees.

\begin{theorem}
  Let \(G = G_1 *_A G_2\). Then \(G\) acts without inversion of edges on a tree \(X\) such that the quotient graph \(G \backslash X\) is a segment. Moreoever this segment can be lifted to one in \(X\) such that the stabilisers of its vertices are \(G_1, G_2\) and stabiliser of the edge is \(A\).
\end{theorem}

\begin{proof}[Sketch proof]
  Let \(X^0 = G/G_1 \amalg G/G_2\) and the positively oriented edges \(X_+^1 = G/A\). It is well-defined since \(A = G_1 \cap G_2\). Check \(G\) acts on \(X\) via left multiplication.

  \(X\) is connected: suffices to show \(gG_1\) is connected to \(G_1\). Express \(g\) as \(g_1g_2 \cdots g_n\) with \(g_i \in G_1 \amalg G_2\) and no consecutive elements in the same \(G_i\). Suppose \(g_n \in G_2\), then \(gG_2 = g_1\cdots g_{n - 1}G_2\). Proceed by induction.

  Acyclicity follows from the uniqueness of normal form for almagmated free product.
\end{proof}

Serre gave a converse to the statement: if exists such an action then the group is an amalgmated product.

\begin{table}[h]
  \centering
  \begin{tabular}{p{5cm}|p{5cm}}
    group \(G\) & \(G\) acting on a graph without inversion of edges \\ \hline
    \(G_1 *_A G_2\) & \(G \backslash X\) segment \\ \hline
    \(G = H *_\varphi\) & \(G \backslash X\) loop \\ \hline
    fundamental group of a graph of groups \(\pi_1(G, Y)\) & \(G \backslash X = Y\) a graph
  \end{tabular}
  \caption{Correspondence}
\end{table}

Conseuquence: Kurosh subgroup theorem: if \(G = A * B\) then \(H \leq G\) has the form \(H = F(S) * (* \text{conjugate of subgroups of A} * ()\)

\section{Cayley graphs}

We'll focus on finitely generated groups.

\begin{definition}[Cayley graph]\index{Cayley graph}
  Let \(G = \langle S\rangle\), \(S \subseteq G\) finite. The \emph{Cayley graph} of \(G\) with respect to \(S\) \((\Cay(G, S))\) is given by
  \begin{align*}
    V(\Cay(G, S)) &= G \\
    E((\Cay(G, S)) &= \{(g, gs): g \in G, s \in S\}.
  \end{align*}
\end{definition}

\begin{eg}\leavevmode
  \begin{itemize}
  \item \(\Z^2, S = \{(1, 0), (0, 1)\}\). Grid
  \item In fact we don't have to require \(S\) generating \(G\). \(\Z^2, S = \{(1, 0)\}\). Parallel lines.
  \end{itemize}
\end{eg}

The Cayley graph has the following properties:
\begin{enumerate}
\item \(\Cay(G, S)\) is a \(2|S|\)-regular graph.
\item \(\Cay(G, S)\) is connected if and only if \(\langle S\rangle = G\).
\item Relators in elements of \(S\) give rise to cycles.
\item When \(\langle S\rangle = G\), paths from \(e\) to \(g\) give words in \(S\) representing \(g\).
\item \(\Cay(G, S)\) allows us to view \(G\) as a metric space, with \emph{word metric}\index{word metric}
  \[
    d_S(g, h) = \min\{\text{length of path from \(g\) to \(h\) in \(\Cay(G, S)\)}\}.
  \]
  Define \emph{word length} to be \(|g| = d_S(e, g)\). Note \(d_S(g, h) = |g^{-1}h|\).
\item It follows that \(G\) acts on \(\Cay(G, S)\) via left-multiplication by isometry.
\end{enumerate}

\begin{theorem}
  \(\Cay(F(S), S)\) is a tree.
\end{theorem}

Let \(\overline X\) be a covering space of \(X = \bigvee_S S^1\), corresponding to \(N \normal F(S)\). Then \(\overline X\) is exactly \(\Cay(F(S)/N, \pi(S))\) where \(\pi: F(S) \to F(S)/N\) is the quotient map.

\begin{definition}[quasi-isometric embedding, quasi-isometry]\index{quasi-isometric embedding}\index{quasi-isometry}
  Let \((X, d_X), (Y, d_Y)\) be metric spaces. A map \(f: X \to Y\) is a \emph{quasi-isometric embedding} if exists \(\lambda \geq 1, C \geq 0\) such that for all \(a, b \in X\),
  \[
    \frac{1}{\lambda} d_X(a, b) - C \leq d_Y(f(a), f(b)) \leq \lambda d_X(a, b) + C.
  \]

  \(f\) is a \emph{quasi-isometry} if in addition exists \(D \geq 0\) such that for all \(y \in Y\) exists \(x \in X\) such that \(d_Y(f(x), y) \leq D\). Write \(X \simeq_{\mathrm{QI}} Y\) and we usually say \((\lambda, C, D)\) is a quasi-isometry.
\end{definition}

Quasi-isometry preserves large-scale structure of a space.

\begin{proposition}
  Quasi-isometry is an equivalence relation on metric spaces.
\end{proposition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item A non-empty bounded metric space is quasi-isometric to a point. In particular all finite groups have Cayley graphs quasi-isometric to a point.
  \item \(\R \times [0, 1] \simeq_{\mathrm{QI}} \R\).
  \item \(\Cay(\Z, S) \simeq_{\mathrm{QI}} \R\).
  \item \(\Cay(\Z^n, S) \simeq_{\mathrm{QI}} \R^n\).
  \end{enumerate}
\end{eg}

\begin{eg}
  Cayley graph cannot determine the group. For example \(C_4 \ncong C_2 \times C_2\) but taking \(S\) to be the set of all elements, both Cayley graphs are the complete graph on four vertices.

  In fact Cayley graph doesn't even determine the group with respect to a minimal generating set. For example \(C_2 \times C_3 = \langle (1, 0), (0, 1) \rangle, S_3 = \langle (12), (123) \rangle\). The resulting Cayley graphs are isomorphic as undirected graphs but nonisomorphic as directed graphs. 

  On the other hand we can obtain nonisomorphic Cayley graphs of \(G\) by choosing different generating sets. For example \(C_2 \times C_3 = \langle(1, 0), (0, 1)\rangle = \langle (1, 1), (1, 0) \rangle\).
\end{eg}

\begin{eg}
  3 regular trees \(T_3 \cong T_4\) by contracting edges (graph)
\end{eg}

\begin{eg}
  On the other hand, by using quasi-isomorphism invariants we can show some Cayley graphs are not isomorphic.
  \begin{enumerate}
  \item boundedness is an invariant so for example \(\R \ncong_{\mathrm{QI}} *\).
  \item \(\R \ncong_{\mathrm{QI}} [0, \infty)\): suppose \(\varphi: \R \to [0, \infty)\) is a quasi-isomorphism \((\lambda, C, D)\). Then \(\varphi(t), \varphi(-t) \to \infty\) as \(t \to \infty\). For any \(x \in [0, \infty)\), let
    \begin{align*}
      M_x &= \max \{n \in \Z: \varphi(n) < x\} \\
      N_x &= \min \{n \in \Z: \varphi(n) < x\} 
    \end{align*}
    They exist because for all \(x \in [0, \infty)\), there are only finitely many \(n \in \Z\) with \(\varphi(n) < x\). We thus have
    \begin{align*}
      \varphi(M_x) &< x \leq \varphi(M_x + 1) \\
      \varphi(N_x) &< x \leq \varphi(N_x - 1)
    \end{align*}
    Since \(d_\R(M_x, M_x + 1) = d_\R(N_x, N_x + 1)\),
    \begin{align*}
      d_{[0, \infty)}(\varphi(M_x), \varphi(N_x))
      &\leq d_{[0, \infty)}(\varphi(M_x), x) + d_{[0, \infty)}(x, \varphi(N_x)) \\
      &\leq d_{[0, \infty)}(\varphi(M_x), \varphi(M_x + 1)) + d_{[0, \infty)}(\varphi(N_x - 1), \varphi(N_x)) \\
      &\leq (\lambda \cdot 1 + C) + (\lambda \cdot 1 + C) \\
      &\leq 2 \lambda + 2C
    \end{align*}
    which is bounded independent of \(x\). But \(d_\R(M_x, N_x) \to \infty\) as \(x \to \infty\) as more and more elements will land in \([0, x)\) as \(x \to \infty\). Absurd.
  \item \(\R^m \ncong_{\mathrm{QI}} \R^n\) for \(m \ne n\).
  \item \(T_3 \ncong_{\mathrm{QI}} \R\).
  \end{enumerate}
\end{eg}

\begin{proposition}
  Let \(G\) be a finitely generated group, \(S, S'\) two finite generating sets of \(G\). Then \(\Cay(G, S) \cong_{\mathrm{QI}} \Cay(G, S')\).
\end{proposition}

\begin{proof}
  Consider the identity map \(\varphi = \id: |\Cay(G, S)| \to |\Cay(G, S')|\). Let
  \begin{align*}
    \lambda &= \max \{|a|_{S'}: a \in S\} \\
    \lambda' &= \max \{|a|_{S}: a \in S'\}
  \end{align*}
  then
  \begin{align*}
    d_{S'}(\varphi(g), \varphi(h)) &\leq \lambda d_S(g, h) \\
    d_S(g, h) &\leq \lambda' d_{S'}(\varphi(g), \varphi(h))
  \end{align*}
  Set \(\lambda = \max{\lambda, \lambda'}\).
\end{proof}

Recall that
\begin{enumerate}
\item a metric space is \emph{proper} if all closed balls are compact.
\item a metric space is \emph{geodesic} if for any \(x, y\) there is a path between them with length \(d(x, y)\).
\item an action \(G\) on \(X\) is \emph{proper} if for all \(K \subseteq X\) compact, \(|\{g \in G: gK \cap K \ne \emptyset\}| < \infty\). This implies that \(X/G\) is Hausdorff and locally compact.
\end{enumerate}

\begin{theorem}[Švarc–Milnor lemma]\index{Švarc–Milnor lemma}
  Let \(X\) be a proper geodesic metric space and \(G\) acts on \(X\) properly by isometry. Assume also the quotient \(X/G\) is compact. Then \(G\) is finitely generated and picking \(x_0 \in X\) defines a quasi-isomorphism \(\varphi_{x_0}: G \to X, g \mapsto g x_0\).
\end{theorem}

\begin{proof}
  Since the quotient space is compact, there is a closed ball \(\overline B = \overline B(x_0, D)\) such that \(G \overline B = X\). Since \(X\) is proper, \(\overline B\) is compact. Define
  \[
    S = \{g \in G: g \ne e, g \overline B \cap \overline B \ne \emptyset\}
  \]
  which is finite by properness. For \(A, B \subseteq X\), define
  \[
    d(A, B) = \inf \{d_X(a, b): a \in A, b \in B\}.
  \]
  Pick some \(g \in G \setminus (S \cup \{e\})\) such that \(d(\overline B, g \overline B) = R > 0\). Consider
  \[
    H = \{g \in G \setminus (S \cup \{e\}): d(\overline B, g \overline B) \leq R\}.
  \]
  Note as \(H\) is a subset of
  \[
    \{g \in G: g \overline B(x_0, D + R) \cap \overline B(x_0, D + R) \ne \emptyset\}
  \]
  it is finite. Thus
  \[
    \inf \{d(\overline B, g \overline B): g \in G \setminus (U \cup \{e\})\} = \min\{d(\overline B, h \overline B): h \in H\}
  \]
  so the infimum, say \(2d\), is achieved. Thus if \(d(\overline B, g \overline B) < 2d\) then \(g \in S \cup \{e\}\).

  To prove that \(G = \langle S\rangle\) we translate paths in \(X\) to words in \(G\). Take \(g \in G\). Let \(k = \floor{\frac{d_X(x_0, gx_0)}{d}}\). Take a sequence of points \(y_0 = x_0, y_1, \dots, y_{k + 1} = gx_0\) on the geodesic from \(x_0\) to \(gx_0\) such that \(d_X(y_i, y_{i + 1}) \leq d\) for all \(i\). Take a corresponding sequence \(h_i \in G\) such that for all \(i\), \(y_i \in h_i \overline B\). Taking \(h_0 = e, h_{k + 1} = g\). We have
  \[
    d(h_i \overline B, h_{i + 1} \overline B) \leq d_X(y_i, y_{i + 1}) \leq d
  \]
  so \(d(\overline B, h_i^{-1}h_{i + 1} \overline B) \leq d\) so \(h_i^{-1}h_{i + 1} \in S \cup \{e\}\), i.e.\ \(h_{i + 1} = h_i s\). Inductively \(g = h_{k + 1} = s_0 \cdots s_k\).

  All word metrics on \(G\) are quasi-isometric so take \(S\) as above. Clearly we have that \(2D\)-neighbourhood of the image of the map \(\varphi_{x_0}: g \mapsto g x_0\) is \(X\) so just need to show \(\varphi_{x_0}\) is a quasi-isometric embedding. By construction
  \[
    |g|_S \leq k + 1 \leq \frac{d_X(x_0, gx_0)}{d} + 1.
  \]
  On the other hand if \(|g|_S = m\) and \(t_1 \cdots t_m = g\) in \(G\), \(t_i \in S\) then
  \begin{align*}
    d_X(x_0, gx_0)
    &\leq d_x(t_1^{-1}x_0, x_0) + d_X(x_0, t_2 \cdots t_m x_0) \\
    &\leq d_X(x_0, t_1 x_0) + d_X(x_0, t_2 \cdots t_m x_0) \\
    &\leq \sum_{i = 1}^m d_X(x_0, t_ix_0) \\
    & \leq 2D m \\
    &= 2D |g|_s
  \end{align*}
  Finally apply left-invariance of \(d_S\) and \(d_X\).
\end{proof}

\begin{corollary}
  Let \(M\) be a compact connected Riemannian manifold and let \(\widetilde M\) be its universal. \(\pi_1M\) acts on \(\widetilde M\) isometrically so \(\pi_1M\) is finitely generated and is quasi-isometric to \(\widetilde M\).
\end{corollary}

\begin{corollary}
  Let \(G\) be a connected real Lie group and let \(\Gamma\) be a cocompact lattice in \(G\), i.e.\ a discrete subgroup such that \(G/\Gamma\) is compact. Then \(\Gamma\) is finitely generated and \(\Gamma \cong_{\mathrm{QI}} G\).
\end{corollary}

\begin{corollary}
  Let \(G\) be a finitely generated group.
  \begin{enumerate}
  \item If \(H\) is a finite index subgroup of \(G\) then \(G \cong_{\mathrm{QI}} H\).
  \item If \(H \normal G\) finite then \(G \cong_{\mathrm{QI}} G/N\).
  \item If \(G, H\) are commensurable finitely generated groups then \(G \cong_{\mathrm{QI}} H\).
  \end{enumerate}
\end{corollary}

\begin{definition}[commensurable]\index{commensurable}
  \(G\) and \(H\) are \emph{commensurable} if exists \(K_1 \leq G, K_2 \leq H\) finite index such that \(K_1 \cong K_2\).
\end{definition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item \(H\) acts on \(\Cay(G)\).
  \item \(G\) acts on \(\Cay(G/N)\).
  \item Immediate.
  \end{enumerate}
\end{proof}

\begin{corollary}
  All finitely generated free groups are quasi-isometric.
\end{corollary}

\begin{proof}
  \(F_n \leq F_2\) of finite index for all \(n \geq 2\).
\end{proof}

One may wonder if all quasi-isometric groups are commensurable. In other words, when does geometric similarity forces algebraic similarity? 

\begin{eg}
  There exist groups which are quasi-isometric but not commensurable. Take
  \[
    G = \Z_4 \wr \Z, H = (\Z_2 \times \Z_2) \wr \Z.
  \]
  Not commensurable: the only elements of finite order in \(H\), and hence in a finite index subgroup thereof, are of order \(2\). On the other hand, given a finite index subgroup \(K \leq G\), \(K\) necessarily contains elements of order \(4\) as
  \[
    [\bigoplus_\Z \Z_4: K \cap \bigoplus \Z_4] = [K \cdot \bigoplus \Z_4: K] < \infty
  \]
  and the subgroup generated by all elements of order \(2\) in \(\bigoplus \Z_4\) has infinite index.

  Quasi-isometric: take the generating set
  \[
    S = \{(0, 1)\} \cup \{(f_1, 0), (f_2, 0), (f_3, 0)\}
  \]
  of \(\Z_4 \wr \Z\) where \(f_i(0) = i, f_i(n) = 0\) otherwise. Similarly take
  \[
    S' = \{(0, 1)\} \cup \{(f_{(0, 1)}, 0), (f_{(1, 0)}, 0), (f_{(1, 1)}, 0)\}
  \]
  of \((\Z_2 \times \Z_2) \wr \Z\). Then the Cayley graphs are actually isomorphic.
\end{eg}

Question: in which case does quasi-isometry imply commensurability? Typical rigidity question.

Since quasi-isometry only sees finite index subgroups, it is convenient to define

\begin{definition}[virtual property]\index{virtual property}
  A group is called \emph{virtually \(P\)} for some property \(P\) if it has a finite index subgroup that is \(P\).
\end{definition}

\begin{eg}\leavevmode
  \begin{itemize}
  \item \(\Z_2 \times \Z\) is virtually \(\Z\).
  \item \(\SL_2(\Z)\) is virtually free.
  \end{itemize}
\end{eg}

\begin{theorem}
  Let \(G\) be a finitely generated group such that \(\Cay(G) \cong_{\mathrm{QI}} \Z\). Then \(G\) is virtually \(\Z\).
\end{theorem}

\begin{proof}[Sketch proof]
  First show there is an element of infinite order in \(G\). We will find \(g \in G\) and \(A \subseteq G\) such that \(gA \subsetneq A\) (then \(g^n \ne e\) for all \(n\)). Let \(\varphi: \Cay(G) \to \R\) be a quasi-isometry. As \(G\) acts on \(\Cay(G)\) by isometry, any \(g \in G\) determines a quasi-isometry \(\psi_g: \R \to \R\). Take \([0, \infty) \subseteq \R\), then \(\psi_g([0, \infty))\) is either a bounded distance\footnote{\(X\) is bounded distance from \(Y\) if exists \(M \geq 0\) such that for all \(x \in X\) exists \(y \in Y\) such that \(d(x, y) \leq M\) and vice versa.} from \([\psi_g(0), \infty)\) or \((-\infty, \psi_g(0)]\). If \(\psi_g([0, \infty))\) is bounded distance from \([\psi_g(0), \infty)\) then setting
  \[
    A = V(\Cay(G)) \cap \varphi^{-1}([0, \infty)).
  \]
  If \(\psi_g(0) \gg 0\) then \(gA \subsetneq A\): this is possible since \(\psi_g(0)\) is bounded below in terms of the quasi-isometry constants, while \(\inf \psi_g([0, \infty))\) (the ``left-most point'' the image of \([0, \infty)\) reaches before going off to infity) is bounded above.

  So need \(g\) so that \(\psi_g([0, \infty))\) is bounded distance from \([\psi_g(0), \infty)\) and \(\psi_g(0) \gg 0\). To find such \(g\), take \(h, k \in G\) such taht \(e, g, k\) far apart in \(\Cay(G)\) (if and only if \(\varphi(e), \varphi(h),  \varphi(h)\) far apart in \(\R\)). Consider images of \([0, \infty)\) under \(\psi_e, \psi_h, \psi_k\) --- at least two of thse images will be of bounded distance from each other, so at least two of \(A, hA, kA\) are nested. So take \(g\) to be one of the elements of \(h, k, k^{-1}h, h^{-1}k\).

  Let \(H = \langle g\rangle\). Want to show \(H\) has finite index in \(G\). We have \(d(e, g^n) \to \infty\) as \(n \to \pm \infty\) and \(d(g^n, g^m) = d(e, g^{n - m})\). Define
  \begin{align*}
    f: \Z &\to \R \\
    n &\mapsto \varphi(g^n)
  \end{align*}
  Then \(|f(n) - f(n - 1)|\) is bounded independent of \(n\) and for all \(r \geq 0\) exists \(K \in N\) such that \(|f(n) - f(m)| \leq r\) implies \(|m - n| \leq K\). It is an exercise to check that exists \(C > 0\) such that for all \(x \in \R\), exists \(n \in \Z\) such that \(|x - f(n)| \leq C\). Then exists \(C'\) such that for all \(g' \in G\), exists \(g^n \in H\) such that \(d(g', g^n) \leq C'\), i.e.\ \(\Cay(G)/H\) is finite, so \(H\) is a finite index subgroup in \(G\).
\end{proof}

Other examples:
\begin{itemize}
\item If both groups are virtually ablian then quasi-isometry implies commensurability. This is an exercise.
\item It is also true if just one of the groups is assumed to be abelian. This is much deeper. See next chapter.
\item True if both groups are virtually free.
\item True if only one of the groups is assumed to be virtually free.
\end{itemize}

\section{Geometric property of groups}

\subsection{Growth}

\begin{notation}
  Let \(f, g: X \to \R\) where \(X \subseteq \R\), we write
  \begin{itemize}
  \item \(f \preceq g\) if exists \(a, b > 0\) and \(x_0\) such that \(f(x) \leq a g(bx)\) for \(x \geq x_0\).
  \item \(f \asymp g\) if \(f \preceq g, g \preceq f\).
  \end{itemize}
\end{notation}

\begin{definition}[growth function]\index{growth function}
  Let \(X\) be a discrete metric space and \(x_0 \in X\) a basepoint. The \emph{growth function} is the function
  \[
    \beta_{X, x_0}(r) = |\overline B_X(x_0, r)|.
  \]
\end{definition}

\begin{lemma}
  The equivalence class of growth function under \(\asymp\) is a quasi-isometry invariant for groups. In particular \(\beta_{G, g} = \beta_{G, h}\) for all \(g, h \in G\) and write \(\beta_G\) for this equivalence class.
\end{lemma}

We write \(\beta_{G, S}\) for the growth function relative to the generating set \(S\).

\begin{proposition}\leavevmode
  \begin{enumerate}
  \item If \(G\) is infinite then \(\beta_{G, S}|_\N\) is strictly increasing.
  \item \(\beta_{G, S}(r + t) \leq \beta_{G, S}(r) \cdot \beta_{G, S}(t)\).
  \item \(\beta_{G, S}(r) \leq |S|^r\).
  \end{enumerate}
\end{proposition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(\beta_{\Z^k}(r) \asymp r^k\).
  \item \(\beta_{F_k}(r) \asymp (2k)^r\).
  \end{enumerate}
\end{eg}

\begin{remark}
  The proposition implies that
  \[
    \lim_{n \to \infty} \beta_{G, S}(n)^{1/n} \geq 1.
  \]
  The limit exists by Fekete's lemma: if \((a_n)\) is a subadditive sequence then \(\lim \frac{a_n}{n}\) exists.
\end{remark}

\begin{definition}[(sub)exponential/polynomial growth]\index{growth!exponential}\index{growth!subexponential}\index{growth!polynomial}
  We say \(G\) has \emph{exponential growth} if \(\lim \beta_{G, S}(n)^{1/n} > 1\). Otherwise we say \(G\) has \emph{subexponential growth}.

  \(G\) has \emph{polynomial growth} if exists \(D\) such that \(\beta_G(r) \leq r^D\).
\end{definition}

\begin{proposition}\leavevmode
  \begin{enumerate}
  \item If \(H\) is a finitely generated subgroup of \(G\) then \(\beta_H \preceq \beta_G\).
  \item If \(H\) is a finite index subgroup of \(G\) then \(\beta_H \asymp \beta_G\).
  \item If \(N \normal G\) then \(\beta_{G/N} \asymp \beta_G\).
  \item If \(N \normal G\) is finite then \(\beta_{G/N} \asymp \beta_G\).
  \end{enumerate}
\end{proposition}

\begin{proof}
  2 and 4 are easy consequences Švarc-Milnor. For 1, take \(T\) to be a finite generating set of \(H\) and take \(S \supseteq T\) to be a finite generating set of \(G\). Then \(\Cay(H, T)\) is a subgraph of \(G\) so \(d_S(e, h) \leq d_T(e, h)\) for all \(h \in H\). Thus the closed ball of radius \(r\) about \(e\) in \(\Cay(G, S)\) contains the corresponding ball of \(\Cay(H, T)\).

  For 3, take \(S\) to be a finite generating set of \(G\). Let \(T = SN/N\) be a finite generating set of \(N\). \(\pi: G \to G/N\) maps closed \(r\)-ball about \(e\) onto closed \(r\)-ball around \(e\) in \(G/N\).
\end{proof}

We can ask many questions about growth, for example
\begin{enumerate}
\item what types of growth can groups display?
\item which group have which types of growth?
\end{enumerate}

We have seen that virtually abelian groups have polynomial growth. This generalises to

\begin{proposition}
  Let \(G\) be a 2-step nilpotent finitely generated group, i.e.\ \([[G, G], G] = \{e\}\). Then \(G\) has polynomial growth.
\end{proposition}

\begin{proof}
  Suppose \(G\) is generated by \(g_1, \dots, g_m\). As \(G\) is 2-step nilpotent, \([G, G] \subseteq Z(G)\). We bound the size of all products of \(n\) generators using a normal form. Note we can exchange two elements at the cost of a commutator:
  \[
    gh = hg \cdot g^{-1}h^{-1}gh = hg [g, h].
  \]
  Commutators are central so we can move them to the right. Thus in \(\leq n^2\) moves we can express the element as \(g_1^{\alpha_1} \cdots g_m^{\alpha_m} \cdot C\), where \(C\) is a product of \(\leq n^2\) commutators. It is an easy exercise to check that \([G, G]\) is finitely generated, in this case by \([g_i^{\pm 1}, g_j^{\pm 1}]\). Thus the commutators are words of length 1 in generators of \([G, G]\) , which has polynomial growth (say degree \(D\)). Thus \(G\) has polynomial growth of degree \(\leq m + 2D\).
\end{proof}

\begin{theorem}
  All finitely generated virtually nilpotent groups have polynomial growth.
\end{theorem}

\begin{proof}
  Exercise.
\end{proof}

Can we push this result further? The natural class of groups to consider after nilpotent groups is solvable groups. Unfortunately, there do exist solvable groups of exponential growth, for example the lamplight group\index{lamplight group} \(\Z_2 \wr \Z\). In fact,

\begin{theorem}[Gromov]
  A finitely generated group has polynomial growth if and only if it is virtually nilpotent.
\end{theorem}

\begin{remark}
  The proof uses what is now called \emph{asymptotic cones}, the limit of the objects \((X, \frac{d}{n})\) as \(n \to \infty\).

  Tits alternative: in the language of growth, a group either has exponential growth or is virtually solvable. Then we can use algebraic techniques to show it's virtually nilpotent.

  c.f. paper by Wilkie van den Dries (rewrite the old paper), Kleiner (different proof, elementary but hard), Ozawa (functional analysis, representation theory)

  For ultralimits and asymptotic growth, see Druţu and Kapovich Chapter 7.

  There is also a proof based on approximate groups.
\end{remark}

\begin{corollary}
  Being virtually nilpotent is quasi-isometry invariant.
\end{corollary}

Does there exist groups whose growth is between polynomial and exponential? The answer is yes, and such groups are said to have intermediate growth\index{growth!intermediate}

\begin{theorem}[Grigorchuk, 1983]
  There exists a finitely generated group \(G\) such that
  \[
    2^{r^{\alpha_1}} \preceq \beta_G(r) \preceq 2^{r^{\alpha_2}}
  \]
  for \(0 < \alpha_1 < \alpha_2 < 1\).
\end{theorem}

For more on intermediate growth see de la Harpe.

\subsection{Ends}

How many ways are there to go to infinity in a Cayley graph? Informally, for \(F_2\) there are ``infinitely many'' while for \(\Z^2\) there is ``only one'' way. For \(\Z \times \Z/2\) there are ``two'' ways. Of course for finite groups there is no way to move to infinity. We are going to formalise this notion using \emph{ends} and prove that, perhaps surprisingly, the above are all the possibilities that can arise from the Cayley graph of a finitely generated group.

\begin{definition}[proper map]
  A map \(f: X \to Y\) between topological spaces is \emph{proper} if \(f^{-1}(C)\) is compact whenever \(C\) is compact.
\end{definition}

\begin{definition}[ray]\index{ray}
  Let \(X\) be a topological space. A \emph{ray} in \(X\) is a proper continuous map \(r: [0, \infty) \to X\).
\end{definition}

\begin{definition}[convergence to the same end]\index{end}
  Let \(r_1, r_2: [0, \infty) \to X\) be rays. \(r_1, r_2\) \emph{converge to the same end} if for all compact \(C \subseteq X\), exists \(N \in \N\) such that \(r_1([N, \infty))\) and \(r_2([N, \infty))\) are contained in the same path component of \(X \setminus C\).
\end{definition}

(pic of Calyay graph of \(F_2\))

This defines an equivalence relation on rays, the equivalence classes of which are called the set of \emph{ends} of \(X\) and is denoted \(\Ends(X)\). If \(|\Ends(X)| = m\) we say \(X\) has \(m\) ends.

We can topologise \(\Ends(X)\) by declaring a set \(B \subseteq \Ends(X)\) to be closed if \(\mathrm{end}(r_n) \in B\) for all \(n\) and \(\mathrm{end}(r_n) \to \mathrm{end}(r)\) imply that \(\mathrm{end}(r) \in B\), where \(\mathrm{end}(r_n) \to \mathrm{end}(r)\) if for all \(C \subseteq X\) compact, exists a sequence of natural numbers \((N_n)\) such that \(r_n([N_n, \infty))\) and \(r([N_n, \infty))\) lie in the same path compnent of \(X \setminus C\) for \(n\) sufficiently large.

\begin{definition}
  A \emph{\(k\)-path} from \(x\) to \(y\) in a metric space \(X\) is a sequence of points \(x_1 = x, x_2, \dots, x_n = y\) such that \(d(x_i, x_{i + 1}) \leq k\) for all \(i\).
\end{definition}

The following lemma justifies the heuristics at the beginning of the section of thinking ends as ways of escaping to infinity from a fixed point.

\begin{lemma}
  Let \(X\) be a proper geodesic metric space, \(k > 0\) and \(r_1, r_2\) rays in \(X\). Let \(G_{x_0}(X)\) be the set of (proper) geodesic rays starting at \(x_0 \in X\). Then
  \begin{enumerate}
  \item \(\mathrm{end}(r_1) = \mathrm{end}(r_2)\) if and only if for all \(R > 0\), exists \(T > 0\) such that for all \(t > T\), \(r_1(t)\) can be connected to \(r_t(t)\) by a \(k\)-path in \(X \setminus B(x_0, R)\).
  \item the natural map \(G_{x_0}(X) \to \Ends(X)\) is surjective.
  \end{enumerate}
\end{lemma}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Every compact subset of \(X\) is contained in an open ball about \(x_0\) and vice versa. Given a \(k\)-path from \(x_1\) to \(x_n\) in \(X \setminus B(x_0, R + k)\), concatenate any geodesics from \(x_i\) to \(x_{i + 1}\) to get a continuous path in \(B(x_0, R)\).
  \item Let \(r: [0, \infty) \to X\) be a ray. Let \(c_n: [0, d_n] \to X\) be a geodesic from \(x_0\) to \(r(n)\) where \(d_n = d(x_0, r(n)\). Extend \(c_n\) to \([d_n, \infty)\) by setting \(c_n(t) = r(n)\) for \(t \in [d_n, \infty)\). Ay Arzela-Ascoli, there exists a convergent subsequence of \(c_n\) converging to \(c: [0, \infty) \to X\) a geodesic ray with \(\mathrm{end}(c) = \mathrm{end}(r)\).
  \end{enumerate}
\end{proof}

Let \(X\) be a metric space. Given \(f, g: X \to X\), say \(f \sim g\) if \(\sup_{x \in X} d_X(f(x), g(x))\) is finite. The set of equivalent classes of quasi-isometries of \(X\) forms a group, which we denote by \(\QI(X)\). A quasi-isometry \(\varphi: X \to Y\) induces an isomorphism \(\varphi_*: \QI(X) \to \QI(Y)\).

\begin{proposition}
  Let \(X\) and \(Y\) be proper geodesic metric spaces. A quasi-isometry \(f: X \to Y\) induces a homeomorphism \(\overline f: \Ends(X) \to \Ends(Y)\) which will be defined below. Then
  \begin{align*}
    \QI(X) &\to \mathrm{Homeo}(\Ends(X)) \\
    f &\mapsto \overline f
  \end{align*}
  is a homomorphism.
\end{proposition}

\begin{proof}
  Let \(r\) be a geodesic ray in \(X\) from \(x_0\), \(f_* r\) be the ray in \(Y\) obtained by concatenating some choice of geodesic segments \([f(r(n)), f(r(n + 1))]\). \(f\) is a quasi-isometry implies that \(f_*r\) is a (proper) ray. \(\mathrm{end}(f_*r)\) is independent of the choice of geodesic segments. Define
  \begin{align*}
    \overline f: \Ends(X) &\to \Ends(Y) \\
    \mathrm{end}(r) &\mapsto \mathrm{end}(f_*r)
  \end{align*}
  The image of a \(k\)-path under \(f\) is a \((\lambda k + c)\)-path so \(\overline f\) is well-defined and continuous by the previous lemma part 1.

  Lemma part 2 ensures that \(\overline f\) is defined on all of \(\Ends(X)\). The rest are exercise.
\end{proof}

\begin{definition}[ends of a group]\index{end}
  Let \(G\) be a finitely generated group. Then \(\Ends(G) = \Ends(\Cay(G))\).
\end{definition}

\begin{theorem}
  Let \(G\) be a finitely generated group.
  \begin{enumerate}
  \item \(G\) has \(0, 1, 2\) or finitely many ends.
  \item \(G\) has 0 end if and only if \(G\) is finite.
  \item \(G\) has 2 ends if and only if \(G\) is virtually \(\Z\).
  \item \(G\) has infinitely many ends if and only if \(G\) can be expressed as \(A *_C B\) or \(A *_C\) with \(C\) finite, \(|A/C| \geq 3, |B/C| \geq 2\).
  \end{enumerate}
\end{theorem}

\begin{proof}
  We prove 1. Fix a generating set \(S\) of \(G\) and work with \(\Cay(G, S)\). \(G\) acts \(\Cay(G, S)\) by isometry, giving a homomorphism \(G \to \mathrm{Homeo}(\Ends(\Cay(G, S)))\). Let \(H\) be its kernel. Suppose \(|\Ends(G)| < \infty\), so \(H\) has finite index in \(G\). Assume further \(e_0, e_1, e_2 \in \Ends(G)\) are distinct for contracdiction. Fix geodesic rays \(r_1, r_2: [0, \infty) \to \Cay(G)\) with \(r_1(0) = r_2(0) = e_G\) such that \(\mathrm{end}(r_i) = e_i\). The ray corresponding to \(e_0\) is defined  slightly differently. Since \(H\) has finite index in \(G\), exists \(\mu > 0\) such that for all \(g \in G\), exists \(h \in H\) with \(d(g, h) \leq \mu\). Thus exists a ray \(r_0: [0, \infty) \to \Cay(G)\) with
  \begin{itemize}
  \item \(\mathrm{end}(r_0) = e_0\),
  \item \(d(r_0(n), e_G) \geq n\),
  \item \(r_0(n) \in H\) for all \(n\).
  \end{itemize}
  Set \(h_n = r_n(n)\). Fix \(N > 0\) such that \(r_i[N, \infty)\) lie in different path components of \(\Cay(G) \setminus B(e_G, N)\). If \(t, t' > 2N\) then \(d(r_1(t), r_2(t')) > 2N\) since any path joining \(r_1(t)\) and \(r_2(t')\) must pass though \(B(e_G, N)\).

  \(H\) acts trivially on \(\Ends(G)\) so \(\mathrm{end}(h_n r_i) = \mathrm{end}(r_i)\) for all \(i\). Let \(n > 3N\). Then \(h_nr_i(0) = h_n\) lie in a different path component of \(\Cay(G) \setminus B(e_G, N)\) from \(r_i[N, \infty)\) for \(i = 1, 2\), so \(h_nr_i\) must though \(B(e_G, N)\). Thus exists \(t_i\) such that \(h_nr_i(t_i) \in B(e_n, N)\) for \(i = 1, 2\). Since \(h_n\) is an isometry, \(d(r_1(t_1), r_2(t_2)) < 2N\), contradicting \(d(r_1(t_1), r_2(t_2)) > 2N\).
\end{proof}

\begin{remark}
  We have seen that being virtually nilpotent is a geometric property. In fact,
  \begin{enumerate}
  \item being virtually free is geometric, as it is equivalent to being quasi-isometric to a tree. c.f.\ Antolin.
  \item being finitely presentable is geometric. c.f.\ Bridson-Haefliger Prop 8.24.
  \end{enumerate}
\end{remark}

\section{Amenability}

\subsection{Paradoxical decomposition}

The motivating example for this chapter is \emph{paradoxical decomposition}, which is the key argument in Banach-Tarski.

\begin{definition}[equidecomposable]\index{equidecomposable}
  Let \(G\) act on a set \(X\) and \(A, B \subseteq X\). Say that \(A\) and \(B\) are \emph{(finitely) \(G\)-equidecomposable} if exist partitions
  \begin{align*}
    A &= A_1 \cup A_2 \cup \dots \cup A_n \\
    B &= B_1 \cup B_2 \cup \dots \cup B_n
  \end{align*}
  and \(g_1, \dots, g_n \in G\) such that \(g_i A_i = B_i\) for all \(i\). We write \(A \sim B\). If \(A \sim C\) for some \(C \subseteq B\) then write \(A \lesssim B\).

  A \emph{realisation} \(h\) of \(A \sim B\) is a bijection \(h: A \to B\) such that there exists a decomposition as above with \(h(a_i) = g_i(a_i)\) for all \(i\) and for all \(a_i \in A_i\).
\end{definition}

Note that if \(h: A \to B\) is a realisation of \(A \sim B\) and \(S \subseteq A\) then \(S \sim h(S)\). For fixed \(X\), \(G\)-equidecomposability is an equivalence relation.

\begin{theorem}
  Suppose \(G\) acts on \(X\) and \(A, B \subseteq X\). Then \(A \lesssim B\) and \(B \lesssim A\) implies \(A \sim B\).
\end{theorem}

\begin{proof}
  Schöder-Bernstein.
  \iffalse
  Let \(f: A \to B_1, g: A_1 \to B\) be the realisations. Define inductively
  \begin{align*}
    C_0 &= A \setminus A_1 \\
    C_{n + 1} &= g^{-1} f(C_n)
  \end{align*}
  and let \(C = \bigcup_{n = 0}^\infty C_n\). If \(a \in A \setminus C\) then \(a \notin C_n\) for all \(n \geq 0\), so \(g(a) \notin f(C_n)\). Thus \(g(A \setminus C) = B \setminus f(C)\). Similarly \(B \setminus f(C) \subseteq g(A\setminus C)\). Thus \(A \setminus C \sim_g B \setminus f(C)\). Since \(C \sim f(C)\) we get \(A \sim B\).
  \fi
\end{proof}

\begin{corollary}
  Let \(G\) act on \(X\). Then TFAE:
  \begin{enumerate}
  \item there exist proper disjoint subsets \(A, B \subseteq X\) such that \(A \sim X \sim B\).
  \item there exist proper disjoint subsets \(A, B \subseteq X\) such that \(A \cup B = X\) and \(A \sim X \sim B\).
  \end{enumerate}
\end{corollary}

\begin{proof}
  For \(1 \implies 2\), since \(X \sim B \subseteq X \setminus A\), have \(X \lesssim X \setminus A\). Trivially \(X \setminus A \lesssim X\). Thus \(A \sim X \sim X \setminus A\).
\end{proof}

\begin{definition}[\(G\)-paradoxical]\index{\(G\)-paradoxical}
  Let \(G\) act on \(X\). If the condition in the previous corollary holds, we say \(X\) is \emph{(finitely) \(G\)-paradoxical}.
\end{definition}

\begin{proposition}\leavevmode
  \begin{enumerate}
  \item \(F_2\) is \(F_2\)-paradoxical (left multiplication).
  \item If \(F_2\) acts on \(X\) freely then \(X\) is \(F_2\)-paradoxical.
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Let \(F_2 = \langle a, b\rangle\). Let \(W(y)\) be the set of reduced words starting in \(y\) where \(y \in \{a^{\pm 1}, b^{\pm 1}\}\). Then
    \[
      F_2 = \{e\} \cup W(a) \cup (a^{-1}) \cup W(b) \cup W(b^{-1})
    \]
    as a disjoint union. We can also write
    \[
      F_2 = W(a) \cup aW(a^{-1}) = W(b) \cup bW(b^{-1})
    \]
    so define
    \begin{align*}
      A &= W(a) \cup W(a^{-1}) \\
      B &= W(b) \cup W(b^{-1})
    \end{align*}
    and \(A, B\) satisfies the first condition in the corollary.
  \item Take \(M\) to be a set of representatives of \(F_2\)-orbits of \(X\). Set
    \[
      X_y = \{zm: z \in W(y), m \in M\}.
    \]
    Then \(X_a, X_{a^{-1}}, X_b, X_{b^{-1}}\) are disjoint and
    \[
      X = X_a \cup aX_{a^{-1}} = X_b \cup bX_{b^{-1}},
    \]
    giving the desired decomposition.
  \end{enumerate}
\end{proof}

Note that in the second part we need the axiom of choice.

\begin{proposition}
  \(F_2 \leq \SO(3, \R)\), with generators
  \[
    \begin{pmatrix}
      1 & 0 & 0 \\
      0 & \frac{1}{3} & \frac{-2\sqrt 2}{3} \\
      0 & \frac{2\sqrt{2}}{3} & \frac{1}{3}
    \end{pmatrix},
    \begin{pmatrix}
      \frac{1}{3} & \frac{-2\sqrt 2}{3} & 0 \\
      \frac{2\sqrt 2}{3} & \frac{1}{3} & 0 \\
      0 & 0 & 1
    \end{pmatrix}
  \]
\end{proposition}

\begin{proof}
  Exercise. Uses a ping-pong lemma argument.
\end{proof}

\begin{theorem}[Hausdorff paradox]
  There exists a countable set \(D \subseteq S^2\) such that \(S^2 \setminus D\) is \(\SO(3, \R)\)-paradoxical.
\end{theorem}

\begin{proof}
  Every non-trivial element in \(\SO(3, \R)\) fixes exactly two points of \(S^2\). Let \(D\) be the union of fixed points of \(F_2 \subseteq \SO(3, \R)\). \(F_2\) then acts freely on \(S^2 \setminus D\).
\end{proof}

\begin{proposition}
  For any countable \(D \subseteq S^2\), \(S^2\) and \(S^2 \setminus D\) are \(\SO(3)\)-equidecomposable.
\end{proposition}

\begin{proof}
  Let \(\ell\) be a line though the origin that misses \(D\). As \(D\) is countable, exists \(\theta\) such that for all \(n > 0\), the image \(\rho^n(D)\) of \(D\) under rotation \(\rho^n\) by \(n \theta\) about \(\ell\) does not intersect \(D\). Set \(\overline D = \bigcup_{n = 0}^\infty \rho^n(D)\). Then
  \begin{align*}
    S^2
    &= \overline D \cup (S^2 \setminus \overline D) \\
    &\sim \rho(\overline D) \cup \rho(S^2 \setminus \overline D) \\
    &\sim \rho(\overline D) \cup (S^2 \setminus \overline D) \\
    &= S^2 \setminus D
  \end{align*}
\end{proof}

Together this shows

\begin{theorem}[Banach-Tarski]\index{Banach-Tarski}
  \(S^2\) is \(\SO(3, \R)\)-paradoxical.
\end{theorem}

\begin{theorem}
  Let \(E(3)\) be the group of isometries of \(\R^3\). Then any solid ball in \(\R^3\) is \(E(3)\)-paradoxical, as is \(\R^3\).
\end{theorem}

Moral: cannot put a finitely-additive probability measure that is invariant under rotations on subsets of \(S^2\).

\begin{theorem}[Tarski]
  Let \(G\) act on \(X\) and \(E \subseteq X\). Then there is a finitely-additive measure \(\mu: \mathcal P(X) \to [0, \infty]\) with \(\mu(E) = 1\) that is \(G\)-invariant if and only if \(E\) is not \(G\)-paradoxical.
\end{theorem}

\subsection{Amenable group}

\begin{definition}[amenable]\index{amenablility}
  Let \(G\) be a discrete (resp.\ locally compact) group. A \emph{measure} on \(G\) is a finitely-additive left-invariant measure \(\mu\) on \(\mathcal P(G)\) (resp.\ Borel sets of \(G\)) with \(\mu(G) = 1\). \(G\) is \emph{amenable} if it it has such a measure.
\end{definition}

\begin{remark}
  Clearly if \(G\) acts on itself by multiplication and \(G\) is paradoxical then \(G\) is not amenable. In particular \(F_2\) is not amenable, nor is any group containing \(F_2\). One might naturally wonder if it is the only obstruction to amenability. This is the von Neumann conjecture: any non-amenable group contains \(F_2\). It is disproved by Ol'shanskii, who constructed a counterexample called Tarski monster. It has the strange propery that for \(p\) a fixed prime, every non-trivial proper subgroup has order \(p\).
\end{remark}

\begin{definition}
  Let \(G\) be a finitely generated group, and let \(\ell^\infty(G)\) be the space of bounded functions on \(G\). A linear functional \(M: \ell^\infty(G) \to \R\) is a \emph{left-invariant mean} on \(G\) if
  \begin{itemize}
  \item \(M(f) \geq 0\) if \(f(g) \geq 0\) for all \(g \in G\).
  \item \(M(\chi_G) = 1\) for the characteristic function on \(G\).
  \item \(M(g(f)) = M(f)\) for all \(g \in G\), where \(g(f)(h) = f(g^{-1}h)\).
  \end{itemize}
\end{definition}

\begin{proposition}
  \(G\) is amenable if and only if \(G\) admits a left-invariant mean.
\end{proposition}

\begin{proof}
  If \(G\) is amenable then define
  \[
    M(f) = \int f d \mu.
  \]
  Conversely if \(M\) is a left-invariant mean on \(G\) define
  \[
    \mu(A) = M(\chi_A).
  \]
\end{proof}

\begin{proposition}
  Let \(G\) amenable act on \(X\). Then there exists a finitely-additive probability measure on \(\mathcal P(X)\) that is \(G\)-invariant. In particular \(X\) is not \(G\)-paradoxical.
\end{proposition}

\begin{proof}
  Let \(\mu\) be the measure realising amenability of \(G\). Fix \(x_0 \in X\) and define
  \begin{align*}
    \nu: \mathcal P(X) &\to [0, 1] \\
    A &\mapsto \mu \{g \in G: g(x_0) \in A\}
  \end{align*}
\end{proof}

To summarise

\begin{theorem}
  TFAE:
  \begin{enumerate}
  \item \(G\) amenable.
  \item \(G\) admits a left-invariant measure.
  \item \(G\) is not paradoxical.
  \end{enumerate}
\end{theorem}

\begin{eg}
  All finite groups are amenable via normalised counting measure.
\end{eg}

\begin{proposition}\leavevmode
  \label{prop:sub/quot/direct limit of amenable groups}
  \begin{enumerate}
  \item If \(G\) is amenable and \(H \leq G\) then \(H\) is amenable.
  \item If \(G\) is amenable and \(N \normal G\) then \(G/N\) is amenable.
  \item If \(N \normal G\) and \(G/N\) are amenable then \(G\) is amenable.
  \item If \(\{G_i\}\) is a direct system of amenable groups then so is \(\varinjlim G_i\).
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Let \(\mu: \mathcal P(G) \to [0, 1]\) realise the amenability of \(G\). Let \(M\) be a right transversal of \(H \leq G\) and define
    \begin{align*}
      \nu: \mathcal P(H) &\to [0, 1] \\
      A &\mapsto \mu(AM)
    \end{align*}
  \item Define
    \begin{align*}
      \lambda: \mathcal P(G/N) &\to [0, 1] \\
      A &\mapsto \mu(AN)
    \end{align*}
  \item Let \(\nu_1, \nu_2\) realise amenability of \(N, G/N\) respectively. For \(A \leq G\) define
    \begin{align*}
      f_A: G &\to \R \\
      g &\mapsto \nu_1(N \cap g^{-1}A)
    \end{align*}
    Note for \(n \in N\), by translation invariance
    \[
      f_A(gn) = \nu_1(N \cap n^{-1}g^{-1}A) = \nu_1(N \cap g^{-1}A) = f_A(g)
    \]
    so \(f_A\) descends to a function on \(G/N\). Now define the measure on \(G\) to be
    \begin{align*}
      \mu: \mathcal P(G) &\to [0, 1] \\
      A &\to \int f_A d \nu_2
    \end{align*}
    To show left-invariance, note
    \[
      f_{hA}(g) = \nu_1(N \cap g^{-1}hA) = f_A(h^{-1}g) = h f_A(g)
    \]
    The action of \(G\) on functions \(G/N \to \R\) factors thorugh \(G/N\):
    \[
      hnf_A(g) = f_A(n^{-1}h^{-1}g) = \nu_1(N \cap g^{-1}hnA) = \nu_1(N \cap g^{-1}hA) = hf_A(g)
    \]
    so
    \[
      \mu(hA) = \int h^{-1}f_A d \nu_2 = \int f_A d \nu_2 = \mu(A)
    \]
    by \(G/N\)-invariance of \(\nu_2\).
  \item Omitted.
  \end{enumerate}
\end{proof}

\subsection{Amenability from a geometric viewpoint}

We first derive a combinatorial characterisation of amenability.

\begin{definition}[Følner condition]\index{Følner condition}
  A finitely generated group \(G\) is said to satsify the \emph{Følner condition} if for all finite subsets \(A \subseteq G\), for all \(\varepsilon > 0\), exists finite nonemepty subset \(F \subseteq G\) such that
  \[
    \frac{|aF \triangle F|}{|F|} \leq \varepsilon
  \]
  for all \(a \in A\) where \(\triangle\) denotes symmetric difference.
\end{definition}

\begin{theorem}
  Suppose \(G\) is a finitely generated group. Then TFAE:
  \begin{enumerate}
  \item \(G\) is amenable.
  \item \(G\) satisfies the Følner condition.
  \end{enumerate}
\end{theorem}

\begin{proof}
  For \(1 \implies 2\), see Theorem 16.62 in Druţu and Kapovich, or Theorem 4.2.3 in Juschenko's ``Amenability''.

  For \(2 \implies 1\), \([0, 1]^{\mathcal P(G)}\) is compact in product topology. For \(A \subseteq G\) finite, \(\varepsilon > 0\), define \(M_{A, \varepsilon}\) to be the set of finitely additive probability meansure \(\mu\) on \(G\) such that \(|\mu(B) - \mu(a B)| \leq \varepsilon\) for all \(B \subseteq G\), for all \(a \in A\). \(M_{A, \varepsilon}\) is closed in \([0, 1]^{\mathcal P(G)}\). To show it is nonempty, define \(\mu(B) = \frac{|B \cap F|}{|F|}\) where \(F\) is a Følner set for \(A, \varepsilon\). Check
    \begin{align*}
      |\mu(B) - \mu(aB)|
      &= \left|\frac{|B \cap F|}{|F|} - \frac{|aB \cap F|}{|F|}\right| \\
      &= \left|\frac{|B \cap F|}{|F|} - \frac{|B \cap a^{-1} F|}{|F|}\right| \\
      &\leq \frac{|F \triangle a^{-1}F|}{|F|} \\
      &= \frac{|aF \triangle F|}{|F|} \\
      &\leq \varepsilon
    \end{align*}
    As
    \[
      \bigcap_{i = 1}^n M_{A_i, \varepsilon_i} \supseteq M_{\bigcup A_i, \min \varepsilon_i} \ne \emptyset,
    \]
    \(\{M_{A, \varepsilon}\}\) has finite intersection property so \(\bigcap_{A, \varepsilon} M_{A, \varepsilon}\) is nonempty.
\end{proof}

\begin{definition}[Cheeger constant]\index{Cheeger constant}
  Let \(X\) be a graph. The \emph{Cheeger constant} \(h(X)\) is defined by
  \[
    h(X) = \inf \frac{|\p A|}{|A|}
  \]
  over all nonempty finite \(A \subseteq V(X)\), where \(\p A\) is the set of vertices in \(V(X) \setminus A\) that are connected by an edge to some element in \(A\).
\end{definition}

Note that under this definition \(h(\text{finite group}) = 0\). This fits our purpose of studying amenability. Usually, a more useful definition is to take \(A\) such that \(|A| \leq \frac{1}{2} |V(X)|\) for finite graphs.

\begin{proposition}
  Let \(G\) be a finitely generated group. Then TFAE:
  \begin{enumerate}
  \item \(G\) satsifies the Følner condition.
  \item \(h(\Cay(G, S)) = 0\) for all generating sets \(S\).
  \item \(h(\Cay(G, S)) = 0\) for some generating set \(S\).
  \end{enumerate}
\end{proposition}

Informally this is saying non-amenability is equivalent to a ``connectivity'' property.

\begin{proof}
  \(2 \implies 3\) is clear. \(3 \implies 1\) is an exercise. For \(1 \implies 2\), note that the Folner condition can be equivalently phrased in terms of right translates: take the Folner set \(F\) corresponding to \(A^{-1}\) and then
  \[
    \frac{|F^{-1}a \triangle F^{-1}|}{|F^{-1}|} = \frac{|a^{-1}F \triangle F|}{|F|} < \varepsilon.
  \]

  Now take \(A = S^{\pm 1}\) for some generating set \(S\) of \(G\) and \(\varepsilon > 0\). Let \(F\) be the Folner set such that
  \[
    \frac{|Fs \triangle F|}{|F|} \leq \varepsilon
  \]
  for all \(s \in S^{\pm 1}\). Then
  \begin{align*}
    \frac{|\p F|}{|F|}
    &= \frac{|\{gs: g \in F, s \in S^{\pm 1}, gs \notin F\}|}{|F|} \\
    &\leq \frac{|\bigcup_{s \in S^{\pm 1}} (Fs \triangle F)|}{|F|} \\
    &\leq |S^{\pm 1}| \cdot \varepsilon \\
    &\leq 2 |S| \cdot \varepsilon
  \end{align*}
  so indeed its infimum is \(0\).
\end{proof}

\begin{eg}
  \(h = 0\) is quasi-isometry-invariant.
\end{eg}

\begin{corollary}
  Amenability is a quasi-isometry invariant.
\end{corollary}

\begin{corollary}
  All finitely generated groups of subexponential growth\index{growth!subexponential} are amenable.
\end{corollary}

\begin{proof}
  Recall that if \(G\) has subexponential growth then at most
  \[
    \beta_{G, S}(n)^{1/n} = |B(n)|^{1/n} \to 1.
  \]
  If exists \(\varepsilon\) such that for all \(k\), \(\frac{|B(k + 1)|}{|B(k)|} > 1 + \varepsilon\) then
  \[
    |B(k + 1)| > (1 + \varepsilon)^k \cdot |B(1)|
  \]
  and letting \(k \to \infty\), \(\beta(k)^{1/k} \nto 1\). Thus for all \(N > 0\) exists \(k_N\) such that
  \[
    \frac{|B(k_N + 1)|}{|B(k_N)|} < 1 + \frac{1}{N}
  \]
  and so
  \[
    \frac{|\p B(k_N)|}{|B(k_N)|} = \frac{|B(k_N + 1) \setminus B(k_N)|}{|B(k_N)|} < \frac{1}{N}.
  \]
\end{proof}

The converse is not true, by the following corollary and the existence of solvable groups of exponential growth:

\begin{corollary}
  All solvable groups are amenable.
\end{corollary}

\begin{proof}
  All abelian groups have polynomial growth and are thus amenable. Any solvable group can be written as the direct limit of abelian groups. Use \Cref{prop:sub/quot/direct limit of amenable groups}.
\end{proof}

Take the closure of finite groups and abelian groups by the operations of \Cref{prop:sub/quot/direct limit of amenable groups}, we obtain the class of \emph{elementary amenable groups}\index{elementary amenable group}. They are strictly contained in amenable groups, as Grigorchuk group of intermediate growth.

Open question:
\begin{enumerate}
\item Is ``elementary amenable'' a quasi-isometry invariant?
\item Is Thompson's group \(F\) amenable?
\end{enumerate}

More topics in geometric groups theory:
\begin{itemize}
\item Martin Bridson: world of finitely presented groups. 
\item Gromov: Space and Questions.
\item word problem. word problem for hyperbolic groups, solved by Dehn.
\item small cancellation. It leads to the construction of many interesting examples.
\item expander graphs, Kazhdan's property (T).
\end{itemize}

To conclude this course we mention the characterisation of non-amenability in terms of Ponzi scheme. Consider a function \(\rho: G \to G\) such that
\begin{itemize}
\item exists \(R\) such that \(d(g, \rho(g)) \leq R\).
\item \(|\rho^{-1}(g)| \geq 2\).
\end{itemize}
Imagine each person indexed by \(G\) holds £1, and person \(g\) passes his money to \(\rho(g)\). In this process everyone ends up with stricly more money than they had, and money has moved by a bounded distance. An example is \(F_2\), where everyone passes the money towards the centre of the Cayley graph. This condition is, in fact, equivalent to non-amenability.





\printindex
\end{document}