\documentclass[a4paper]{article}

\def\ntitle{Quadratic fields}
\def\ndate{}

\input{header}

\renewcommand*{\O}{\mathcal{O}}
\DeclareMathOperator{\n}{N}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\Cl}{Cl}%ideal class group
\newcommand*{\red}[1]{\overline{#1}}%reduction mod

\begin{document}

\maketitle

Let \(d \in \Z\) be square-free and \(d \neq 0, 1\). Then
\[
  L = \Q(\sqrt d) = \Q[x]/(x^2 - d)
\]
is a degree \(2\) extension over \(\Q\). It is called a \emph{quadratic field}. If \(d > 0\) then there are two real embeddings, in which case we call \(L\) a real quadratic field. Otherwise \(L\) is an imaginary quadratic field. Note that in using this notation, we implicitly assume that there is a complex embedding \(\sigma: L \to \C\).

\paragraph{Ring of integers}

A particularly nice characterisation of algebraic intgers in a quadratic field is \(\alpha \in \O_L\) if and only if \(\n_{L/\Q}(\alpha), \tr_{L/\Q}(\alpha) \in \Z\).

Suppose \(\alpha = \frac{u}{2} + \frac{v}{2}\sqrt d \in \O_L\) where \(u, v \in \Q\). Then multiplication by \(\alpha\) has with respect to the basis \(\{1, \sqrt d\}\) matrix representation
\[
  \frac{1}{2}
  \begin{pmatrix}
    u & vd \\
    v & u
  \end{pmatrix}
\]
so
\begin{align*}
  \n_{L/\Q}(\alpha) &= \frac{1}{4}(u^2 - v^2d) \in \Z \\
  \tr_{L/\Q}(\alpha) &= u \in \Z
\end{align*}

so \(v^2d \in \Z\). Suppose \(v = \frac{r}{s}\) is an expression in coprime integers. Then \(d^2r^2 \in s^2\Z\) so \(s^2 \divides d^2r^2\). If \(p\) is a prime dividing \(s\) then \(p^2 \divides d^2\). As \(d\) is square-free, \(p \divides d\). Absurd. Thus \(v \in \Z\) and
\[
  \Z[\sqrt d] \subseteq \O_L \subseteq \frac{1}{2}\Z[\sqrt d].
\]

\begin{itemize}
\item If \(d = 2, 3 \pmod 4\) then \(u^2 = 0, 1 \pmod 4, v^2 = 0, 1 \pmod 4\). As \(u^2 = v^2d \pmod 4\), \(u, v \in 2\Z\) so \(\alpha \in \Z[\sqrt d]\). Thus \(\O_L = \Z[\sqrt d]\).
\item If \(d = 1 \pmod 4\) then \(u^2 = v^2 \pmod 4\) so \(u = v \pmod 2\). Thus
  \[
    \O_L \subseteq \left\{ \frac{u}{2} + \frac{v}{2}\sqrt d: u = v \pmod 2 \right\} = \Z \oplus \Z \frac{1 + \sqrt d}{2}.
  \]
  Now check that \(\frac{1 + \sqrt d}{2} \in \O_L\) so we conclude that \(\O_L = \Z[\frac{1 + \sqrt d}{2}]\).
\end{itemize}

\paragraph{Discriminant}

Recall that
\[
  D_L
  = \det (\sigma_i(\alpha_j))^2
  = \det (\tr_{L/\Q}(\alpha_i\alpha_j))
  = (-1)^{\binom{n}{2}}\n_{L/\Q}(f'(\alpha))
\]
where \(\{\alpha_i\}\) is an integral basis, \(\{\sigma_i\}\) are the complex embeddings, \(\alpha\) is a generator of \(\O_L\) as a \(\Z\)-algebra and \(f\) is the minimal polynomial whereof.

\begin{itemize}
\item If \(d = 2, 3 \pmod 4\) then \(\alpha = \sqrt d, f(x) = x^2 - d\). Thus
  \[
    D_L = -\n_{L/\Q}(2\sqrt d) = 4d.
  \]
  Alternatively, since \(\tr_{L/\Q}(1) = 2, \tr_{L/\Q}(\sqrt d) = 0\), we can easily compute the matrix \(\tr_{L/\Q}(\alpha_i\alpha_j)\).
\item If \(d = 1 \pmod 4\) then \(\alpha = \frac{1 + \sqrt d}{2}, f(x) = x^2 + x + \frac{1 - d}{4}\). Thus
  \[
    D_L = -\n_{L/\Q}(\sqrt d) = d.
  \]
\end{itemize}

\paragraph{Factorisation of ideals}

Recall that Dedekind's criterion says that subject to certain divisibility condition, given \(L = \Q(\alpha)\) and \(\alpha \in \O_L\) with minimal polynomial \(f(x)\) and \(p\) prime, if
\[
  \red f(t) = \prod_{i = 1}^r \red g_i(t)^{e_i} \in \F_p[x]
\]
is a factorisation into irreducibles then
\[
  (p) = \prod_{i = 1}^r \mathfrak{p}_i^{e_i}
\]
is a factorisation into prime ideals.

\begin{itemize}
\item If \(p = 2\),
  \begin{itemize}
  \item if \(d = 2, 3 \pmod 4\) then let \(\alpha = \sqrt d\) so
    \[
      \red f(x) = x^2 - d = (x - d)^2 \in \F_2[x]
    \]
    so \((2) = \mathfrak{p}^2\), i.e.\ ramifies.
  \item if \(d = 1 \pmod 8\) then let \(\alpha = \frac{1 + \sqrt d}{2}\) so
    \[
      \red f(x) = x^2 + x + \frac{1 - d}{4} = x^2 + x = x(x + 1) \in \F_2[x]
    \]
    so \((2) = \mathfrak{p}\mathfrak{q}\), i.e.\ splits completely.
  \item if \(d = 5 \pmod 8\) then \(\red f(x) \in \F_2[x]\) is irreducible so \(2\) is inert.
  \end{itemize}
\item If \(p\) is odd, let \(\alpha = \sqrt d\) and \(f(x) = x^2 - d\) so
  \begin{itemize}
  \item if \(\legendre{d}{p} = 0\) then \((p) = \mathfrak{p}^2\), i.e.\ ramifies.
  \item if \(\legendre{d}{p} = 1\) then \((p) = \mathfrak{p}\mathfrak{q}\), i.e.\ splits completely.
  \item if \(\legendre{d}{p} = -1\) then \(p\) is inert.
  \end{itemize}
\end{itemize}

\paragraph{Lattice}

Recall that the covolume of a lattice formed by an ideal of the ring of integers is the volume of the parallelepiped spanned by its \(\Z\)-basis.

Given an \emph{imaginary} quadratic field \(L\), claim that
\[
  A(I) = \frac{1}{2}\sqrt{|\disc(I)|} = \frac{\n(I)}{2}\sqrt{|D_L|}
\]
for \(I \subseteq \O_L\).

\begin{proof}
  Let \(\alpha_1 = x_1 + iy_1, \alpha_2 = x_2 + iy_2\) be an integral basis for \(I\). Then
  \[
    A(I) = \left| \det
      \begin{pmatrix}
        x_1 & x_2 \\
        y_1 & y_2
      \end{pmatrix}
    \right|.
  \]
  Meanwhile
  \[
    \disc(I)
    = \det
    \begin{pmatrix}
      x_1 + iy_1 & x_2 + iy_2 \\
      x_1 - iy_1 & x_2 - iy_2
    \end{pmatrix}
    ^2
    = (2i)^2 \det
    \begin{pmatrix}
      x_1 & x_2 \\
      y_1 & y_2
    \end{pmatrix}
    ^2
    .
  \]
\end{proof}

By Minkowski's theorem and multiplicativity of norm, we can deduce that for any number field \(L\), the ideal class group \(\Cl(\O_L)\) is finite and can be generated by the class of prime ideals \(\mathfrak{p}\) with \(\n(\mathfrak{p}) \leq c_L\) where \(c_L = \frac{2}{\pi}\sqrt{|D_L|}\).

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(d = -7\). As \(d = 1 \pmod 4\), \(D_L = -7\). Thus
    \[
      c_L = \frac{2}{\pi} \sqrt 7 < \frac{2}{3} \sqrt 7 < 2
    \]
    so \(\Cl(\O_L)\) is generated by ideals of norm \(< 2\). There are none except \(\O_L\). Thus \(\Cl(\O_L)\) is trivial. Hence \(\O_L = \Z[\frac{1 + \sqrt{-7}}{2}]\) is a UFD.
  \item \(d = -5\). \(D_L = -20\) so
    \[
      c_L = \frac{2}{\pi}\sqrt{20} = \frac{4}{\pi}\sqrt 5 < \frac{4}{3} \sqrt 5 < 3
    \]
    so \(\Cl(\O_L)\) is generated by prime ideals \(\mathfrak p \subseteq \O_L\) of norm \(\n(\mathfrak p) = 2\). We know by Dedekind's criterion that \(2\O_L = \mathfrak p^2\). Thus \(\Cl(\O_L)\) is generated by \([\mathfrak p]\) and \([\mathfrak p]^2 = [2\O_L] = [\O_L]\) is the trivial class. Hence there are two possibilities:
    \begin{enumerate}
    \item if \(\mathfrak p\) is principal then \(\Cl(\O_L)\) is trivial.
    \item if \(\mathfrak p\) is not principal then \(\Cl(\O_L) \cong \Z/2\Z\).
    \end{enumerate}
    But we already knew that \(\O_L\) is not a UFD so \(\Cl(\O_L)\) is not trivial so must have
    \[
      \Cl(\O_L) \cong \Z/2\Z.
    \]
  \end{enumerate}
\end{eg}

For real quadratic fields \(L = \Q(\sqrt d)\), it is instructive as an exercise to derive the baby Minkowski constant, which should be \(c_L = \frac{1}{2}\sqrt{|D_L|}\).

\begin{eg}
  \(d = 10\). Then \(c_L = \frac{1}{2} \sqrt{4 \cdot 10} < 4\). By Dedekind's criterion,
  \begin{align*}
    (2) &= \mathfrak p_2^2 \\
    (3) &= \mathfrak p_3 \mathfrak p_3'
  \end{align*}
  What we can do at this stage is to compute the norm of some elements. For example \(\n(2 + \sqrt{10}) = 6\) so \((2 + \sqrt{10}) = \mathfrak p_2 \mathfrak p_3'\) or \(\mathfrak p_2 \mathfrak p_3'\). In either case, \([\mathfrak p_2]\) generates \(\Cl(\O_L)\). If \(\mathfrak p_2\) is principal then there exists \(a, b \in \Z\) such that
  \[
    a^2 - 10b^2 = \pm 2.
  \]
  Reduce modulo \(5\), \(\pm 2\) is not a quadratic residue so impossible. Thus \(\Cl(\O_L) \cong \Z/2\Z\).
\end{eg}

\begin{ex}
  Find the class group of ring of integers of \(\Q(\sqrt{-17})\).
\end{ex}

\paragraph{Dirichlet's unit theorem}

Dirichlet's unit theorem states that there is an isomorphism
\[
  \O_L^\times \cong \mu_L \times \Z^{r + s - 1}
\]
where \(\mu_L\) is the group of roots of unity in \(\O_L^\times\).

Thus \(\O_L^\times\) is finite if and only if
\begin{enumerate}
\item \(r = 1, s = 0\), so \(L = \Q\), or
\item \(r = 0, s = 1\), so \(L = \Q(\sqrt d)\) for some \(d \in \Z\) negative square-free.
\end{enumerate}

For real quadratic fields \(L = \Q(\sqrt d)\), let \(\sigma: L \to \R\) be the real embedding such that \(\sigma(\sqrt d) > 0\). As \(\sigma(\mu_L) \subseteq \R^\times\), must have \(\mu_L =  \{\pm 1\}\). Consider the homomorphism
\begin{align*}
  \ell': \O_L^\times &\to \R \\
  \alpha &\mapsto \log |\sigma(\alpha)|
\end{align*}
As \(\ell'(\O_L^\times) \subseteq \R\) is a lattice, there is a unique element \(\alpha \in \O_L^\times\) such that \(\sigma(\alpha) > 0\), \(\ell'(\alpha)\) generates the lattice. Then
\[
  \O_L^\times = \{\pm \alpha^n: n \in \Z\}.
\]
This \(\alpha\) is called the \emph{fundamental unit}. It has the property that \(\log |\sigma(\alpha)|\) is minimal, i.e.\ \(\sigma(\alpha) > 1\) is minimal. This gives us a way to find fundamental units.

\begin{lemma}
  Suppose \(d = 2, 3 \pmod 4\), \(v \in \O_L^\times\) and \(v > 1\). Then \(v = a + b \sqrt d\) where \(a \geq b \geq 1\).
\end{lemma}

\begin{proof}
  Let \(v' = a - b \sqrt d\). Then
  \[
    vv' = a^2 - db^2 = \pm 1.
  \]
  As \(v > 1\), \(|v'| < 1\) so
  \begin{align*}
    2a &= v + v' > 0 \\
    2b &= v - v' > 0
  \end{align*}
  Also
  \[
    \left( \frac{a}{b} \right)^2 = d \pm \frac{1}{b^2} > 1.
  \]
\end{proof}

There is an entirely analogous result for \(d = 1 \pmod 4\) which is left as an exercise.

Now suppose \(d = 2, 3 \pmod 4\). Suppose \(u = a + b \sqrt d \in \O_L^\times\) is the fundamental unit. Let \(u^k = a_k + b_k \sqrt d\). Then
\begin{align*}
  u^{k + 1}
  &= u \cdot u^k \\
  &= (a_1 + b_1 \sqrt d)(a_k + b_k \sqrt d) \\
  &= (a_1a_k + d b_1b_k) + (b_1a_k + a_1b_k) \sqrt d
\end{align*}
so
\[
  b_{k + 1} = b_1a_k + a_1b_k \geq 2b_k > b_k
\]
so \((b_k)_{k \in \N}\) is strictly increasing. We can therefore characterise \(u\) as follow: let \(b \in \N\) be the least positive integer such that \(db^2 + 1\) or \(db^2 - 1\) is of the form \(a^2\) for some \(a \in \N\). Then \(u = a + b \sqrt d\) is the fundamental unit.

If instead \(d = 1 \pmod 4\), we get
\[
  b_{k + 1} = \frac{1}{2}(b_1a_k + a_1b_k) \geq b_k
\]
with equality if and only if \(a_1 = b_1 = 1, a_k = b_k\). In this case
\[
  \n(u) = \left| \frac{1 - d}{4} \right| = 1
\]
so \(d = 5\). In this case \(u = \frac{1}{2} (1 + \sqrt 5)\) is the fundamental unit.

If instead \(d > 5\), we proceed as before and characterise \(u\) as follow: let \(b \in \N\) be the least positive integer such that \(db^2 + 4\) or \(db^2 - 4\) is of the form \(a^2\) for some \(a \in \N\). Then \(u = \frac{1}{2} (a + b \sqrt d)\) is the fundamental unit.

\begin{eg}\leavevmode
  \begin{enumerate}
  \item \(d = 2\). Then \(b = 1\) works since \(2 - 1 = 1^2\) so \(1 + \sqrt 2\) is a fundamental unit.
  \item \(d = 7\).
    \begin{align*}
      & b = 1: 7 \pm 1 \text{ not a square} \\
      & b = 2: 4 \cdot 7 \pm 1 \text{ not a square} \\
      & b = 3: 9 \cdot 7 + 1 = 8^2
    \end{align*}
    so \(8 + 3 \sqrt 7\) is a fundamental unit.
  \end{enumerate}
\end{eg}

\end{document}
